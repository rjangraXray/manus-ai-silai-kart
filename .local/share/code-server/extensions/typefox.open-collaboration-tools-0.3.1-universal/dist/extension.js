"use strict";var YT=Object.create;var to=Object.defineProperty;var ky=Object.getOwnPropertyDescriptor;var KT=Object.getOwnPropertyNames;var JT=Object.getPrototypeOf,QT=Object.prototype.hasOwnProperty;var XT=(r,e,t)=>e in r?to(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var da=(r,e)=>()=>(r&&(e=r(r=0)),e);var W=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Ad=(r,e)=>{for(var t in e)to(r,t,{get:e[t],enumerable:!0})},Ty=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of KT(e))!QT.call(r,i)&&i!==t&&to(r,i,{get:()=>e[i],enumerable:!(n=ky(e,i))||n.enumerable});return r};var de=(r,e,t)=>(t=r!=null?YT(JT(r)):{},Ty(e||!r||!r.__esModule?to(t,"default",{value:r,enumerable:!0}):t,r)),ZT=r=>Ty(to({},"__esModule",{value:!0}),r),ke=(r,e,t,n)=>{for(var i=n>1?void 0:n?ky(e,t):e,s=r.length-1,o;s>=0;s--)(o=r[s])&&(i=(n?o(e,t,i):o(i))||i);return n&&i&&to(e,t,i),i};var Ry=(r,e,t)=>XT(r,typeof e!="symbol"?e+"":e,t);var Id=W(()=>{var Ay;(function(r){(function(e){var t=typeof globalThis=="object"?globalThis:typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:l(),n=i(r);typeof t.Reflect<"u"&&(n=i(t.Reflect,n)),e(n,t),typeof t.Reflect>"u"&&(t.Reflect=r);function i(u,d){return function(f,h){Object.defineProperty(u,f,{configurable:!0,writable:!0,value:h}),d&&d(f,h)}}function s(){try{return Function("return this;")()}catch{}}function o(){try{return(0,eval)("(function() { return this; })()")}catch{}}function l(){return s()||o()}})(function(e,t){var n=Object.prototype.hasOwnProperty,i=typeof Symbol=="function",s=i&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",o=i&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",l=typeof Object.create=="function",u={__proto__:[]}instanceof Array,d=!l&&!u,f={create:l?function(){return Vs(Object.create(null))}:u?function(){return Vs({__proto__:null})}:function(){return Vs({})},has:d?function(E,A){return n.call(E,A)}:function(E,A){return A in E},get:d?function(E,A){return n.call(E,A)?E[A]:void 0}:function(E,A){return E[A]}},h=Object.getPrototypeOf(Function),m=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:$c(),g=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Vc(),y=typeof WeakMap=="function"?WeakMap:td(),b=i?Symbol.for("@reflect-metadata:registry"):void 0,C=ed(),L=jc(C);function j(E,A,B,H){if(z(B)){if(!Fr(E))throw new TypeError;if(!tr(A))throw new TypeError;return he(E,A)}else{if(!Fr(E))throw new TypeError;if(!J(A))throw new TypeError;if(!J(H)&&!z(H)&&!ce(H))throw new TypeError;return ce(H)&&(H=void 0),B=lt(B),pe(E,A,B,H)}}e("decorate",j);function O(E,A){function B(H,ae){if(!J(H))throw new TypeError;if(!z(ae)&&!An(ae))throw new TypeError;V(E,A,H,ae)}return B}e("metadata",O);function D(E,A,B,H){if(!J(B))throw new TypeError;return z(H)||(H=lt(H)),V(E,A,B,H)}e("defineMetadata",D);function N(E,A,B){if(!J(A))throw new TypeError;return z(B)||(B=lt(B)),S(E,A,B)}e("hasMetadata",N);function k(E,A,B){if(!J(A))throw new TypeError;return z(B)||(B=lt(B)),$(E,A,B)}e("hasOwnMetadata",k);function P(E,A,B){if(!J(A))throw new TypeError;return z(B)||(B=lt(B)),q(E,A,B)}e("getMetadata",P);function R(E,A,B){if(!J(A))throw new TypeError;return z(B)||(B=lt(B)),F(E,A,B)}e("getOwnMetadata",R);function M(E,A){if(!J(E))throw new TypeError;return z(A)||(A=lt(A)),X(E,A)}e("getMetadataKeys",M);function Q(E,A){if(!J(E))throw new TypeError;return z(A)||(A=lt(A)),me(E,A)}e("getOwnMetadataKeys",Q);function te(E,A,B){if(!J(A))throw new TypeError;if(z(B)||(B=lt(B)),!J(A))throw new TypeError;z(B)||(B=lt(B));var H=Gi(A,B,!1);return z(H)?!1:H.OrdinaryDeleteMetadata(E,A,B)}e("deleteMetadata",te);function he(E,A){for(var B=E.length-1;B>=0;--B){var H=E[B],ae=H(A);if(!z(ae)&&!ce(ae)){if(!tr(ae))throw new TypeError;A=ae}}return A}function pe(E,A,B,H){for(var ae=E.length-1;ae>=0;--ae){var Ne=E[ae],et=Ne(A,B,H);if(!z(et)&&!ce(et)){if(!J(et))throw new TypeError;H=et}}return H}function S(E,A,B){var H=$(E,A,B);if(H)return!0;var ae=vr(A);return ce(ae)?!1:S(E,ae,B)}function $(E,A,B){var H=Gi(A,B,!1);return z(H)?!1:nt(H.OrdinaryHasOwnMetadata(E,A,B))}function q(E,A,B){var H=$(E,A,B);if(H)return F(E,A,B);var ae=vr(A);if(!ce(ae))return q(E,ae,B)}function F(E,A,B){var H=Gi(A,B,!1);if(!z(H))return H.OrdinaryGetOwnMetadata(E,A,B)}function V(E,A,B,H){var ae=Gi(B,H,!0);ae.OrdinaryDefineOwnMetadata(E,A,B,H)}function X(E,A){var B=me(E,A),H=vr(E);if(H===null)return B;var ae=X(H,A);if(ae.length<=0)return B;if(B.length<=0)return ae;for(var Ne=new g,et=[],ge=0,Y=B;ge<Y.length;ge++){var ee=Y[ge],re=Ne.has(ee);re||(Ne.add(ee),et.push(ee))}for(var se=0,Ce=ae;se<Ce.length;se++){var ee=Ce[se],re=Ne.has(ee);re||(Ne.add(ee),et.push(ee))}return et}function me(E,A){var B=Gi(E,A,!1);return B?B.OrdinaryOwnMetadataKeys(E,A):[]}function oe(E){if(E===null)return 1;switch(typeof E){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return E===null?1:6;default:return 6}}function z(E){return E===void 0}function ce(E){return E===null}function ue(E){return typeof E=="symbol"}function J(E){return typeof E=="object"?E!==null:typeof E=="function"}function Ue(E,A){switch(oe(E)){case 0:return E;case 1:return E;case 2:return E;case 3:return E;case 4:return E;case 5:return E}var B=A===3?"string":A===5?"number":"default",H=ra(E,s);if(H!==void 0){var ae=H.call(E,B);if(J(ae))throw new TypeError;return ae}return kt(E,B==="default"?"number":B)}function kt(E,A){if(A==="string"){var B=E.toString;if($t(B)){var H=B.call(E);if(!J(H))return H}var ae=E.valueOf;if($t(ae)){var H=ae.call(E);if(!J(H))return H}}else{var ae=E.valueOf;if($t(ae)){var H=ae.call(E);if(!J(H))return H}var Ne=E.toString;if($t(Ne)){var H=Ne.call(E);if(!J(H))return H}}throw new TypeError}function nt(E){return!!E}function an(E){return""+E}function lt(E){var A=Ue(E,3);return ue(A)?A:an(A)}function Fr(E){return Array.isArray?Array.isArray(E):E instanceof Object?E instanceof Array:Object.prototype.toString.call(E)==="[object Array]"}function $t(E){return typeof E=="function"}function tr(E){return typeof E=="function"}function An(E){switch(oe(E)){case 3:return!0;case 4:return!0;default:return!1}}function cn(E,A){return E===A||E!==E&&A!==A}function ra(E,A){var B=E[A];if(B!=null){if(!$t(B))throw new TypeError;return B}}function js(E){var A=ra(E,o);if(!$t(A))throw new TypeError;var B=A.call(E);if(!J(B))throw new TypeError;return B}function zi(E){return E.value}function na(E){var A=E.next();return A.done?!1:A}function Nr(E){var A=E.return;A&&A.call(E)}function vr(E){var A=Object.getPrototypeOf(E);if(typeof E!="function"||E===h||A!==h)return A;var B=E.prototype,H=B&&Object.getPrototypeOf(B);if(H==null||H===Object.prototype)return A;var ae=H.constructor;return typeof ae!="function"||ae===E?A:ae}function Hi(){var E;!z(b)&&typeof t.Reflect<"u"&&!(b in t.Reflect)&&typeof t.Reflect.defineMetadata=="function"&&(E=$s(t.Reflect));var A,B,H,ae=new y,Ne={registerProvider:et,getProvider:Y,setProvider:re};return Ne;function et(se){if(!Object.isExtensible(Ne))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case E===se:break;case z(A):A=se;break;case A===se:break;case z(B):B=se;break;case B===se:break;default:H===void 0&&(H=new g),H.add(se);break}}function ge(se,Ce){if(!z(A)){if(A.isProviderFor(se,Ce))return A;if(!z(B)){if(B.isProviderFor(se,Ce))return A;if(!z(H))for(var Le=js(H);;){var Xe=na(Le);if(!Xe)return;var rr=zi(Xe);if(rr.isProviderFor(se,Ce))return Nr(Le),rr}}}if(!z(E)&&E.isProviderFor(se,Ce))return E}function Y(se,Ce){var Le=ae.get(se),Xe;return z(Le)||(Xe=Le.get(Ce)),z(Xe)&&(Xe=ge(se,Ce),z(Xe)||(z(Le)&&(Le=new m,ae.set(se,Le)),Le.set(Ce,Xe))),Xe}function ee(se){if(z(se))throw new TypeError;return A===se||B===se||!z(H)&&H.has(se)}function re(se,Ce,Le){if(!ee(Le))throw new Error("Metadata provider not registered.");var Xe=Y(se,Ce);if(Xe!==Le){if(!z(Xe))return!1;var rr=ae.get(se);z(rr)&&(rr=new m,ae.set(se,rr)),rr.set(Ce,Le)}return!0}}function ed(){var E;return!z(b)&&J(t.Reflect)&&Object.isExtensible(t.Reflect)&&(E=t.Reflect[b]),z(E)&&(E=Hi()),!z(b)&&J(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,b,{enumerable:!1,configurable:!1,writable:!1,value:E}),E}function jc(E){var A=new y,B={isProviderFor:function(ee,re){var se=A.get(ee);return z(se)?!1:se.has(re)},OrdinaryDefineOwnMetadata:et,OrdinaryHasOwnMetadata:ae,OrdinaryGetOwnMetadata:Ne,OrdinaryOwnMetadataKeys:ge,OrdinaryDeleteMetadata:Y};return C.registerProvider(B),B;function H(ee,re,se){var Ce=A.get(ee),Le=!1;if(z(Ce)){if(!se)return;Ce=new m,A.set(ee,Ce),Le=!0}var Xe=Ce.get(re);if(z(Xe)){if(!se)return;if(Xe=new m,Ce.set(re,Xe),!E.setProvider(ee,re,B))throw Ce.delete(re),Le&&A.delete(ee),new Error("Wrong provider for target.")}return Xe}function ae(ee,re,se){var Ce=H(re,se,!1);return z(Ce)?!1:nt(Ce.has(ee))}function Ne(ee,re,se){var Ce=H(re,se,!1);if(!z(Ce))return Ce.get(ee)}function et(ee,re,se,Ce){var Le=H(se,Ce,!0);Le.set(ee,re)}function ge(ee,re){var se=[],Ce=H(ee,re,!1);if(z(Ce))return se;for(var Le=Ce.keys(),Xe=js(Le),rr=0;;){var Wc=na(Xe);if(!Wc)return se.length=rr,se;var rd=zi(Wc);try{se[rr]=rd}catch(zc){try{Nr(Xe)}finally{throw zc}}rr++}}function Y(ee,re,se){var Ce=H(re,se,!1);if(z(Ce)||!Ce.delete(ee))return!1;if(Ce.size===0){var Le=A.get(re);z(Le)||(Le.delete(se),Le.size===0&&A.delete(Le))}return!0}}function $s(E){var A=E.defineMetadata,B=E.hasOwnMetadata,H=E.getOwnMetadata,ae=E.getOwnMetadataKeys,Ne=E.deleteMetadata,et=new y,ge={isProviderFor:function(Y,ee){var re=et.get(Y);return!z(re)&&re.has(ee)?!0:ae(Y,ee).length?(z(re)&&(re=new g,et.set(Y,re)),re.add(ee),!0):!1},OrdinaryDefineOwnMetadata:A,OrdinaryHasOwnMetadata:B,OrdinaryGetOwnMetadata:H,OrdinaryOwnMetadataKeys:ae,OrdinaryDeleteMetadata:Ne};return ge}function Gi(E,A,B){var H=C.getProvider(E,A);if(!z(H))return H;if(B){if(C.setProvider(E,A,L))return L;throw new Error("Illegal state.")}}function $c(){var E={},A=[],B=function(){function ge(Y,ee,re){this._index=0,this._keys=Y,this._values=ee,this._selector=re}return ge.prototype["@@iterator"]=function(){return this},ge.prototype[o]=function(){return this},ge.prototype.next=function(){var Y=this._index;if(Y>=0&&Y<this._keys.length){var ee=this._selector(this._keys[Y],this._values[Y]);return Y+1>=this._keys.length?(this._index=-1,this._keys=A,this._values=A):this._index++,{value:ee,done:!1}}return{value:void 0,done:!0}},ge.prototype.throw=function(Y){throw this._index>=0&&(this._index=-1,this._keys=A,this._values=A),Y},ge.prototype.return=function(Y){return this._index>=0&&(this._index=-1,this._keys=A,this._values=A),{value:Y,done:!0}},ge}(),H=function(){function ge(){this._keys=[],this._values=[],this._cacheKey=E,this._cacheIndex=-2}return Object.defineProperty(ge.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),ge.prototype.has=function(Y){return this._find(Y,!1)>=0},ge.prototype.get=function(Y){var ee=this._find(Y,!1);return ee>=0?this._values[ee]:void 0},ge.prototype.set=function(Y,ee){var re=this._find(Y,!0);return this._values[re]=ee,this},ge.prototype.delete=function(Y){var ee=this._find(Y,!1);if(ee>=0){for(var re=this._keys.length,se=ee+1;se<re;se++)this._keys[se-1]=this._keys[se],this._values[se-1]=this._values[se];return this._keys.length--,this._values.length--,cn(Y,this._cacheKey)&&(this._cacheKey=E,this._cacheIndex=-2),!0}return!1},ge.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=E,this._cacheIndex=-2},ge.prototype.keys=function(){return new B(this._keys,this._values,ae)},ge.prototype.values=function(){return new B(this._keys,this._values,Ne)},ge.prototype.entries=function(){return new B(this._keys,this._values,et)},ge.prototype["@@iterator"]=function(){return this.entries()},ge.prototype[o]=function(){return this.entries()},ge.prototype._find=function(Y,ee){if(!cn(this._cacheKey,Y)){this._cacheIndex=-1;for(var re=0;re<this._keys.length;re++)if(cn(this._keys[re],Y)){this._cacheIndex=re;break}}return this._cacheIndex<0&&ee&&(this._cacheIndex=this._keys.length,this._keys.push(Y),this._values.push(void 0)),this._cacheIndex},ge}();return H;function ae(ge,Y){return ge}function Ne(ge,Y){return Y}function et(ge,Y){return[ge,Y]}}function Vc(){var E=function(){function A(){this._map=new m}return Object.defineProperty(A.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),A.prototype.has=function(B){return this._map.has(B)},A.prototype.add=function(B){return this._map.set(B,B),this},A.prototype.delete=function(B){return this._map.delete(B)},A.prototype.clear=function(){this._map.clear()},A.prototype.keys=function(){return this._map.keys()},A.prototype.values=function(){return this._map.keys()},A.prototype.entries=function(){return this._map.entries()},A.prototype["@@iterator"]=function(){return this.keys()},A.prototype[o]=function(){return this.keys()},A}();return E}function td(){var E=16,A=f.create(),B=H();return function(){function Y(){this._key=H()}return Y.prototype.has=function(ee){var re=ae(ee,!1);return re!==void 0?f.has(re,this._key):!1},Y.prototype.get=function(ee){var re=ae(ee,!1);return re!==void 0?f.get(re,this._key):void 0},Y.prototype.set=function(ee,re){var se=ae(ee,!0);return se[this._key]=re,this},Y.prototype.delete=function(ee){var re=ae(ee,!1);return re!==void 0?delete re[this._key]:!1},Y.prototype.clear=function(){this._key=H()},Y}();function H(){var Y;do Y="@@WeakMap@@"+ge();while(f.has(A,Y));return A[Y]=!0,Y}function ae(Y,ee){if(!n.call(Y,B)){if(!ee)return;Object.defineProperty(Y,B,{value:f.create()})}return Y[B]}function Ne(Y,ee){for(var re=0;re<ee;++re)Y[re]=Math.random()*255|0;return Y}function et(Y){if(typeof Uint8Array=="function"){var ee=new Uint8Array(Y);return typeof crypto<"u"?crypto.getRandomValues(ee):typeof msCrypto<"u"?msCrypto.getRandomValues(ee):Ne(ee,Y),ee}return Ne(new Array(Y),Y)}function ge(){var Y=et(E);Y[6]=Y[6]&79|64,Y[8]=Y[8]&191|128;for(var ee="",re=0;re<E;++re){var se=Y[re];(re===4||re===6||re===8)&&(ee+="-"),se<16&&(ee+="0"),ee+=se.toString(16).toLowerCase()}return ee}}function Vs(E){return E.__=void 0,delete E.__,E}})})(Ay||(Ay={}))});var ha=W((pB,Oy)=>{var eR="2.0.0",tR=Number.MAX_SAFE_INTEGER||9007199254740991,rR=16,nR=250,iR=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Oy.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:rR,MAX_SAFE_BUILD_LENGTH:nR,MAX_SAFE_INTEGER:tR,RELEASE_TYPES:iR,SEMVER_SPEC_VERSION:eR,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var pa=W((mB,Dy)=>{var sR=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};Dy.exports=sR});var ro=W((un,Py)=>{var{MAX_SAFE_COMPONENT_LENGTH:Od,MAX_SAFE_BUILD_LENGTH:oR,MAX_LENGTH:aR}=ha(),cR=pa();un=Py.exports={};var lR=un.re=[],uR=un.safeRe=[],ne=un.src=[],fR=un.safeSrc=[],ie=un.t={},dR=0,Dd="[a-zA-Z0-9-]",hR=[["\\s",1],["\\d",aR],[Dd,oR]],pR=r=>{for(let[e,t]of hR)r=r.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return r},xe=(r,e,t)=>{let n=pR(e),i=dR++;cR(r,i,e),ie[r]=i,ne[i]=e,fR[i]=n,lR[i]=new RegExp(e,t?"g":void 0),uR[i]=new RegExp(n,t?"g":void 0)};xe("NUMERICIDENTIFIER","0|[1-9]\\d*");xe("NUMERICIDENTIFIERLOOSE","\\d+");xe("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Dd}*`);xe("MAINVERSION",`(${ne[ie.NUMERICIDENTIFIER]})\\.(${ne[ie.NUMERICIDENTIFIER]})\\.(${ne[ie.NUMERICIDENTIFIER]})`);xe("MAINVERSIONLOOSE",`(${ne[ie.NUMERICIDENTIFIERLOOSE]})\\.(${ne[ie.NUMERICIDENTIFIERLOOSE]})\\.(${ne[ie.NUMERICIDENTIFIERLOOSE]})`);xe("PRERELEASEIDENTIFIER",`(?:${ne[ie.NUMERICIDENTIFIER]}|${ne[ie.NONNUMERICIDENTIFIER]})`);xe("PRERELEASEIDENTIFIERLOOSE",`(?:${ne[ie.NUMERICIDENTIFIERLOOSE]}|${ne[ie.NONNUMERICIDENTIFIER]})`);xe("PRERELEASE",`(?:-(${ne[ie.PRERELEASEIDENTIFIER]}(?:\\.${ne[ie.PRERELEASEIDENTIFIER]})*))`);xe("PRERELEASELOOSE",`(?:-?(${ne[ie.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${ne[ie.PRERELEASEIDENTIFIERLOOSE]})*))`);xe("BUILDIDENTIFIER",`${Dd}+`);xe("BUILD",`(?:\\+(${ne[ie.BUILDIDENTIFIER]}(?:\\.${ne[ie.BUILDIDENTIFIER]})*))`);xe("FULLPLAIN",`v?${ne[ie.MAINVERSION]}${ne[ie.PRERELEASE]}?${ne[ie.BUILD]}?`);xe("FULL",`^${ne[ie.FULLPLAIN]}$`);xe("LOOSEPLAIN",`[v=\\s]*${ne[ie.MAINVERSIONLOOSE]}${ne[ie.PRERELEASELOOSE]}?${ne[ie.BUILD]}?`);xe("LOOSE",`^${ne[ie.LOOSEPLAIN]}$`);xe("GTLT","((?:<|>)?=?)");xe("XRANGEIDENTIFIERLOOSE",`${ne[ie.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);xe("XRANGEIDENTIFIER",`${ne[ie.NUMERICIDENTIFIER]}|x|X|\\*`);xe("XRANGEPLAIN",`[v=\\s]*(${ne[ie.XRANGEIDENTIFIER]})(?:\\.(${ne[ie.XRANGEIDENTIFIER]})(?:\\.(${ne[ie.XRANGEIDENTIFIER]})(?:${ne[ie.PRERELEASE]})?${ne[ie.BUILD]}?)?)?`);xe("XRANGEPLAINLOOSE",`[v=\\s]*(${ne[ie.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ne[ie.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ne[ie.XRANGEIDENTIFIERLOOSE]})(?:${ne[ie.PRERELEASELOOSE]})?${ne[ie.BUILD]}?)?)?`);xe("XRANGE",`^${ne[ie.GTLT]}\\s*${ne[ie.XRANGEPLAIN]}$`);xe("XRANGELOOSE",`^${ne[ie.GTLT]}\\s*${ne[ie.XRANGEPLAINLOOSE]}$`);xe("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Od}})(?:\\.(\\d{1,${Od}}))?(?:\\.(\\d{1,${Od}}))?`);xe("COERCE",`${ne[ie.COERCEPLAIN]}(?:$|[^\\d])`);xe("COERCEFULL",ne[ie.COERCEPLAIN]+`(?:${ne[ie.PRERELEASE]})?(?:${ne[ie.BUILD]})?(?:$|[^\\d])`);xe("COERCERTL",ne[ie.COERCE],!0);xe("COERCERTLFULL",ne[ie.COERCEFULL],!0);xe("LONETILDE","(?:~>?)");xe("TILDETRIM",`(\\s*)${ne[ie.LONETILDE]}\\s+`,!0);un.tildeTrimReplace="$1~";xe("TILDE",`^${ne[ie.LONETILDE]}${ne[ie.XRANGEPLAIN]}$`);xe("TILDELOOSE",`^${ne[ie.LONETILDE]}${ne[ie.XRANGEPLAINLOOSE]}$`);xe("LONECARET","(?:\\^)");xe("CARETTRIM",`(\\s*)${ne[ie.LONECARET]}\\s+`,!0);un.caretTrimReplace="$1^";xe("CARET",`^${ne[ie.LONECARET]}${ne[ie.XRANGEPLAIN]}$`);xe("CARETLOOSE",`^${ne[ie.LONECARET]}${ne[ie.XRANGEPLAINLOOSE]}$`);xe("COMPARATORLOOSE",`^${ne[ie.GTLT]}\\s*(${ne[ie.LOOSEPLAIN]})$|^$`);xe("COMPARATOR",`^${ne[ie.GTLT]}\\s*(${ne[ie.FULLPLAIN]})$|^$`);xe("COMPARATORTRIM",`(\\s*)${ne[ie.GTLT]}\\s*(${ne[ie.LOOSEPLAIN]}|${ne[ie.XRANGEPLAIN]})`,!0);un.comparatorTrimReplace="$1$2$3";xe("HYPHENRANGE",`^\\s*(${ne[ie.XRANGEPLAIN]})\\s+-\\s+(${ne[ie.XRANGEPLAIN]})\\s*$`);xe("HYPHENRANGELOOSE",`^\\s*(${ne[ie.XRANGEPLAINLOOSE]})\\s+-\\s+(${ne[ie.XRANGEPLAINLOOSE]})\\s*$`);xe("STAR","(<|>)?=?\\s*\\*");xe("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");xe("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var wl=W((gB,Uy)=>{var mR=Object.freeze({loose:!0}),gR=Object.freeze({}),yR=r=>r?typeof r!="object"?mR:r:gR;Uy.exports=yR});var Pd=W((yB,Ny)=>{var Ly=/^[0-9]+$/,Fy=(r,e)=>{let t=Ly.test(r),n=Ly.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},wR=(r,e)=>Fy(e,r);Ny.exports={compareIdentifiers:Fy,rcompareIdentifiers:wR}});var Rt=W((wB,jy)=>{var bl=pa(),{MAX_LENGTH:By,MAX_SAFE_INTEGER:vl}=ha(),{safeRe:My,safeSrc:qy,t:_l}=ro(),bR=wl(),{compareIdentifiers:no}=Pd(),Ud=class r{constructor(e,t){if(t=bR(t),e instanceof r){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>By)throw new TypeError(`version is longer than ${By} characters`);bl("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?My[_l.LOOSE]:My[_l.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>vl||this.major<0)throw new TypeError("Invalid major version");if(this.minor>vl||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>vl||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let s=+i;if(s>=0&&s<vl)return s}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(bl("SemVer.compare",this.version,this.options,e),!(e instanceof r)){if(typeof e=="string"&&e===this.version)return 0;e=new r(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof r||(e=new r(e,this.options)),no(this.major,e.major)||no(this.minor,e.minor)||no(this.patch,e.patch)}comparePre(e){if(e instanceof r||(e=new r(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],i=e.prerelease[t];if(bl("prerelease compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return no(n,i)}while(++t)}compareBuild(e){e instanceof r||(e=new r(e,this.options));let t=0;do{let n=this.build[t],i=e.build[t];if(bl("build compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return no(n,i)}while(++t)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(t){let i=new RegExp(`^${this.options.loose?qy[_l.PRERELEASELOOSE]:qy[_l.PRERELEASE]}$`),s=`-${t}`.match(i);if(!s||s[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let s=[t,i];n===!1&&(s=[t]),no(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};jy.exports=Ud});var rs=W((bB,Vy)=>{var $y=Rt(),vR=(r,e,t=!1)=>{if(r instanceof $y)return r;try{return new $y(r,e)}catch(n){if(!t)return null;throw n}};Vy.exports=vR});var zy=W((vB,Wy)=>{var _R=rs(),SR=(r,e)=>{let t=_R(r,e);return t?t.version:null};Wy.exports=SR});var Gy=W((_B,Hy)=>{var xR=rs(),ER=(r,e)=>{let t=xR(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};Hy.exports=ER});var Jy=W((SB,Ky)=>{var Yy=Rt(),CR=(r,e,t,n,i)=>{typeof t=="string"&&(i=n,n=t,t=void 0);try{return new Yy(r instanceof Yy?r.version:r,t).inc(e,n,i).version}catch{return null}};Ky.exports=CR});var Zy=W((xB,Xy)=>{var Qy=rs(),kR=(r,e)=>{let t=Qy(r,null,!0),n=Qy(e,null,!0),i=t.compare(n);if(i===0)return null;let s=i>0,o=s?t:n,l=s?n:t,u=!!o.prerelease.length;if(!!l.prerelease.length&&!u){if(!l.patch&&!l.minor)return"major";if(l.compareMain(o)===0)return l.minor&&!l.patch?"minor":"patch"}let f=u?"pre":"";return t.major!==n.major?f+"major":t.minor!==n.minor?f+"minor":t.patch!==n.patch?f+"patch":"prerelease"};Xy.exports=kR});var t0=W((EB,e0)=>{var TR=Rt(),RR=(r,e)=>new TR(r,e).major;e0.exports=RR});var n0=W((CB,r0)=>{var AR=Rt(),IR=(r,e)=>new AR(r,e).minor;r0.exports=IR});var s0=W((kB,i0)=>{var OR=Rt(),DR=(r,e)=>new OR(r,e).patch;i0.exports=DR});var a0=W((TB,o0)=>{var PR=rs(),UR=(r,e)=>{let t=PR(r,e);return t&&t.prerelease.length?t.prerelease:null};o0.exports=UR});var Er=W((RB,l0)=>{var c0=Rt(),LR=(r,e,t)=>new c0(r,t).compare(new c0(e,t));l0.exports=LR});var f0=W((AB,u0)=>{var FR=Er(),NR=(r,e,t)=>FR(e,r,t);u0.exports=NR});var h0=W((IB,d0)=>{var BR=Er(),MR=(r,e)=>BR(r,e,!0);d0.exports=MR});var Sl=W((OB,m0)=>{var p0=Rt(),qR=(r,e,t)=>{let n=new p0(r,t),i=new p0(e,t);return n.compare(i)||n.compareBuild(i)};m0.exports=qR});var y0=W((DB,g0)=>{var jR=Sl(),$R=(r,e)=>r.sort((t,n)=>jR(t,n,e));g0.exports=$R});var b0=W((PB,w0)=>{var VR=Sl(),WR=(r,e)=>r.sort((t,n)=>VR(n,t,e));w0.exports=WR});var ma=W((UB,v0)=>{var zR=Er(),HR=(r,e,t)=>zR(r,e,t)>0;v0.exports=HR});var xl=W((LB,_0)=>{var GR=Er(),YR=(r,e,t)=>GR(r,e,t)<0;_0.exports=YR});var Ld=W((FB,S0)=>{var KR=Er(),JR=(r,e,t)=>KR(r,e,t)===0;S0.exports=JR});var Fd=W((NB,x0)=>{var QR=Er(),XR=(r,e,t)=>QR(r,e,t)!==0;x0.exports=XR});var El=W((BB,E0)=>{var ZR=Er(),eA=(r,e,t)=>ZR(r,e,t)>=0;E0.exports=eA});var Cl=W((MB,C0)=>{var tA=Er(),rA=(r,e,t)=>tA(r,e,t)<=0;C0.exports=rA});var Nd=W((qB,k0)=>{var nA=Ld(),iA=Fd(),sA=ma(),oA=El(),aA=xl(),cA=Cl(),lA=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return nA(r,t,n);case"!=":return iA(r,t,n);case">":return sA(r,t,n);case">=":return oA(r,t,n);case"<":return aA(r,t,n);case"<=":return cA(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};k0.exports=lA});var R0=W((jB,T0)=>{var uA=Rt(),fA=rs(),{safeRe:kl,t:Tl}=ro(),dA=(r,e)=>{if(r instanceof uA)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(e.includePrerelease?kl[Tl.COERCEFULL]:kl[Tl.COERCE]);else{let u=e.includePrerelease?kl[Tl.COERCERTLFULL]:kl[Tl.COERCERTL],d;for(;(d=u.exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||d.index+d[0].length!==t.index+t[0].length)&&(t=d),u.lastIndex=d.index+d[1].length+d[2].length;u.lastIndex=-1}if(t===null)return null;let n=t[2],i=t[3]||"0",s=t[4]||"0",o=e.includePrerelease&&t[5]?`-${t[5]}`:"",l=e.includePrerelease&&t[6]?`+${t[6]}`:"";return fA(`${n}.${i}.${s}${o}${l}`,e)};T0.exports=dA});var I0=W(($B,A0)=>{var Bd=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){let i=this.map.keys().next().value;this.delete(i)}this.map.set(e,t)}return this}};A0.exports=Bd});var Cr=W((VB,U0)=>{var hA=/\s+/g,Md=class r{constructor(e,t){if(t=mA(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof qd)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(hA," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(i=>!D0(i[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&SA(i[0])){this.set=[i];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let n=0;n<t.length;n++)n>0&&(this.formatted+=" "),this.formatted+=t[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&vA)|(this.options.loose&&_A))+":"+e,i=O0.get(n);if(i)return i;let s=this.options.loose,o=s?Wt[Ut.HYPHENRANGELOOSE]:Wt[Ut.HYPHENRANGE];e=e.replace(o,DA(this.options.includePrerelease)),Ke("hyphen replace",e),e=e.replace(Wt[Ut.COMPARATORTRIM],yA),Ke("comparator trim",e),e=e.replace(Wt[Ut.TILDETRIM],wA),Ke("tilde trim",e),e=e.replace(Wt[Ut.CARETTRIM],bA),Ke("caret trim",e);let l=e.split(" ").map(h=>xA(h,this.options)).join(" ").split(/\s+/).map(h=>OA(h,this.options));s&&(l=l.filter(h=>(Ke("loose invalid filter",h,this.options),!!h.match(Wt[Ut.COMPARATORLOOSE])))),Ke("range list",l);let u=new Map,d=l.map(h=>new qd(h,this.options));for(let h of d){if(D0(h))return[h];u.set(h.value,h)}u.size>1&&u.has("")&&u.delete("");let f=[...u.values()];return O0.set(n,f),f}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some(n=>P0(n,t)&&e.set.some(i=>P0(i,t)&&n.every(s=>i.every(o=>s.intersects(o,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new gA(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(PA(this.set[t],e,this.options))return!0;return!1}};U0.exports=Md;var pA=I0(),O0=new pA,mA=wl(),qd=ga(),Ke=pa(),gA=Rt(),{safeRe:Wt,t:Ut,comparatorTrimReplace:yA,tildeTrimReplace:wA,caretTrimReplace:bA}=ro(),{FLAG_INCLUDE_PRERELEASE:vA,FLAG_LOOSE:_A}=ha(),D0=r=>r.value==="<0.0.0-0",SA=r=>r.value==="",P0=(r,e)=>{let t=!0,n=r.slice(),i=n.pop();for(;t&&n.length;)t=n.every(s=>i.intersects(s,e)),i=n.pop();return t},xA=(r,e)=>(Ke("comp",r,e),r=kA(r,e),Ke("caret",r),r=EA(r,e),Ke("tildes",r),r=RA(r,e),Ke("xrange",r),r=IA(r,e),Ke("stars",r),r),Lt=r=>!r||r.toLowerCase()==="x"||r==="*",EA=(r,e)=>r.trim().split(/\s+/).map(t=>CA(t,e)).join(" "),CA=(r,e)=>{let t=e.loose?Wt[Ut.TILDELOOSE]:Wt[Ut.TILDE];return r.replace(t,(n,i,s,o,l)=>{Ke("tilde",r,n,i,s,o,l);let u;return Lt(i)?u="":Lt(s)?u=`>=${i}.0.0 <${+i+1}.0.0-0`:Lt(o)?u=`>=${i}.${s}.0 <${i}.${+s+1}.0-0`:l?(Ke("replaceTilde pr",l),u=`>=${i}.${s}.${o}-${l} <${i}.${+s+1}.0-0`):u=`>=${i}.${s}.${o} <${i}.${+s+1}.0-0`,Ke("tilde return",u),u})},kA=(r,e)=>r.trim().split(/\s+/).map(t=>TA(t,e)).join(" "),TA=(r,e)=>{Ke("caret",r,e);let t=e.loose?Wt[Ut.CARETLOOSE]:Wt[Ut.CARET],n=e.includePrerelease?"-0":"";return r.replace(t,(i,s,o,l,u)=>{Ke("caret",r,i,s,o,l,u);let d;return Lt(s)?d="":Lt(o)?d=`>=${s}.0.0${n} <${+s+1}.0.0-0`:Lt(l)?s==="0"?d=`>=${s}.${o}.0${n} <${s}.${+o+1}.0-0`:d=`>=${s}.${o}.0${n} <${+s+1}.0.0-0`:u?(Ke("replaceCaret pr",u),s==="0"?o==="0"?d=`>=${s}.${o}.${l}-${u} <${s}.${o}.${+l+1}-0`:d=`>=${s}.${o}.${l}-${u} <${s}.${+o+1}.0-0`:d=`>=${s}.${o}.${l}-${u} <${+s+1}.0.0-0`):(Ke("no pr"),s==="0"?o==="0"?d=`>=${s}.${o}.${l}${n} <${s}.${o}.${+l+1}-0`:d=`>=${s}.${o}.${l}${n} <${s}.${+o+1}.0-0`:d=`>=${s}.${o}.${l} <${+s+1}.0.0-0`),Ke("caret return",d),d})},RA=(r,e)=>(Ke("replaceXRanges",r,e),r.split(/\s+/).map(t=>AA(t,e)).join(" ")),AA=(r,e)=>{r=r.trim();let t=e.loose?Wt[Ut.XRANGELOOSE]:Wt[Ut.XRANGE];return r.replace(t,(n,i,s,o,l,u)=>{Ke("xRange",r,n,i,s,o,l,u);let d=Lt(s),f=d||Lt(o),h=f||Lt(l),m=h;return i==="="&&m&&(i=""),u=e.includePrerelease?"-0":"",d?i===">"||i==="<"?n="<0.0.0-0":n="*":i&&m?(f&&(o=0),l=0,i===">"?(i=">=",f?(s=+s+1,o=0,l=0):(o=+o+1,l=0)):i==="<="&&(i="<",f?s=+s+1:o=+o+1),i==="<"&&(u="-0"),n=`${i+s}.${o}.${l}${u}`):f?n=`>=${s}.0.0${u} <${+s+1}.0.0-0`:h&&(n=`>=${s}.${o}.0${u} <${s}.${+o+1}.0-0`),Ke("xRange return",n),n})},IA=(r,e)=>(Ke("replaceStars",r,e),r.trim().replace(Wt[Ut.STAR],"")),OA=(r,e)=>(Ke("replaceGTE0",r,e),r.trim().replace(Wt[e.includePrerelease?Ut.GTE0PRE:Ut.GTE0],"")),DA=r=>(e,t,n,i,s,o,l,u,d,f,h,m)=>(Lt(n)?t="":Lt(i)?t=`>=${n}.0.0${r?"-0":""}`:Lt(s)?t=`>=${n}.${i}.0${r?"-0":""}`:o?t=`>=${t}`:t=`>=${t}${r?"-0":""}`,Lt(d)?u="":Lt(f)?u=`<${+d+1}.0.0-0`:Lt(h)?u=`<${d}.${+f+1}.0-0`:m?u=`<=${d}.${f}.${h}-${m}`:r?u=`<${d}.${f}.${+h+1}-0`:u=`<=${u}`,`${t} ${u}`.trim()),PA=(r,e,t)=>{for(let n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let n=0;n<r.length;n++)if(Ke(r[n].semver),r[n].semver!==qd.ANY&&r[n].semver.prerelease.length>0){let i=r[n].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var ga=W((WB,q0)=>{var ya=Symbol("SemVer ANY"),Vd=class r{static get ANY(){return ya}constructor(e,t){if(t=L0(t),e instanceof r){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),$d("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===ya?this.value="":this.value=this.operator+this.semver.version,$d("comp",this)}parse(e){let t=this.options.loose?F0[N0.COMPARATORLOOSE]:F0[N0.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new B0(n[2],this.options.loose):this.semver=ya}toString(){return this.value}test(e){if($d("Comparator.test",e,this.options.loose),this.semver===ya||e===ya)return!0;if(typeof e=="string")try{e=new B0(e,this.options)}catch{return!1}return jd(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new M0(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new M0(this.value,t).test(e.semver):(t=L0(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||jd(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||jd(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};q0.exports=Vd;var L0=wl(),{safeRe:F0,t:N0}=ro(),jd=Nd(),$d=pa(),B0=Rt(),M0=Cr()});var wa=W((zB,j0)=>{var UA=Cr(),LA=(r,e,t)=>{try{e=new UA(e,t)}catch{return!1}return e.test(r)};j0.exports=LA});var V0=W((HB,$0)=>{var FA=Cr(),NA=(r,e)=>new FA(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));$0.exports=NA});var z0=W((GB,W0)=>{var BA=Rt(),MA=Cr(),qA=(r,e,t)=>{let n=null,i=null,s=null;try{s=new MA(e,t)}catch{return null}return r.forEach(o=>{s.test(o)&&(!n||i.compare(o)===-1)&&(n=o,i=new BA(n,t))}),n};W0.exports=qA});var G0=W((YB,H0)=>{var jA=Rt(),$A=Cr(),VA=(r,e,t)=>{let n=null,i=null,s=null;try{s=new $A(e,t)}catch{return null}return r.forEach(o=>{s.test(o)&&(!n||i.compare(o)===1)&&(n=o,i=new jA(n,t))}),n};H0.exports=VA});var J0=W((KB,K0)=>{var Wd=Rt(),WA=Cr(),Y0=ma(),zA=(r,e)=>{r=new WA(r,e);let t=new Wd("0.0.0");if(r.test(t)||(t=new Wd("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){let i=r.set[n],s=null;i.forEach(o=>{let l=new Wd(o.semver.version);switch(o.operator){case">":l.prerelease.length===0?l.patch++:l.prerelease.push(0),l.raw=l.format();case"":case">=":(!s||Y0(l,s))&&(s=l);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),s&&(!t||Y0(t,s))&&(t=s)}return t&&r.test(t)?t:null};K0.exports=zA});var X0=W((JB,Q0)=>{var HA=Cr(),GA=(r,e)=>{try{return new HA(r,e).range||"*"}catch{return null}};Q0.exports=GA});var Rl=W((QB,rw)=>{var YA=Rt(),tw=ga(),{ANY:KA}=tw,JA=Cr(),QA=wa(),Z0=ma(),ew=xl(),XA=Cl(),ZA=El(),e1=(r,e,t,n)=>{r=new YA(r,n),e=new JA(e,n);let i,s,o,l,u;switch(t){case">":i=Z0,s=XA,o=ew,l=">",u=">=";break;case"<":i=ew,s=ZA,o=Z0,l="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(QA(r,e,n))return!1;for(let d=0;d<e.set.length;++d){let f=e.set[d],h=null,m=null;if(f.forEach(g=>{g.semver===KA&&(g=new tw(">=0.0.0")),h=h||g,m=m||g,i(g.semver,h.semver,n)?h=g:o(g.semver,m.semver,n)&&(m=g)}),h.operator===l||h.operator===u||(!m.operator||m.operator===l)&&s(r,m.semver))return!1;if(m.operator===u&&o(r,m.semver))return!1}return!0};rw.exports=e1});var iw=W((XB,nw)=>{var t1=Rl(),r1=(r,e,t)=>t1(r,e,">",t);nw.exports=r1});var ow=W((ZB,sw)=>{var n1=Rl(),i1=(r,e,t)=>n1(r,e,"<",t);sw.exports=i1});var lw=W((e2,cw)=>{var aw=Cr(),s1=(r,e,t)=>(r=new aw(r,t),e=new aw(e,t),r.intersects(e,t));cw.exports=s1});var fw=W((t2,uw)=>{var o1=wa(),a1=Er();uw.exports=(r,e,t)=>{let n=[],i=null,s=null,o=r.sort((f,h)=>a1(f,h,t));for(let f of o)o1(f,e,t)?(s=f,i||(i=f)):(s&&n.push([i,s]),s=null,i=null);i&&n.push([i,null]);let l=[];for(let[f,h]of n)f===h?l.push(f):!h&&f===o[0]?l.push("*"):h?f===o[0]?l.push(`<=${h}`):l.push(`${f} - ${h}`):l.push(`>=${f}`);let u=l.join(" || "),d=typeof e.raw=="string"?e.raw:String(e);return u.length<d.length?u:e}});var yw=W((r2,gw)=>{var dw=Cr(),Hd=ga(),{ANY:zd}=Hd,ba=wa(),Gd=Er(),c1=(r,e,t={})=>{if(r===e)return!0;r=new dw(r,t),e=new dw(e,t);let n=!1;e:for(let i of r.set){for(let s of e.set){let o=u1(i,s,t);if(n=n||o!==null,o)continue e}if(n)return!1}return!0},l1=[new Hd(">=0.0.0-0")],hw=[new Hd(">=0.0.0")],u1=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===zd){if(e.length===1&&e[0].semver===zd)return!0;t.includePrerelease?r=l1:r=hw}if(e.length===1&&e[0].semver===zd){if(t.includePrerelease)return!0;e=hw}let n=new Set,i,s;for(let g of r)g.operator===">"||g.operator===">="?i=pw(i,g,t):g.operator==="<"||g.operator==="<="?s=mw(s,g,t):n.add(g.semver);if(n.size>1)return null;let o;if(i&&s){if(o=Gd(i.semver,s.semver,t),o>0)return null;if(o===0&&(i.operator!==">="||s.operator!=="<="))return null}for(let g of n){if(i&&!ba(g,String(i),t)||s&&!ba(g,String(s),t))return null;for(let y of e)if(!ba(g,String(y),t))return!1;return!0}let l,u,d,f,h=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1,m=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1;h&&h.prerelease.length===1&&s.operator==="<"&&h.prerelease[0]===0&&(h=!1);for(let g of e){if(f=f||g.operator===">"||g.operator===">=",d=d||g.operator==="<"||g.operator==="<=",i){if(m&&g.semver.prerelease&&g.semver.prerelease.length&&g.semver.major===m.major&&g.semver.minor===m.minor&&g.semver.patch===m.patch&&(m=!1),g.operator===">"||g.operator===">="){if(l=pw(i,g,t),l===g&&l!==i)return!1}else if(i.operator===">="&&!ba(i.semver,String(g),t))return!1}if(s){if(h&&g.semver.prerelease&&g.semver.prerelease.length&&g.semver.major===h.major&&g.semver.minor===h.minor&&g.semver.patch===h.patch&&(h=!1),g.operator==="<"||g.operator==="<="){if(u=mw(s,g,t),u===g&&u!==s)return!1}else if(s.operator==="<="&&!ba(s.semver,String(g),t))return!1}if(!g.operator&&(s||i)&&o!==0)return!1}return!(i&&d&&!s&&o!==0||s&&f&&!i&&o!==0||m||h)},pw=(r,e,t)=>{if(!r)return e;let n=Gd(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},mw=(r,e,t)=>{if(!r)return e;let n=Gd(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};gw.exports=c1});var Kd=W((n2,vw)=>{var Yd=ro(),ww=ha(),f1=Rt(),bw=Pd(),d1=rs(),h1=zy(),p1=Gy(),m1=Jy(),g1=Zy(),y1=t0(),w1=n0(),b1=s0(),v1=a0(),_1=Er(),S1=f0(),x1=h0(),E1=Sl(),C1=y0(),k1=b0(),T1=ma(),R1=xl(),A1=Ld(),I1=Fd(),O1=El(),D1=Cl(),P1=Nd(),U1=R0(),L1=ga(),F1=Cr(),N1=wa(),B1=V0(),M1=z0(),q1=G0(),j1=J0(),$1=X0(),V1=Rl(),W1=iw(),z1=ow(),H1=lw(),G1=fw(),Y1=yw();vw.exports={parse:d1,valid:h1,clean:p1,inc:m1,diff:g1,major:y1,minor:w1,patch:b1,prerelease:v1,compare:_1,rcompare:S1,compareLoose:x1,compareBuild:E1,sort:C1,rsort:k1,gt:T1,lt:R1,eq:A1,neq:I1,gte:O1,lte:D1,cmp:P1,coerce:U1,Comparator:L1,Range:F1,satisfies:N1,toComparators:B1,maxSatisfying:M1,minSatisfying:q1,minVersion:j1,validRange:$1,outside:V1,gtr:W1,ltr:z1,intersects:H1,simplifyRange:G1,subset:Y1,SemVer:f1,re:Yd.re,src:Yd.src,tokens:Yd.t,SEMVER_SPEC_VERSION:ww.SEMVER_SPEC_VERSION,RELEASE_TYPES:ww.RELEASE_TYPES,compareIdentifiers:bw.compareIdentifiers,rcompareIdentifiers:bw.rcompareIdentifiers}});var ob=W((O2,sb)=>{"use strict";var ib=()=>process.platform==="linux",ql=null,xI=()=>{if(!ql)if(ib()&&process.report){let r=process.report.excludeNetwork;process.report.excludeNetwork=!0,ql=process.report.getReport(),process.report.excludeNetwork=r}else ql={};return ql};sb.exports={isLinux:ib,getReport:xI}});var lb=W((D2,cb)=>{"use strict";var ab=require("fs"),EI="/usr/bin/ldd",CI=r=>ab.readFileSync(r,"utf-8"),kI=r=>new Promise((e,t)=>{ab.readFile(r,"utf-8",(n,i)=>{n?t(n):e(i)})});cb.exports={LDD_PATH:EI,readFileSync:CI,readFile:kI}});var Tb=W((P2,kb)=>{"use strict";var fb=require("child_process"),{isLinux:lo,getReport:db}=ob(),{LDD_PATH:jl,readFile:hb,readFileSync:pb}=lb(),hn,pn,mb="getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true",bi="",gb=()=>bi||new Promise(r=>{fb.exec(mb,(e,t)=>{bi=e?" ":t,r(bi)})}),yb=()=>{if(!bi)try{bi=fb.execSync(mb,{encoding:"utf8"})}catch{bi=" "}return bi},vi="glibc",wb=/LIBC[a-z0-9 \-).]*?(\d+\.\d+)/i,co="musl",TI=r=>r.includes("libc.musl-")||r.includes("ld-musl-"),bb=()=>{let r=db();return r.header&&r.header.glibcVersionRuntime?vi:Array.isArray(r.sharedObjects)&&r.sharedObjects.some(TI)?co:null},vb=r=>{let[e,t]=r.split(/[\r\n]+/);return e&&e.includes(vi)?vi:t&&t.includes(co)?co:null},_b=r=>r.includes("musl")?co:r.includes("GNU C Library")?vi:null,RI=async()=>{if(hn!==void 0)return hn;hn=null;try{let r=await hb(jl);hn=_b(r)}catch{}return hn},AI=()=>{if(hn!==void 0)return hn;hn=null;try{let r=pb(jl);hn=_b(r)}catch{}return hn},Sb=async()=>{let r=null;if(lo()&&(r=await RI(),r||(r=bb()),!r)){let e=await gb();r=vb(e)}return r},xb=()=>{let r=null;if(lo()&&(r=AI(),r||(r=bb()),!r)){let e=yb();r=vb(e)}return r},II=async()=>lo()&&await Sb()!==vi,OI=()=>lo()&&xb()!==vi,DI=async()=>{if(pn!==void 0)return pn;pn=null;try{let e=(await hb(jl)).match(wb);e&&(pn=e[1])}catch{}return pn},PI=()=>{if(pn!==void 0)return pn;pn=null;try{let e=pb(jl).match(wb);e&&(pn=e[1])}catch{}return pn},Eb=()=>{let r=db();return r.header&&r.header.glibcVersionRuntime?r.header.glibcVersionRuntime:null},ub=r=>r.trim().split(/\s+/)[1],Cb=r=>{let[e,t,n]=r.split(/[\r\n]+/);return e&&e.includes(vi)?ub(e):t&&n&&t.includes(co)?ub(n):null},UI=async()=>{let r=null;if(lo()&&(r=await DI(),r||(r=Eb()),!r)){let e=await gb();r=Cb(e)}return r},LI=()=>{let r=null;if(lo()&&(r=PI(),r||(r=Eb()),!r)){let e=yb();r=Cb(e)}return r};kb.exports={GLIBC:vi,MUSL:co,family:Sb,familySync:xb,isNonGlibcLinux:II,isNonGlibcLinuxSync:OI,version:UI,versionSync:LI}});var jb=W((U2,qb)=>{var FI=require("fs"),Wr=require("path"),NI=require("url"),Ib=require("os"),Ob=typeof __webpack_require__=="function"?__non_webpack_require__:require,BI=process.config&&process.config.variables||{},MI=!!process.env.PREBUILDS_ONLY,xh=process.versions,vh=xh.modules;(xh.deno||process.isBun)&&(vh="unsupported");var bh=$I()?"electron":jI()?"node-webkit":"node",$l=process.env.npm_config_arch||Ib.arch(),Vl=process.env.npm_config_platform||Ib.platform(),Db=process.env.LIBC||(VI(Vl)?"musl":"glibc"),_h=process.env.ARM_VERSION||($l==="arm64"?"8":BI.arm_version)||"",Pb=(xh.uv||"").split(".")[0];qb.exports=mn;function mn(r){return Ob(mn.resolve(r))}mn.resolve=mn.path=function(r){r=Wr.resolve(r||".");var e="",t;try{e=Ob(Wr.join(r,"package.json")).name;var n=e.toUpperCase().replace(/-/g,"_");process.env[n+"_PREBUILD"]&&(r=process.env[n+"_PREBUILD"])}catch(b){t=b}if(!MI){var i=Rb(Wr.join(r,"build/Release"),Ab);if(i)return i;var s=Rb(Wr.join(r,"build/Debug"),Ab);if(s)return s}var o=g(r);if(o)return o;var l=g(Wr.dirname(process.execPath));if(l)return l;var u=(e[0]=="@"?"":"@"+e+"/")+e+"-"+Vl+"-"+$l,d;try{var f=Wr.dirname(require("module").createRequire(NI.pathToFileURL(Wr.join(r,"package.json"))).resolve(u));return y(f)}catch(b){d=b}var h=["platform="+Vl,"arch="+$l,"runtime="+bh,"abi="+vh,"uv="+Pb,_h?"armv="+_h:"","libc="+Db,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__=="function"?"webpack=true":""].filter(Boolean).join(" ");let m="No native build was found for "+h+`
    attempted loading from: `+r+" and package: "+u+`
`;throw t&&(m+="Error finding package.json: "+t.message+`
`),d&&(m+="Error resolving package: "+d.message+`
`),new Error(m);function g(b){var C=Sh(Wr.join(b,"prebuilds")).map(Ub),L=C.filter(Lb(Vl,$l)).sort(Fb)[0];if(L)return y(Wr.join(b,"prebuilds",L.name))}function y(b){var C=Sh(b).map(Nb),L=C.filter(Bb(bh,vh)),j=L.sort(Mb(bh))[0];if(j)return Wr.join(b,j.file)}};function Sh(r){try{return FI.readdirSync(r)}catch{return[]}}function Rb(r,e){var t=Sh(r).filter(e);return t[0]&&Wr.join(r,t[0])}function Ab(r){return/\.node$/.test(r)}function Ub(r){var e=r.split("-");if(e.length===2){var t=e[0],n=e[1].split("+");if(t&&n.length&&n.every(Boolean))return{name:r,platform:t,architectures:n}}}function Lb(r,e){return function(t){return t==null||t.platform!==r?!1:t.architectures.includes(e)}}function Fb(r,e){return r.architectures.length-e.architectures.length}function Nb(r){var e=r.split("."),t=e.pop(),n={file:r,specificity:0};if(t==="node"){for(var i=0;i<e.length;i++){var s=e[i];if(s==="node"||s==="electron"||s==="node-webkit")n.runtime=s;else if(s==="napi")n.napi=!0;else if(s.slice(0,3)==="abi")n.abi=s.slice(3);else if(s.slice(0,2)==="uv")n.uv=s.slice(2);else if(s.slice(0,4)==="armv")n.armv=s.slice(4);else if(s==="glibc"||s==="musl")n.libc=s;else continue;n.specificity++}return n}}function Bb(r,e){return function(t){return!(t==null||t.runtime!==r&&!qI(t)||t.abi!==e&&!t.napi||t.uv&&t.uv!==Pb||t.armv&&t.armv!==_h||t.libc&&t.libc!==Db)}}function qI(r){return r.runtime==="node"&&r.napi}function Mb(r){return function(e,t){return e.runtime!==t.runtime?e.runtime===r?-1:1:e.abi!==t.abi?e.abi?-1:1:e.specificity!==t.specificity?e.specificity>t.specificity?-1:1:0}}function jI(){return!!(process.versions&&process.versions.nw)}function $I(){return process.versions&&process.versions.electron||process.env.ELECTRON_RUN_AS_NODE?!0:typeof window<"u"&&window.process&&window.process.type==="renderer"}function VI(r){if(r!=="linux")return!1;let{familySync:e,MUSL:t}=Tb();return e()===t}mn.parseTags=Nb;mn.matchTags=Bb;mn.compareTags=Mb;mn.parseTuple=Ub;mn.matchTuple=Lb;mn.compareTuples=Fb});var $b=W((L2,Ch)=>{var Eh=typeof __webpack_require__=="function"?__non_webpack_require__:require;typeof Eh.addon=="function"?Ch.exports=Eh.addon.bind(Eh):Ch.exports=jb()});var Wb=W((F2,Vb)=>{Vb.exports=$b()(__dirname)});var av=W(Hl=>{"use strict";Hl.byteLength=yO;Hl.toByteArray=bO;Hl.fromByteArray=SO;var yn=[],Rr=[],gO=typeof Uint8Array<"u"?Uint8Array:Array,Fh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(ps=0,sv=Fh.length;ps<sv;++ps)yn[ps]=Fh[ps],Rr[Fh.charCodeAt(ps)]=ps;var ps,sv;Rr[45]=62;Rr[95]=63;function ov(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function yO(r){var e=ov(r),t=e[0],n=e[1];return(t+n)*3/4-n}function wO(r,e,t){return(e+t)*3/4-t}function bO(r){var e,t=ov(r),n=t[0],i=t[1],s=new gO(wO(r,n,i)),o=0,l=i>0?n-4:n,u;for(u=0;u<l;u+=4)e=Rr[r.charCodeAt(u)]<<18|Rr[r.charCodeAt(u+1)]<<12|Rr[r.charCodeAt(u+2)]<<6|Rr[r.charCodeAt(u+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=Rr[r.charCodeAt(u)]<<2|Rr[r.charCodeAt(u+1)]>>4,s[o++]=e&255),i===1&&(e=Rr[r.charCodeAt(u)]<<10|Rr[r.charCodeAt(u+1)]<<4|Rr[r.charCodeAt(u+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function vO(r){return yn[r>>18&63]+yn[r>>12&63]+yn[r>>6&63]+yn[r&63]}function _O(r,e,t){for(var n,i=[],s=e;s<t;s+=3)n=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),i.push(vO(n));return i.join("")}function SO(r){for(var e,t=r.length,n=t%3,i=[],s=16383,o=0,l=t-n;o<l;o+=s)i.push(_O(r,o,o+s>l?l:o+s));return n===1?(e=r[t-1],i.push(yn[e>>2]+yn[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],i.push(yn[e>>10]+yn[e>>4&63]+yn[e<<2&63]+"=")),i.join("")}});var fv=W((f3,uv)=>{var fo=require("fs"),lv=require("url"),xO=require("child_process").spawn;uv.exports=Bh;Bh.XMLHttpRequest=Bh;function Bh(r){"use strict";r=r||{};var e=this,t=require("http"),n=require("https"),i,s,o={},l=!1,u={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},d=Object.assign({},u),f=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],h=["TRACE","TRACK","CONNECT"],m=!1,g=!1,y=!1,b={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),this.status=null,this.statusText=null;var C=function(O){return l||O&&f.indexOf(O.toLowerCase())===-1},L=function(O){return O&&h.indexOf(O)===-1};this.open=function(O,D,N,k,P){if(this.abort(),g=!1,y=!1,!L(O))throw new Error("SecurityError: Request method not allowed");o={method:O,url:D.toString(),async:typeof N!="boolean"?!0:N,user:k||null,password:P||null},j(this.OPENED)},this.setDisableHeaderCheck=function(O){l=O},this.setRequestHeader=function(O,D){if(this.readyState!=this.OPENED)throw new Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!C(O))return console.warn('Refused to set unsafe header "'+O+'"'),!1;if(m)throw new Error("INVALID_STATE_ERR: send flag is true");return d[O]=D,!0},this.getResponseHeader=function(O){return typeof O=="string"&&this.readyState>this.OPENED&&s.headers[O.toLowerCase()]&&!g?s.headers[O.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||g)return"";var O="";for(var D in s.headers)D!=="set-cookie"&&D!=="set-cookie2"&&(O+=D+": "+s.headers[D]+`\r
`);return O.substr(0,O.length-2)},this.getRequestHeader=function(O){return typeof O=="string"&&d[O]?d[O]:""},this.send=function(O){if(this.readyState!=this.OPENED)throw new Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(m)throw new Error("INVALID_STATE_ERR: send has already been called");var D=!1,N=!1,k=lv.parse(o.url),P;switch(k.protocol){case"https:":D=!0;case"http:":P=k.hostname;break;case"file:":N=!0;break;case void 0:case"":P="localhost";break;default:throw new Error("Protocol not supported.")}if(N){if(o.method!=="GET")throw new Error("XMLHttpRequest: Only GET method is supported");if(o.async)fo.readFile(unescape(k.pathname),function(ue,J){ue?e.handleError(ue,ue.errno||-1):(e.status=200,e.responseText=J.toString("utf8"),e.response=J,j(e.DONE))});else try{this.response=fo.readFileSync(unescape(k.pathname)),this.responseText=this.response.toString("utf8"),this.status=200,j(e.DONE)}catch(ue){this.handleError(ue,ue.errno||-1)}return}var R=k.port||(D?443:80),M=k.pathname+(k.search?k.search:"");if(d.Host=P,D&&R===443||R===80||(d.Host+=":"+k.port),o.user){typeof o.password>"u"&&(o.password="");var Q=new Buffer(o.user+":"+o.password);d.Authorization="Basic "+Q.toString("base64")}if(o.method==="GET"||o.method==="HEAD")O=null;else if(O){d["Content-Length"]=Buffer.isBuffer(O)?O.length:Buffer.byteLength(O);var te=Object.keys(d);te.some(function(ue){return ue.toLowerCase()==="content-type"})||(d["Content-Type"]="text/plain;charset=UTF-8")}else o.method==="POST"&&(d["Content-Length"]=0);var he=r.agent||!1,pe={host:P,port:R,path:M,method:o.method,headers:d,agent:he};if(D&&(pe.pfx=r.pfx,pe.key=r.key,pe.passphrase=r.passphrase,pe.cert=r.cert,pe.ca=r.ca,pe.ciphers=r.ciphers,pe.rejectUnauthorized=r.rejectUnauthorized!==!1),g=!1,o.async){var S=D?n.request:t.request;m=!0,e.dispatchEvent("readystatechange");var $=function(ue){if(s=ue,s.statusCode===302||s.statusCode===303||s.statusCode===307){o.url=s.headers.location;var J=lv.parse(o.url);P=J.hostname;var Ue={hostname:J.hostname,port:J.port,path:J.path,method:s.statusCode===303?"GET":o.method,headers:d};D&&(Ue.pfx=r.pfx,Ue.key=r.key,Ue.passphrase=r.passphrase,Ue.cert=r.cert,Ue.ca=r.ca,Ue.ciphers=r.ciphers,Ue.rejectUnauthorized=r.rejectUnauthorized!==!1),i=S(Ue,$).on("error",q),i.end();return}j(e.HEADERS_RECEIVED),e.status=s.statusCode,s.on("data",function(kt){if(kt){var nt=Buffer.from(kt);e.response=Buffer.concat([e.response,nt])}m&&j(e.LOADING)}),s.on("end",function(){m&&(m=!1,j(e.DONE),e.responseText=e.response.toString("utf8"))}),s.on("error",function(kt){e.handleError(kt)})},q=function(ue){if(i.reusedSocket&&ue.code==="ECONNRESET")return S(pe,$).on("error",q);e.handleError(ue)};i=S(pe,$).on("error",q),r.autoUnref&&i.on("socket",ue=>{ue.unref()}),O&&i.write(O),i.end(),e.dispatchEvent("loadstart")}else{var F=".node-xmlhttprequest-content-"+process.pid,V=".node-xmlhttprequest-sync-"+process.pid;fo.writeFileSync(V,"","utf8");for(var X="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(D?"s":"")+".request;var options = "+JSON.stringify(pe)+";var responseText = '';var responseData = Buffer.alloc(0);var req = doRequest(options, function(response) {response.on('data', function(chunk) {  var data = Buffer.from(chunk);  responseText += data.toString('utf8');  responseData = Buffer.concat([responseData, data]);});response.on('end', function() {fs.writeFileSync('"+F+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText, data: responseData.toString('base64')}}), 'utf8');fs.unlinkSync('"+V+"');});response.on('error', function(error) {fs.writeFileSync('"+F+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+V+"');});}).on('error', function(error) {fs.writeFileSync('"+F+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+V+"');});"+(O?"req.write('"+JSON.stringify(O).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",me=xO(process.argv[0],["-e",X]),oe;fo.existsSync(V););if(e.responseText=fo.readFileSync(F,"utf8"),me.stdin.end(),fo.unlinkSync(F),e.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)){var z=JSON.parse(e.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,""));e.handleError(z,503)}else{e.status=e.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1");var ce=JSON.parse(e.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1"));s={statusCode:e.status,headers:ce.data.headers},e.responseText=ce.data.text,e.response=Buffer.from(ce.data.data,"base64"),j(e.DONE,!0)}}},this.handleError=function(O,D){this.status=D||0,this.statusText=O,this.responseText=O.stack,g=!0,j(this.DONE)},this.abort=function(){i&&(i.abort(),i=null),d=Object.assign({},u),this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),g=y=!0,this.readyState!==this.UNSENT&&(this.readyState!==this.OPENED||m)&&this.readyState!==this.DONE&&(m=!1,j(this.DONE)),this.readyState=this.UNSENT},this.addEventListener=function(O,D){O in b||(b[O]=[]),b[O].push(D)},this.removeEventListener=function(O,D){O in b&&(b[O]=b[O].filter(function(N){return N!==D}))},this.dispatchEvent=function(O){if(typeof e["on"+O]=="function"&&(this.readyState===this.DONE&&o.async?setTimeout(function(){e["on"+O]()},0):e["on"+O]()),O in b)for(let D=0,N=b[O].length;D<N;D++)this.readyState===this.DONE?setTimeout(function(){b[O][D].call(e)},0):b[O][D].call(e)};var j=function(O){if(!(e.readyState===O||e.readyState===e.UNSENT&&y)&&(e.readyState=O,(o.async||e.readyState<e.OPENED||e.readyState===e.DONE)&&e.dispatchEvent("readystatechange"),e.readyState===e.DONE)){let D;y?D="abort":g?D="error":D="load",e.dispatchEvent(D),e.dispatchEvent("loadend")}}}});var ms=W(vv=>{vv.Emitter=Bt;function Bt(r){if(r)return EO(r)}function EO(r){for(var e in Bt.prototype)r[e]=Bt.prototype[e];return r}Bt.prototype.on=Bt.prototype.addEventListener=function(r,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(e),this};Bt.prototype.once=function(r,e){function t(){this.off(r,t),e.apply(this,arguments)}return t.fn=e,this.on(r,t),this};Bt.prototype.off=Bt.prototype.removeListener=Bt.prototype.removeAllListeners=Bt.prototype.removeEventListener=function(r,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+r];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var n,i=0;i<t.length;i++)if(n=t[i],n===e||n.fn===e){t.splice(i,1);break}return t.length===0&&delete this._callbacks["$"+r],this};Bt.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+r],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t){t=t.slice(0);for(var n=0,i=t.length;n<i;++n)t[n].apply(this,e)}return this};Bt.prototype.emitReserved=Bt.prototype.emit;Bt.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};Bt.prototype.hasListeners=function(r){return!!this.listeners(r).length}});var eu=W((k3,kv)=>{var ho=1e3,po=ho*60,mo=po*60,gs=mo*24,IO=gs*7,OO=gs*365.25;kv.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return DO(r);if(t==="number"&&isFinite(r))return e.long?UO(r):PO(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function DO(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*OO;case"weeks":case"week":case"w":return t*IO;case"days":case"day":case"d":return t*gs;case"hours":case"hour":case"hrs":case"hr":case"h":return t*mo;case"minutes":case"minute":case"mins":case"min":case"m":return t*po;case"seconds":case"second":case"secs":case"sec":case"s":return t*ho;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function PO(r){var e=Math.abs(r);return e>=gs?Math.round(r/gs)+"d":e>=mo?Math.round(r/mo)+"h":e>=po?Math.round(r/po)+"m":e>=ho?Math.round(r/ho)+"s":r+"ms"}function UO(r){var e=Math.abs(r);return e>=gs?Zl(r,e,gs,"day"):e>=mo?Zl(r,e,mo,"hour"):e>=po?Zl(r,e,po,"minute"):e>=ho?Zl(r,e,ho,"second"):r+" ms"}function Zl(r,e,t,n){var i=e>=t*1.5;return Math.round(r/t)+" "+n+(i?"s":"")}});var Vh=W((T3,Tv)=>{function LO(r){t.debug=t,t.default=t,t.coerce=u,t.disable=s,t.enable=i,t.enabled=o,t.humanize=eu(),t.destroy=d,Object.keys(r).forEach(f=>{t[f]=r[f]}),t.names=[],t.skips=[],t.formatters={};function e(f){let h=0;for(let m=0;m<f.length;m++)h=(h<<5)-h+f.charCodeAt(m),h|=0;return t.colors[Math.abs(h)%t.colors.length]}t.selectColor=e;function t(f){let h,m=null,g,y;function b(...C){if(!b.enabled)return;let L=b,j=Number(new Date),O=j-(h||j);L.diff=O,L.prev=h,L.curr=j,h=j,C[0]=t.coerce(C[0]),typeof C[0]!="string"&&C.unshift("%O");let D=0;C[0]=C[0].replace(/%([a-zA-Z%])/g,(k,P)=>{if(k==="%%")return"%";D++;let R=t.formatters[P];if(typeof R=="function"){let M=C[D];k=R.call(L,M),C.splice(D,1),D--}return k}),t.formatArgs.call(L,C),(L.log||t.log).apply(L,C)}return b.namespace=f,b.useColors=t.useColors(),b.color=t.selectColor(f),b.extend=n,b.destroy=t.destroy,Object.defineProperty(b,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(g!==t.namespaces&&(g=t.namespaces,y=t.enabled(f)),y),set:C=>{m=C}}),typeof t.init=="function"&&t.init(b),b}function n(f,h){let m=t(this.namespace+(typeof h>"u"?":":h)+f);return m.log=this.log,m}function i(f){t.save(f),t.namespaces=f,t.names=[],t.skips=[];let h,m=(typeof f=="string"?f:"").split(/[\s,]+/),g=m.length;for(h=0;h<g;h++)m[h]&&(f=m[h].replace(/\*/g,".*?"),f[0]==="-"?t.skips.push(new RegExp("^"+f.slice(1)+"$")):t.names.push(new RegExp("^"+f+"$")))}function s(){let f=[...t.names.map(l),...t.skips.map(l).map(h=>"-"+h)].join(",");return t.enable(""),f}function o(f){if(f[f.length-1]==="*")return!0;let h,m;for(h=0,m=t.skips.length;h<m;h++)if(t.skips[h].test(f))return!1;for(h=0,m=t.names.length;h<m;h++)if(t.names[h].test(f))return!0;return!1}function l(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function u(f){return f instanceof Error?f.stack||f.message:f}function d(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}Tv.exports=LO});var Rv=W((lr,tu)=>{lr.formatArgs=NO;lr.save=BO;lr.load=MO;lr.useColors=FO;lr.storage=qO();lr.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();lr.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function FO(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let r;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(r=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(r[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function NO(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+tu.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(t++,i==="%c"&&(n=t))}),r.splice(n,0,e)}lr.log=console.debug||console.log||(()=>{});function BO(r){try{r?lr.storage.setItem("debug",r):lr.storage.removeItem("debug")}catch{}}function MO(){let r;try{r=lr.storage.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function qO(){try{return localStorage}catch{}}tu.exports=Vh()(lr);var{formatters:jO}=tu.exports;jO.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Iv=W((R3,Av)=>{"use strict";Av.exports=(r,e=process.argv)=>{let t=r.startsWith("-")?"":r.length===1?"-":"--",n=e.indexOf(t+r),i=e.indexOf("--");return n!==-1&&(i===-1||n<i)}});var nu=W((A3,Dv)=>{"use strict";var $O=require("os"),Ov=require("tty"),Ar=Iv(),{env:yt}=process,ru;Ar("no-color")||Ar("no-colors")||Ar("color=false")||Ar("color=never")?ru=0:(Ar("color")||Ar("colors")||Ar("color=true")||Ar("color=always"))&&(ru=1);function VO(){if("FORCE_COLOR"in yt)return yt.FORCE_COLOR==="true"?1:yt.FORCE_COLOR==="false"?0:yt.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(yt.FORCE_COLOR,10),3)}function WO(r){return r===0?!1:{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3}}function zO(r,{streamIsTTY:e,sniffFlags:t=!0}={}){let n=VO();n!==void 0&&(ru=n);let i=t?ru:n;if(i===0)return 0;if(t){if(Ar("color=16m")||Ar("color=full")||Ar("color=truecolor"))return 3;if(Ar("color=256"))return 2}if(r&&!e&&i===void 0)return 0;let s=i||0;if(yt.TERM==="dumb")return s;if(process.platform==="win32"){let o=$O.release().split(".");return Number(o[0])>=10&&Number(o[2])>=10586?Number(o[2])>=14931?3:2:1}if("CI"in yt)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some(o=>o in yt)||yt.CI_NAME==="codeship"?1:s;if("TEAMCITY_VERSION"in yt)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(yt.TEAMCITY_VERSION)?1:0;if(yt.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in yt){let o=Number.parseInt((yt.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(yt.TERM_PROGRAM){case"iTerm.app":return o>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(yt.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(yt.TERM)||"COLORTERM"in yt?1:s}function Wh(r,e={}){let t=zO(r,{streamIsTTY:r&&r.isTTY,...e});return WO(t)}Dv.exports={supportsColor:Wh,stdout:Wh({isTTY:Ov.isatty(1)}),stderr:Wh({isTTY:Ov.isatty(2)})}});var Uv=W((wt,su)=>{var HO=require("tty"),iu=require("util");wt.init=ZO;wt.log=JO;wt.formatArgs=YO;wt.save=QO;wt.load=XO;wt.useColors=GO;wt.destroy=iu.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");wt.colors=[6,2,3,4,5,1];try{let r=nu();r&&(r.stderr||r).level>=2&&(wt.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}wt.inspectOpts=Object.keys(process.env).filter(r=>/^debug_/i.test(r)).reduce((r,e)=>{let t=e.substring(6).toLowerCase().replace(/_([a-z])/g,(i,s)=>s.toUpperCase()),n=process.env[e];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),r[t]=n,r},{});function GO(){return"colors"in wt.inspectOpts?!!wt.inspectOpts.colors:HO.isatty(process.stderr.fd)}function YO(r){let{namespace:e,useColors:t}=this;if(t){let n=this.color,i="\x1B[3"+(n<8?n:"8;5;"+n),s=`  ${i};1m${e} \x1B[0m`;r[0]=s+r[0].split(`
`).join(`
`+s),r.push(i+"m+"+su.exports.humanize(this.diff)+"\x1B[0m")}else r[0]=KO()+e+" "+r[0]}function KO(){return wt.inspectOpts.hideDate?"":new Date().toISOString()+" "}function JO(...r){return process.stderr.write(iu.formatWithOptions(wt.inspectOpts,...r)+`
`)}function QO(r){r?process.env.DEBUG=r:delete process.env.DEBUG}function XO(){return process.env.DEBUG}function ZO(r){r.inspectOpts={};let e=Object.keys(wt.inspectOpts);for(let t=0;t<e.length;t++)r.inspectOpts[e[t]]=wt.inspectOpts[e[t]]}su.exports=Vh()(wt);var{formatters:Pv}=su.exports;Pv.o=function(r){return this.inspectOpts.colors=this.useColors,iu.inspect(r,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};Pv.O=function(r){return this.inspectOpts.colors=this.useColors,iu.inspect(r,this.inspectOpts)}});var ys=W((I3,zh)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?zh.exports=Rv():zh.exports=Uv()});var Hv=W((Y3,zv)=>{"use strict";var{Duplex:iD}=require("stream");function Vv(r){r.emit("close")}function sD(){!this.destroyed&&this._writableState.finished&&this.destroy()}function Wv(r){this.removeListener("error",Wv),this.destroy(),this.listenerCount("error")===0&&this.emit("error",r)}function oD(r,e){let t=!0,n=new iD({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return r.on("message",function(s,o){let l=!o&&n._readableState.objectMode?s.toString():s;n.push(l)||r.pause()}),r.once("error",function(s){n.destroyed||(t=!1,n.destroy(s))}),r.once("close",function(){n.destroyed||n.push(null)}),n._destroy=function(i,s){if(r.readyState===r.CLOSED){s(i),process.nextTick(Vv,n);return}let o=!1;r.once("error",function(u){o=!0,s(u)}),r.once("close",function(){o||s(i),process.nextTick(Vv,n)}),t&&r.terminate()},n._final=function(i){if(r.readyState===r.CONNECTING){r.once("open",function(){n._final(i)});return}r._socket!==null&&(r._socket._writableState.finished?(i(),n._readableState.endEmitted&&n.destroy()):(r._socket.once("finish",function(){i()}),r.close()))},n._read=function(){r.isPaused&&r.resume()},n._write=function(i,s,o){if(r.readyState===r.CONNECTING){r.once("open",function(){n._write(i,s,o)});return}r.send(i,o)},n.on("end",sD),n.on("error",Wv),n}zv.exports=oD});var Ei=W((K3,Gv)=>{"use strict";Gv.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var Ua=W((J3,cu)=>{"use strict";var{EMPTY_BUFFER:aD}=Ei(),Yh=Buffer[Symbol.species];function cD(r,e){if(r.length===0)return aD;if(r.length===1)return r[0];let t=Buffer.allocUnsafe(e),n=0;for(let i=0;i<r.length;i++){let s=r[i];t.set(s,n),n+=s.length}return n<e?new Yh(t.buffer,t.byteOffset,n):t}function Yv(r,e,t,n,i){for(let s=0;s<i;s++)t[n+s]=r[s]^e[s&3]}function Kv(r,e){for(let t=0;t<r.length;t++)r[t]^=e[t&3]}function lD(r){return r.length===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.length)}function Kh(r){if(Kh.readOnly=!0,Buffer.isBuffer(r))return r;let e;return r instanceof ArrayBuffer?e=new Yh(r):ArrayBuffer.isView(r)?e=new Yh(r.buffer,r.byteOffset,r.byteLength):(e=Buffer.from(r),Kh.readOnly=!1),e}cu.exports={concat:cD,mask:Yv,toArrayBuffer:lD,toBuffer:Kh,unmask:Kv};if(!process.env.WS_NO_BUFFER_UTIL)try{let r=require("bufferutil");cu.exports.mask=function(e,t,n,i,s){s<48?Yv(e,t,n,i,s):r.mask(e,t,n,i,s)},cu.exports.unmask=function(e,t){e.length<32?Kv(e,t):r.unmask(e,t)}}catch{}});var Xv=W((Q3,Qv)=>{"use strict";var Jv=Symbol("kDone"),Jh=Symbol("kRun"),Qh=class{constructor(e){this[Jv]=()=>{this.pending--,this[Jh]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[Jh]()}[Jh](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[Jv])}}};Qv.exports=Qh});var Na=W((X3,r_)=>{"use strict";var La=require("zlib"),Zv=Ua(),uD=Xv(),{kStatusCode:e_}=Ei(),fD=Buffer[Symbol.species],dD=Buffer.from([0,0,255,255]),fu=Symbol("permessage-deflate"),Wn=Symbol("total-length"),Fa=Symbol("callback"),Ci=Symbol("buffers"),uu=Symbol("error"),lu,Xh=class{constructor(e,t,n){if(this._maxPayload=n|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!lu){let i=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;lu=new uD(i)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[Fa];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,n=e.find(i=>!(t.serverNoContextTakeover===!1&&i.server_no_context_takeover||i.server_max_window_bits&&(t.serverMaxWindowBits===!1||typeof t.serverMaxWindowBits=="number"&&t.serverMaxWindowBits>i.server_max_window_bits)||typeof t.clientMaxWindowBits=="number"&&!i.client_max_window_bits));if(!n)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(n.server_no_context_takeover=!0),t.clientNoContextTakeover&&(n.client_no_context_takeover=!0),typeof t.serverMaxWindowBits=="number"&&(n.server_max_window_bits=t.serverMaxWindowBits),typeof t.clientMaxWindowBits=="number"?n.client_max_window_bits=t.clientMaxWindowBits:(n.client_max_window_bits===!0||t.clientMaxWindowBits===!1)&&delete n.client_max_window_bits,n}acceptAsClient(e){let t=e[0];if(this._options.clientNoContextTakeover===!1&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!t.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(t.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return t}normalizeParams(e){return e.forEach(t=>{Object.keys(t).forEach(n=>{let i=t[n];if(i.length>1)throw new Error(`Parameter "${n}" must have only a single value`);if(i=i[0],n==="client_max_window_bits"){if(i!==!0){let s=+i;if(!Number.isInteger(s)||s<8||s>15)throw new TypeError(`Invalid value for parameter "${n}": ${i}`);i=s}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${n}": ${i}`)}else if(n==="server_max_window_bits"){let s=+i;if(!Number.isInteger(s)||s<8||s>15)throw new TypeError(`Invalid value for parameter "${n}": ${i}`);i=s}else if(n==="client_no_context_takeover"||n==="server_no_context_takeover"){if(i!==!0)throw new TypeError(`Invalid value for parameter "${n}": ${i}`)}else throw new Error(`Unknown parameter "${n}"`);t[n]=i})}),e}decompress(e,t,n){lu.add(i=>{this._decompress(e,t,(s,o)=>{i(),n(s,o)})})}compress(e,t,n){lu.add(i=>{this._compress(e,t,(s,o)=>{i(),n(s,o)})})}_decompress(e,t,n){let i=this._isServer?"client":"server";if(!this._inflate){let s=`${i}_max_window_bits`,o=typeof this.params[s]!="number"?La.Z_DEFAULT_WINDOWBITS:this.params[s];this._inflate=La.createInflateRaw({...this._options.zlibInflateOptions,windowBits:o}),this._inflate[fu]=this,this._inflate[Wn]=0,this._inflate[Ci]=[],this._inflate.on("error",pD),this._inflate.on("data",t_)}this._inflate[Fa]=n,this._inflate.write(e),t&&this._inflate.write(dD),this._inflate.flush(()=>{let s=this._inflate[uu];if(s){this._inflate.close(),this._inflate=null,n(s);return}let o=Zv.concat(this._inflate[Ci],this._inflate[Wn]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[Wn]=0,this._inflate[Ci]=[],t&&this.params[`${i}_no_context_takeover`]&&this._inflate.reset()),n(null,o)})}_compress(e,t,n){let i=this._isServer?"server":"client";if(!this._deflate){let s=`${i}_max_window_bits`,o=typeof this.params[s]!="number"?La.Z_DEFAULT_WINDOWBITS:this.params[s];this._deflate=La.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:o}),this._deflate[Wn]=0,this._deflate[Ci]=[],this._deflate.on("data",hD)}this._deflate[Fa]=n,this._deflate.write(e),this._deflate.flush(La.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let s=Zv.concat(this._deflate[Ci],this._deflate[Wn]);t&&(s=new fD(s.buffer,s.byteOffset,s.length-4)),this._deflate[Fa]=null,this._deflate[Wn]=0,this._deflate[Ci]=[],t&&this.params[`${i}_no_context_takeover`]&&this._deflate.reset(),n(null,s)})}};r_.exports=Xh;function hD(r){this[Ci].push(r),this[Wn]+=r.length}function t_(r){if(this[Wn]+=r.length,this[fu]._maxPayload<1||this[Wn]<=this[fu]._maxPayload){this[Ci].push(r);return}this[uu]=new RangeError("Max payload size exceeded"),this[uu].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[uu][e_]=1009,this.removeListener("data",t_),this.reset()}function pD(r){this[fu]._inflate=null,r[e_]=1007,this[Fa](r)}});var Ba=W((Z3,du)=>{"use strict";var{isUtf8:n_}=require("buffer"),mD=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function gD(r){return r>=1e3&&r<=1014&&r!==1004&&r!==1005&&r!==1006||r>=3e3&&r<=4999}function Zh(r){let e=r.length,t=0;for(;t<e;)if((r[t]&128)===0)t++;else if((r[t]&224)===192){if(t+1===e||(r[t+1]&192)!==128||(r[t]&254)===192)return!1;t+=2}else if((r[t]&240)===224){if(t+2>=e||(r[t+1]&192)!==128||(r[t+2]&192)!==128||r[t]===224&&(r[t+1]&224)===128||r[t]===237&&(r[t+1]&224)===160)return!1;t+=3}else if((r[t]&248)===240){if(t+3>=e||(r[t+1]&192)!==128||(r[t+2]&192)!==128||(r[t+3]&192)!==128||r[t]===240&&(r[t+1]&240)===128||r[t]===244&&r[t+1]>143||r[t]>244)return!1;t+=4}else return!1;return!0}du.exports={isValidStatusCode:gD,isValidUTF8:Zh,tokenChars:mD};if(n_)du.exports.isValidUTF8=function(r){return r.length<24?Zh(r):n_(r)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let r=require("utf-8-validate");du.exports.isValidUTF8=function(e){return e.length<32?Zh(e):r(e)}}catch{}});var ip=W((eM,u_)=>{"use strict";var{Writable:yD}=require("stream"),i_=Na(),{BINARY_TYPES:wD,EMPTY_BUFFER:s_,kStatusCode:bD,kWebSocket:vD}=Ei(),{concat:ep,toArrayBuffer:_D,unmask:SD}=Ua(),{isValidStatusCode:xD,isValidUTF8:o_}=Ba(),hu=Buffer[Symbol.species],Ir=0,a_=1,c_=2,l_=3,tp=4,rp=5,pu=6,np=class extends yD{constructor(e={}){super(),this._allowSynchronousEvents=e.allowSynchronousEvents!==void 0?e.allowSynchronousEvents:!0,this._binaryType=e.binaryType||wD[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[vD]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=Ir}_write(e,t,n){if(this._opcode===8&&this._state==Ir)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let n=this._buffers[0];return this._buffers[0]=new hu(n.buffer,n.byteOffset+e,n.length-e),new hu(n.buffer,n.byteOffset,e)}let t=Buffer.allocUnsafe(e);do{let n=this._buffers[0],i=t.length-e;e>=n.length?t.set(this._buffers.shift(),i):(t.set(new Uint8Array(n.buffer,n.byteOffset,e),i),this._buffers[0]=new hu(n.buffer,n.byteOffset+e,n.length-e)),e-=n.length}while(e>0);return t}startLoop(e){this._loop=!0;do switch(this._state){case Ir:this.getInfo(e);break;case a_:this.getPayloadLength16(e);break;case c_:this.getPayloadLength64(e);break;case l_:this.getMask();break;case tp:this.getData(e);break;case rp:case pu:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if((t[0]&48)!==0){let i=this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");e(i);return}let n=(t[0]&64)===64;if(n&&!this._extensions[i_.extensionName]){let i=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(i);return}if(this._fin=(t[0]&128)===128,this._opcode=t[0]&15,this._payloadLength=t[1]&127,this._opcode===0){if(n){let i=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(i);return}if(!this._fragmented){let i=this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");e(i);return}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){let i=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(i);return}this._compressed=n}else if(this._opcode>7&&this._opcode<11){if(!this._fin){let i=this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");e(i);return}if(n){let i=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(i);return}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){let i=this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");e(i);return}}else{let i=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(i);return}if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(t[1]&128)===128,this._isServer){if(!this._masked){let i=this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK");e(i);return}}else if(this._masked){let i=this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");e(i);return}this._payloadLength===126?this._state=a_:this._payloadLength===127?this._state=c_:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),n=t.readUInt32BE(0);if(n>Math.pow(2,21)-1){let i=this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH");e(i);return}this._payloadLength=n*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){let t=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");e(t);return}this._masked?this._state=l_:this._state=tp}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=tp}getData(e){let t=s_;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}t=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0&&SD(t,this._mask)}if(this._opcode>7){this.controlMessage(t,e);return}if(this._compressed){this._state=rp,this.decompress(t,e);return}t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}decompress(e,t){this._extensions[i_.extensionName].decompress(e,this._fin,(i,s)=>{if(i)return t(i);if(s.length){if(this._messageLength+=s.length,this._messageLength>this._maxPayload&&this._maxPayload>0){let o=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");t(o);return}this._fragments.push(s)}this.dataMessage(t),this._state===Ir&&this.startLoop(t)})}dataMessage(e){if(!this._fin){this._state=Ir;return}let t=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let i;this._binaryType==="nodebuffer"?i=ep(n,t):this._binaryType==="arraybuffer"?i=_D(ep(n,t)):i=n,this._allowSynchronousEvents?(this.emit("message",i,!0),this._state=Ir):(this._state=pu,setImmediate(()=>{this.emit("message",i,!0),this._state=Ir,this.startLoop(e)}))}else{let i=ep(n,t);if(!this._skipUTF8Validation&&!o_(i)){let s=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");e(s);return}this._state===rp||this._allowSynchronousEvents?(this.emit("message",i,!1),this._state=Ir):(this._state=pu,setImmediate(()=>{this.emit("message",i,!1),this._state=Ir,this.startLoop(e)}))}}controlMessage(e,t){if(this._opcode===8){if(e.length===0)this._loop=!1,this.emit("conclude",1005,s_),this.end();else{let n=e.readUInt16BE(0);if(!xD(n)){let s=this.createError(RangeError,`invalid status code ${n}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");t(s);return}let i=new hu(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!o_(i)){let s=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");t(s);return}this._loop=!1,this.emit("conclude",n,i),this.end()}this._state=Ir;return}this._allowSynchronousEvents?(this.emit(this._opcode===9?"ping":"pong",e),this._state=Ir):(this._state=pu,setImmediate(()=>{this.emit(this._opcode===9?"ping":"pong",e),this._state=Ir,this.startLoop(t)}))}createError(e,t,n,i,s){this._loop=!1,this._errored=!0;let o=new e(n?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(o,this.createError),o.code=s,o[bD]=i,o}};u_.exports=np});var op=W((rM,h_)=>{"use strict";var{Duplex:tM}=require("stream"),{randomFillSync:ED}=require("crypto"),f_=Na(),{EMPTY_BUFFER:CD}=Ei(),{isValidStatusCode:kD}=Ba(),{mask:d_,toBuffer:yo}=Ua(),Kr=Symbol("kByteLength"),TD=Buffer.alloc(4),mu=8*1024,ws,wo=mu,sp=class r{constructor(e,t,n){this._extensions=t||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let n,i=!1,s=2,o=!1;t.mask&&(n=t.maskBuffer||TD,t.generateMask?t.generateMask(n):(wo===mu&&(ws===void 0&&(ws=Buffer.alloc(mu)),ED(ws,0,mu),wo=0),n[0]=ws[wo++],n[1]=ws[wo++],n[2]=ws[wo++],n[3]=ws[wo++]),o=(n[0]|n[1]|n[2]|n[3])===0,s=6);let l;typeof e=="string"?(!t.mask||o)&&t[Kr]!==void 0?l=t[Kr]:(e=Buffer.from(e),l=e.length):(l=e.length,i=t.mask&&t.readOnly&&!o);let u=l;l>=65536?(s+=8,u=127):l>125&&(s+=2,u=126);let d=Buffer.allocUnsafe(i?l+s:s);return d[0]=t.fin?t.opcode|128:t.opcode,t.rsv1&&(d[0]|=64),d[1]=u,u===126?d.writeUInt16BE(l,2):u===127&&(d[2]=d[3]=0,d.writeUIntBE(l,4,6)),t.mask?(d[1]|=128,d[s-4]=n[0],d[s-3]=n[1],d[s-2]=n[2],d[s-1]=n[3],o?[d,e]:i?(d_(e,n,d,s,l),[d]):(d_(e,n,e,0,l),[d,e])):[d,e]}close(e,t,n,i){let s;if(e===void 0)s=CD;else{if(typeof e!="number"||!kD(e))throw new TypeError("First argument must be a valid error code number");if(t===void 0||!t.length)s=Buffer.allocUnsafe(2),s.writeUInt16BE(e,0);else{let l=Buffer.byteLength(t);if(l>123)throw new RangeError("The message must not be greater than 123 bytes");s=Buffer.allocUnsafe(2+l),s.writeUInt16BE(e,0),typeof t=="string"?s.write(t,2):s.set(t,2)}}let o={[Kr]:s.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,s,!1,o,i]):this.sendFrame(r.frame(s,o),i)}ping(e,t,n){let i,s;if(typeof e=="string"?(i=Buffer.byteLength(e),s=!1):(e=yo(e),i=e.length,s=yo.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[Kr]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:s,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(r.frame(e,o),n)}pong(e,t,n){let i,s;if(typeof e=="string"?(i=Buffer.byteLength(e),s=!1):(e=yo(e),i=e.length,s=yo.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[Kr]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:s,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(r.frame(e,o),n)}send(e,t,n){let i=this._extensions[f_.extensionName],s=t.binary?2:1,o=t.compress,l,u;if(typeof e=="string"?(l=Buffer.byteLength(e),u=!1):(e=yo(e),l=e.length,u=yo.readOnly),this._firstFragment?(this._firstFragment=!1,o&&i&&i.params[i._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(o=l>=i._threshold),this._compress=o):(o=!1,s=0),t.fin&&(this._firstFragment=!0),i){let d={[Kr]:l,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:s,readOnly:u,rsv1:o};this._deflating?this.enqueue([this.dispatch,e,this._compress,d,n]):this.dispatch(e,this._compress,d,n)}else this.sendFrame(r.frame(e,{[Kr]:l,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:s,readOnly:u,rsv1:!1}),n)}dispatch(e,t,n,i){if(!t){this.sendFrame(r.frame(e,n),i);return}let s=this._extensions[f_.extensionName];this._bufferedBytes+=n[Kr],this._deflating=!0,s.compress(e,n.fin,(o,l)=>{if(this._socket.destroyed){let u=new Error("The socket was closed while data was being compressed");typeof i=="function"&&i(u);for(let d=0;d<this._queue.length;d++){let f=this._queue[d],h=f[f.length-1];typeof h=="function"&&h(u)}return}this._bufferedBytes-=n[Kr],this._deflating=!1,n.readOnly=!1,this.sendFrame(r.frame(l,n),i),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][Kr],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][Kr],this._queue.push(e)}sendFrame(e,t){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}};h_.exports=sp});var S_=W((nM,__)=>{"use strict";var{kForOnEventAttribute:Ma,kListener:ap}=Ei(),p_=Symbol("kCode"),m_=Symbol("kData"),g_=Symbol("kError"),y_=Symbol("kMessage"),w_=Symbol("kReason"),bo=Symbol("kTarget"),b_=Symbol("kType"),v_=Symbol("kWasClean"),zn=class{constructor(e){this[bo]=null,this[b_]=e}get target(){return this[bo]}get type(){return this[b_]}};Object.defineProperty(zn.prototype,"target",{enumerable:!0});Object.defineProperty(zn.prototype,"type",{enumerable:!0});var bs=class extends zn{constructor(e,t={}){super(e),this[p_]=t.code===void 0?0:t.code,this[w_]=t.reason===void 0?"":t.reason,this[v_]=t.wasClean===void 0?!1:t.wasClean}get code(){return this[p_]}get reason(){return this[w_]}get wasClean(){return this[v_]}};Object.defineProperty(bs.prototype,"code",{enumerable:!0});Object.defineProperty(bs.prototype,"reason",{enumerable:!0});Object.defineProperty(bs.prototype,"wasClean",{enumerable:!0});var vo=class extends zn{constructor(e,t={}){super(e),this[g_]=t.error===void 0?null:t.error,this[y_]=t.message===void 0?"":t.message}get error(){return this[g_]}get message(){return this[y_]}};Object.defineProperty(vo.prototype,"error",{enumerable:!0});Object.defineProperty(vo.prototype,"message",{enumerable:!0});var qa=class extends zn{constructor(e,t={}){super(e),this[m_]=t.data===void 0?null:t.data}get data(){return this[m_]}};Object.defineProperty(qa.prototype,"data",{enumerable:!0});var RD={addEventListener(r,e,t={}){for(let i of this.listeners(r))if(!t[Ma]&&i[ap]===e&&!i[Ma])return;let n;if(r==="message")n=function(s,o){let l=new qa("message",{data:o?s:s.toString()});l[bo]=this,gu(e,this,l)};else if(r==="close")n=function(s,o){let l=new bs("close",{code:s,reason:o.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});l[bo]=this,gu(e,this,l)};else if(r==="error")n=function(s){let o=new vo("error",{error:s,message:s.message});o[bo]=this,gu(e,this,o)};else if(r==="open")n=function(){let s=new zn("open");s[bo]=this,gu(e,this,s)};else return;n[Ma]=!!t[Ma],n[ap]=e,t.once?this.once(r,n):this.on(r,n)},removeEventListener(r,e){for(let t of this.listeners(r))if(t[ap]===e&&!t[Ma]){this.removeListener(r,t);break}}};__.exports={CloseEvent:bs,ErrorEvent:vo,Event:zn,EventTarget:RD,MessageEvent:qa};function gu(r,e,t){typeof r=="object"&&r.handleEvent?r.handleEvent.call(r,t):r.call(e,t)}});var cp=W((iM,x_)=>{"use strict";var{tokenChars:ja}=Ba();function bn(r,e,t){r[e]===void 0?r[e]=[t]:r[e].push(t)}function AD(r){let e=Object.create(null),t=Object.create(null),n=!1,i=!1,s=!1,o,l,u=-1,d=-1,f=-1,h=0;for(;h<r.length;h++)if(d=r.charCodeAt(h),o===void 0)if(f===-1&&ja[d]===1)u===-1&&(u=h);else if(h!==0&&(d===32||d===9))f===-1&&u!==-1&&(f=h);else if(d===59||d===44){if(u===-1)throw new SyntaxError(`Unexpected character at index ${h}`);f===-1&&(f=h);let g=r.slice(u,f);d===44?(bn(e,g,t),t=Object.create(null)):o=g,u=f=-1}else throw new SyntaxError(`Unexpected character at index ${h}`);else if(l===void 0)if(f===-1&&ja[d]===1)u===-1&&(u=h);else if(d===32||d===9)f===-1&&u!==-1&&(f=h);else if(d===59||d===44){if(u===-1)throw new SyntaxError(`Unexpected character at index ${h}`);f===-1&&(f=h),bn(t,r.slice(u,f),!0),d===44&&(bn(e,o,t),t=Object.create(null),o=void 0),u=f=-1}else if(d===61&&u!==-1&&f===-1)l=r.slice(u,h),u=f=-1;else throw new SyntaxError(`Unexpected character at index ${h}`);else if(i){if(ja[d]!==1)throw new SyntaxError(`Unexpected character at index ${h}`);u===-1?u=h:n||(n=!0),i=!1}else if(s)if(ja[d]===1)u===-1&&(u=h);else if(d===34&&u!==-1)s=!1,f=h;else if(d===92)i=!0;else throw new SyntaxError(`Unexpected character at index ${h}`);else if(d===34&&r.charCodeAt(h-1)===61)s=!0;else if(f===-1&&ja[d]===1)u===-1&&(u=h);else if(u!==-1&&(d===32||d===9))f===-1&&(f=h);else if(d===59||d===44){if(u===-1)throw new SyntaxError(`Unexpected character at index ${h}`);f===-1&&(f=h);let g=r.slice(u,f);n&&(g=g.replace(/\\/g,""),n=!1),bn(t,l,g),d===44&&(bn(e,o,t),t=Object.create(null),o=void 0),l=void 0,u=f=-1}else throw new SyntaxError(`Unexpected character at index ${h}`);if(u===-1||s||d===32||d===9)throw new SyntaxError("Unexpected end of input");f===-1&&(f=h);let m=r.slice(u,f);return o===void 0?bn(e,m,t):(l===void 0?bn(t,m,!0):n?bn(t,l,m.replace(/\\/g,"")):bn(t,l,m),bn(e,o,t)),e}function ID(r){return Object.keys(r).map(e=>{let t=r[e];return Array.isArray(t)||(t=[t]),t.map(n=>[e].concat(Object.keys(n).map(i=>{let s=n[i];return Array.isArray(s)||(s=[s]),s.map(o=>o===!0?i:`${i}=${o}`).join("; ")})).join("; ")).join(", ")}).join(", ")}x_.exports={format:ID,parse:AD}});var hp=W((aM,U_)=>{"use strict";var OD=require("events"),DD=require("https"),PD=require("http"),k_=require("net"),UD=require("tls"),{randomBytes:LD,createHash:FD}=require("crypto"),{Duplex:sM,Readable:oM}=require("stream"),{URL:lp}=require("url"),ki=Na(),ND=ip(),BD=op(),{BINARY_TYPES:E_,EMPTY_BUFFER:yu,GUID:MD,kForOnEventAttribute:up,kListener:qD,kStatusCode:jD,kWebSocket:At,NOOP:T_}=Ei(),{EventTarget:{addEventListener:$D,removeEventListener:VD}}=S_(),{format:WD,parse:zD}=cp(),{toBuffer:HD}=Ua(),GD=30*1e3,R_=Symbol("kAborted"),fp=[8,13],Hn=["CONNECTING","OPEN","CLOSING","CLOSED"],YD=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,st=class r extends OD{constructor(e,t,n){super(),this._binaryType=E_[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=yu,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=r.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,t===void 0?t=[]:Array.isArray(t)||(typeof t=="object"&&t!==null?(n=t,t=[]):t=[t]),A_(this,e,t,n)):(this._autoPong=n.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){E_.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,n){let i=new ND({allowSynchronousEvents:n.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation});this._sender=new BD(e,this._extensions,n.generateMask),this._receiver=i,this._socket=e,i[At]=this,e[At]=this,i.on("conclude",QD),i.on("drain",XD),i.on("error",ZD),i.on("message",eP),i.on("ping",tP),i.on("pong",rP),e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",O_),e.on("data",bu),e.on("end",D_),e.on("error",P_),this._readyState=r.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=r.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[ki.extensionName]&&this._extensions[ki.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=r.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==r.CLOSED){if(this.readyState===r.CONNECTING){ur(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===r.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=r.CLOSING,this._sender.close(e,t,!this._isServer,n=>{n||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),GD)}}pause(){this.readyState===r.CONNECTING||this.readyState===r.CLOSED||(this._paused=!0,this._socket.pause())}ping(e,t,n){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=t=void 0):typeof t=="function"&&(n=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==r.OPEN){dp(this,e,n);return}t===void 0&&(t=!this._isServer),this._sender.ping(e||yu,t,n)}pong(e,t,n){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=t=void 0):typeof t=="function"&&(n=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==r.OPEN){dp(this,e,n);return}t===void 0&&(t=!this._isServer),this._sender.pong(e||yu,t,n)}resume(){this.readyState===r.CONNECTING||this.readyState===r.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,n){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"&&(n=t,t={}),typeof e=="number"&&(e=e.toString()),this.readyState!==r.OPEN){dp(this,e,n);return}let i={binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[ki.extensionName]||(i.compress=!1),this._sender.send(e||yu,i,n)}terminate(){if(this.readyState!==r.CLOSED){if(this.readyState===r.CONNECTING){ur(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=r.CLOSING,this._socket.destroy())}}};Object.defineProperty(st,"CONNECTING",{enumerable:!0,value:Hn.indexOf("CONNECTING")});Object.defineProperty(st.prototype,"CONNECTING",{enumerable:!0,value:Hn.indexOf("CONNECTING")});Object.defineProperty(st,"OPEN",{enumerable:!0,value:Hn.indexOf("OPEN")});Object.defineProperty(st.prototype,"OPEN",{enumerable:!0,value:Hn.indexOf("OPEN")});Object.defineProperty(st,"CLOSING",{enumerable:!0,value:Hn.indexOf("CLOSING")});Object.defineProperty(st.prototype,"CLOSING",{enumerable:!0,value:Hn.indexOf("CLOSING")});Object.defineProperty(st,"CLOSED",{enumerable:!0,value:Hn.indexOf("CLOSED")});Object.defineProperty(st.prototype,"CLOSED",{enumerable:!0,value:Hn.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(r=>{Object.defineProperty(st.prototype,r,{enumerable:!0})});["open","error","close","message"].forEach(r=>{Object.defineProperty(st.prototype,`on${r}`,{enumerable:!0,get(){for(let e of this.listeners(r))if(e[up])return e[qD];return null},set(e){for(let t of this.listeners(r))if(t[up]){this.removeListener(r,t);break}typeof e=="function"&&this.addEventListener(r,e,{[up]:!0})}})});st.prototype.addEventListener=$D;st.prototype.removeEventListener=VD;U_.exports=st;function A_(r,e,t,n){let i={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:fp[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...n,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(r._autoPong=i.autoPong,!fp.includes(i.protocolVersion))throw new RangeError(`Unsupported protocol version: ${i.protocolVersion} (supported versions: ${fp.join(", ")})`);let s;if(e instanceof lp)s=e;else try{s=new lp(e)}catch{throw new SyntaxError(`Invalid URL: ${e}`)}s.protocol==="http:"?s.protocol="ws:":s.protocol==="https:"&&(s.protocol="wss:"),r._url=s.href;let o=s.protocol==="wss:",l=s.protocol==="ws+unix:",u;if(s.protocol!=="ws:"&&!o&&!l?u=`The URL's protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"`:l&&!s.pathname?u="The URL's pathname is empty":s.hash&&(u="The URL contains a fragment identifier"),u){let b=new SyntaxError(u);if(r._redirects===0)throw b;wu(r,b);return}let d=o?443:80,f=LD(16).toString("base64"),h=o?DD.request:PD.request,m=new Set,g;if(i.createConnection=i.createConnection||(o?JD:KD),i.defaultPort=i.defaultPort||d,i.port=s.port||d,i.host=s.hostname.startsWith("[")?s.hostname.slice(1,-1):s.hostname,i.headers={...i.headers,"Sec-WebSocket-Version":i.protocolVersion,"Sec-WebSocket-Key":f,Connection:"Upgrade",Upgrade:"websocket"},i.path=s.pathname+s.search,i.timeout=i.handshakeTimeout,i.perMessageDeflate&&(g=new ki(i.perMessageDeflate!==!0?i.perMessageDeflate:{},!1,i.maxPayload),i.headers["Sec-WebSocket-Extensions"]=WD({[ki.extensionName]:g.offer()})),t.length){for(let b of t){if(typeof b!="string"||!YD.test(b)||m.has(b))throw new SyntaxError("An invalid or duplicated subprotocol was specified");m.add(b)}i.headers["Sec-WebSocket-Protocol"]=t.join(",")}if(i.origin&&(i.protocolVersion<13?i.headers["Sec-WebSocket-Origin"]=i.origin:i.headers.Origin=i.origin),(s.username||s.password)&&(i.auth=`${s.username}:${s.password}`),l){let b=i.path.split(":");i.socketPath=b[0],i.path=b[1]}let y;if(i.followRedirects){if(r._redirects===0){r._originalIpc=l,r._originalSecure=o,r._originalHostOrSocketPath=l?i.socketPath:s.host;let b=n&&n.headers;if(n={...n,headers:{}},b)for(let[C,L]of Object.entries(b))n.headers[C.toLowerCase()]=L}else if(r.listenerCount("redirect")===0){let b=l?r._originalIpc?i.socketPath===r._originalHostOrSocketPath:!1:r._originalIpc?!1:s.host===r._originalHostOrSocketPath;(!b||r._originalSecure&&!o)&&(delete i.headers.authorization,delete i.headers.cookie,b||delete i.headers.host,i.auth=void 0)}i.auth&&!n.headers.authorization&&(n.headers.authorization="Basic "+Buffer.from(i.auth).toString("base64")),y=r._req=h(i),r._redirects&&r.emit("redirect",r.url,y)}else y=r._req=h(i);i.timeout&&y.on("timeout",()=>{ur(r,y,"Opening handshake has timed out")}),y.on("error",b=>{y===null||y[R_]||(y=r._req=null,wu(r,b))}),y.on("response",b=>{let C=b.headers.location,L=b.statusCode;if(C&&i.followRedirects&&L>=300&&L<400){if(++r._redirects>i.maxRedirects){ur(r,y,"Maximum redirects exceeded");return}y.abort();let j;try{j=new lp(C,e)}catch{let D=new SyntaxError(`Invalid URL: ${C}`);wu(r,D);return}A_(r,j,t,n)}else r.emit("unexpected-response",y,b)||ur(r,y,`Unexpected server response: ${b.statusCode}`)}),y.on("upgrade",(b,C,L)=>{if(r.emit("upgrade",b),r.readyState!==st.CONNECTING)return;y=r._req=null;let j=b.headers.upgrade;if(j===void 0||j.toLowerCase()!=="websocket"){ur(r,C,"Invalid Upgrade header");return}let O=FD("sha1").update(f+MD).digest("base64");if(b.headers["sec-websocket-accept"]!==O){ur(r,C,"Invalid Sec-WebSocket-Accept header");return}let D=b.headers["sec-websocket-protocol"],N;if(D!==void 0?m.size?m.has(D)||(N="Server sent an invalid subprotocol"):N="Server sent a subprotocol but none was requested":m.size&&(N="Server sent no subprotocol"),N){ur(r,C,N);return}D&&(r._protocol=D);let k=b.headers["sec-websocket-extensions"];if(k!==void 0){if(!g){ur(r,C,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let P;try{P=zD(k)}catch{ur(r,C,"Invalid Sec-WebSocket-Extensions header");return}let R=Object.keys(P);if(R.length!==1||R[0]!==ki.extensionName){ur(r,C,"Server indicated an extension that was not requested");return}try{g.accept(P[ki.extensionName])}catch{ur(r,C,"Invalid Sec-WebSocket-Extensions header");return}r._extensions[ki.extensionName]=g}r.setSocket(C,L,{allowSynchronousEvents:i.allowSynchronousEvents,generateMask:i.generateMask,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation})}),i.finishRequest?i.finishRequest(y,r):y.end()}function wu(r,e){r._readyState=st.CLOSING,r.emit("error",e),r.emitClose()}function KD(r){return r.path=r.socketPath,k_.connect(r)}function JD(r){return r.path=void 0,!r.servername&&r.servername!==""&&(r.servername=k_.isIP(r.host)?"":r.host),UD.connect(r)}function ur(r,e,t){r._readyState=st.CLOSING;let n=new Error(t);Error.captureStackTrace(n,ur),e.setHeader?(e[R_]=!0,e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),process.nextTick(wu,r,n)):(e.destroy(n),e.once("error",r.emit.bind(r,"error")),e.once("close",r.emitClose.bind(r)))}function dp(r,e,t){if(e){let n=HD(e).length;r._socket?r._sender._bufferedBytes+=n:r._bufferedAmount+=n}if(t){let n=new Error(`WebSocket is not open: readyState ${r.readyState} (${Hn[r.readyState]})`);process.nextTick(t,n)}}function QD(r,e){let t=this[At];t._closeFrameReceived=!0,t._closeMessage=e,t._closeCode=r,t._socket[At]!==void 0&&(t._socket.removeListener("data",bu),process.nextTick(I_,t._socket),r===1005?t.close():t.close(r,e))}function XD(){let r=this[At];r.isPaused||r._socket.resume()}function ZD(r){let e=this[At];e._socket[At]!==void 0&&(e._socket.removeListener("data",bu),process.nextTick(I_,e._socket),e.close(r[jD])),e.emit("error",r)}function C_(){this[At].emitClose()}function eP(r,e){this[At].emit("message",r,e)}function tP(r){let e=this[At];e._autoPong&&e.pong(r,!this._isServer,T_),e.emit("ping",r)}function rP(r){this[At].emit("pong",r)}function I_(r){r.resume()}function O_(){let r=this[At];this.removeListener("close",O_),this.removeListener("data",bu),this.removeListener("end",D_),r._readyState=st.CLOSING;let e;!this._readableState.endEmitted&&!r._closeFrameReceived&&!r._receiver._writableState.errorEmitted&&(e=r._socket.read())!==null&&r._receiver.write(e),r._receiver.end(),this[At]=void 0,clearTimeout(r._closeTimer),r._receiver._writableState.finished||r._receiver._writableState.errorEmitted?r.emitClose():(r._receiver.on("error",C_),r._receiver.on("finish",C_))}function bu(r){this[At]._receiver.write(r)||this.pause()}function D_(){let r=this[At];r._readyState=st.CLOSING,r._receiver.end(),this.end()}function P_(){let r=this[At];this.removeListener("error",P_),this.on("error",T_),r&&(r._readyState=st.CLOSING,this.destroy())}});var F_=W((cM,L_)=>{"use strict";var{tokenChars:nP}=Ba();function iP(r){let e=new Set,t=-1,n=-1,i=0;for(i;i<r.length;i++){let o=r.charCodeAt(i);if(n===-1&&nP[o]===1)t===-1&&(t=i);else if(i!==0&&(o===32||o===9))n===-1&&t!==-1&&(n=i);else if(o===44){if(t===-1)throw new SyntaxError(`Unexpected character at index ${i}`);n===-1&&(n=i);let l=r.slice(t,n);if(e.has(l))throw new SyntaxError(`The "${l}" subprotocol is duplicated`);e.add(l),t=n=-1}else throw new SyntaxError(`Unexpected character at index ${i}`)}if(t===-1||n!==-1)throw new SyntaxError("Unexpected end of input");let s=r.slice(t,i);if(e.has(s))throw new SyntaxError(`The "${s}" subprotocol is duplicated`);return e.add(s),e}L_.exports={parse:iP}});var V_=W((uM,$_)=>{"use strict";var sP=require("events"),vu=require("http"),{Duplex:lM}=require("stream"),{createHash:oP}=require("crypto"),N_=cp(),vs=Na(),aP=F_(),cP=hp(),{GUID:lP,kWebSocket:uP}=Ei(),fP=/^[+/0-9A-Za-z]{22}==$/,B_=0,M_=1,j_=2,pp=class extends sP{constructor(e,t){if(super(),e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:cP,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=vu.createServer((n,i)=>{let s=vu.STATUS_CODES[426];i.writeHead(426,{"Content-Length":s.length,"Content-Type":"text/plain"}),i.end(s)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let n=this.emit.bind(this,"connection");this._removeListeners=dP(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(i,s,o)=>{this.handleUpgrade(i,s,o,n)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=B_}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===j_){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick($a,this);return}if(e&&this.once("close",e),this._state!==M_)if(this._state=M_,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick($a,this):process.nextTick($a,this);else{let t=this._server;this._removeListeners(),this._removeListeners=this._server=null,t.close(()=>{$a(this)})}}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((t!==-1?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,n,i){t.on("error",q_);let s=e.headers["sec-websocket-key"],o=e.headers.upgrade,l=+e.headers["sec-websocket-version"];if(e.method!=="GET"){_s(this,e,t,405,"Invalid HTTP method");return}if(o===void 0||o.toLowerCase()!=="websocket"){_s(this,e,t,400,"Invalid Upgrade header");return}if(s===void 0||!fP.test(s)){_s(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");return}if(l!==8&&l!==13){_s(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(e)){Va(t,400);return}let u=e.headers["sec-websocket-protocol"],d=new Set;if(u!==void 0)try{d=aP.parse(u)}catch{_s(this,e,t,400,"Invalid Sec-WebSocket-Protocol header");return}let f=e.headers["sec-websocket-extensions"],h={};if(this.options.perMessageDeflate&&f!==void 0){let m=new vs(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let g=N_.parse(f);g[vs.extensionName]&&(m.accept(g[vs.extensionName]),h[vs.extensionName]=m)}catch{_s(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let m={origin:e.headers[`${l===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(m,(g,y,b,C)=>{if(!g)return Va(t,y||401,b,C);this.completeUpgrade(h,s,d,e,t,n,i)});return}if(!this.options.verifyClient(m))return Va(t,401)}this.completeUpgrade(h,s,d,e,t,n,i)}completeUpgrade(e,t,n,i,s,o,l){if(!s.readable||!s.writable)return s.destroy();if(s[uP])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>B_)return Va(s,503);let d=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${oP("sha1").update(t+lP).digest("base64")}`],f=new this.options.WebSocket(null,void 0,this.options);if(n.size){let h=this.options.handleProtocols?this.options.handleProtocols(n,i):n.values().next().value;h&&(d.push(`Sec-WebSocket-Protocol: ${h}`),f._protocol=h)}if(e[vs.extensionName]){let h=e[vs.extensionName].params,m=N_.format({[vs.extensionName]:[h]});d.push(`Sec-WebSocket-Extensions: ${m}`),f._extensions=e}this.emit("headers",d,i),s.write(d.concat(`\r
`).join(`\r
`)),s.removeListener("error",q_),f.setSocket(s,o,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(f),f.on("close",()=>{this.clients.delete(f),this._shouldEmitClose&&!this.clients.size&&process.nextTick($a,this)})),l(f,i)}};$_.exports=pp;function dP(r,e){for(let t of Object.keys(e))r.on(t,e[t]);return function(){for(let n of Object.keys(e))r.removeListener(n,e[n])}}function $a(r){r._state=j_,r.emit("close")}function q_(){this.destroy()}function Va(r,e,t,n){t=t||vu.STATUS_CODES[e],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(t),...n},r.once("finish",r.destroy),r.end(`HTTP/1.1 ${e} ${vu.STATUS_CODES[e]}\r
`+Object.keys(n).map(i=>`${i}: ${n[i]}`).join(`\r
`)+`\r
\r
`+t)}function _s(r,e,t,n,i){if(r.listenerCount("wsClientError")){let s=new Error(i);Error.captureStackTrace(s,_s),r.emit("wsClientError",s,t,e)}else Va(t,n,i)}});var wp=W((XM,Y_)=>{function TP(r){t.debug=t,t.default=t,t.coerce=u,t.disable=s,t.enable=i,t.enabled=o,t.humanize=eu(),t.destroy=d,Object.keys(r).forEach(f=>{t[f]=r[f]}),t.names=[],t.skips=[],t.formatters={};function e(f){let h=0;for(let m=0;m<f.length;m++)h=(h<<5)-h+f.charCodeAt(m),h|=0;return t.colors[Math.abs(h)%t.colors.length]}t.selectColor=e;function t(f){let h,m=null,g,y;function b(...C){if(!b.enabled)return;let L=b,j=Number(new Date),O=j-(h||j);L.diff=O,L.prev=h,L.curr=j,h=j,C[0]=t.coerce(C[0]),typeof C[0]!="string"&&C.unshift("%O");let D=0;C[0]=C[0].replace(/%([a-zA-Z%])/g,(k,P)=>{if(k==="%%")return"%";D++;let R=t.formatters[P];if(typeof R=="function"){let M=C[D];k=R.call(L,M),C.splice(D,1),D--}return k}),t.formatArgs.call(L,C),(L.log||t.log).apply(L,C)}return b.namespace=f,b.useColors=t.useColors(),b.color=t.selectColor(f),b.extend=n,b.destroy=t.destroy,Object.defineProperty(b,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(g!==t.namespaces&&(g=t.namespaces,y=t.enabled(f)),y),set:C=>{m=C}}),typeof t.init=="function"&&t.init(b),b}function n(f,h){let m=t(this.namespace+(typeof h>"u"?":":h)+f);return m.log=this.log,m}function i(f){t.save(f),t.namespaces=f,t.names=[],t.skips=[];let h,m=(typeof f=="string"?f:"").split(/[\s,]+/),g=m.length;for(h=0;h<g;h++)m[h]&&(f=m[h].replace(/\*/g,".*?"),f[0]==="-"?t.skips.push(new RegExp("^"+f.slice(1)+"$")):t.names.push(new RegExp("^"+f+"$")))}function s(){let f=[...t.names.map(l),...t.skips.map(l).map(h=>"-"+h)].join(",");return t.enable(""),f}function o(f){if(f[f.length-1]==="*")return!0;let h,m;for(h=0,m=t.skips.length;h<m;h++)if(t.skips[h].test(f))return!1;for(h=0,m=t.names.length;h<m;h++)if(t.names[h].test(f))return!0;return!1}function l(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function u(f){return f instanceof Error?f.stack||f.message:f}function d(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}Y_.exports=TP});var K_=W((fr,xu)=>{fr.formatArgs=AP;fr.save=IP;fr.load=OP;fr.useColors=RP;fr.storage=DP();fr.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();fr.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function RP(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let r;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(r=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(r[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function AP(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+xu.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(t++,i==="%c"&&(n=t))}),r.splice(n,0,e)}fr.log=console.debug||console.log||(()=>{});function IP(r){try{r?fr.storage.setItem("debug",r):fr.storage.removeItem("debug")}catch{}}function OP(){let r;try{r=fr.storage.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function DP(){try{return localStorage}catch{}}xu.exports=wp()(fr);var{formatters:PP}=xu.exports;PP.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Q_=W((bt,Cu)=>{var UP=require("tty"),Eu=require("util");bt.init=jP;bt.log=BP;bt.formatArgs=FP;bt.save=MP;bt.load=qP;bt.useColors=LP;bt.destroy=Eu.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");bt.colors=[6,2,3,4,5,1];try{let r=nu();r&&(r.stderr||r).level>=2&&(bt.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}bt.inspectOpts=Object.keys(process.env).filter(r=>/^debug_/i.test(r)).reduce((r,e)=>{let t=e.substring(6).toLowerCase().replace(/_([a-z])/g,(i,s)=>s.toUpperCase()),n=process.env[e];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),r[t]=n,r},{});function LP(){return"colors"in bt.inspectOpts?!!bt.inspectOpts.colors:UP.isatty(process.stderr.fd)}function FP(r){let{namespace:e,useColors:t}=this;if(t){let n=this.color,i="\x1B[3"+(n<8?n:"8;5;"+n),s=`  ${i};1m${e} \x1B[0m`;r[0]=s+r[0].split(`
`).join(`
`+s),r.push(i+"m+"+Cu.exports.humanize(this.diff)+"\x1B[0m")}else r[0]=NP()+e+" "+r[0]}function NP(){return bt.inspectOpts.hideDate?"":new Date().toISOString()+" "}function BP(...r){return process.stderr.write(Eu.formatWithOptions(bt.inspectOpts,...r)+`
`)}function MP(r){r?process.env.DEBUG=r:delete process.env.DEBUG}function qP(){return process.env.DEBUG}function jP(r){r.inspectOpts={};let e=Object.keys(bt.inspectOpts);for(let t=0;t<e.length;t++)r.inspectOpts[e[t]]=bt.inspectOpts[e[t]]}Cu.exports=wp()(bt);var{formatters:J_}=Cu.exports;J_.o=function(r){return this.inspectOpts.colors=this.useColors,Eu.inspect(r,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};J_.O=function(r){return this.inspectOpts.colors=this.useColors,Eu.inspect(r,this.inspectOpts)}});var Ha=W((ZM,bp)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?bp.exports=K_():bp.exports=Q_()});var Sp=W((s8,iS)=>{function HP(r){t.debug=t,t.default=t,t.coerce=u,t.disable=s,t.enable=i,t.enabled=o,t.humanize=eu(),t.destroy=d,Object.keys(r).forEach(f=>{t[f]=r[f]}),t.names=[],t.skips=[],t.formatters={};function e(f){let h=0;for(let m=0;m<f.length;m++)h=(h<<5)-h+f.charCodeAt(m),h|=0;return t.colors[Math.abs(h)%t.colors.length]}t.selectColor=e;function t(f){let h,m=null,g,y;function b(...C){if(!b.enabled)return;let L=b,j=Number(new Date),O=j-(h||j);L.diff=O,L.prev=h,L.curr=j,h=j,C[0]=t.coerce(C[0]),typeof C[0]!="string"&&C.unshift("%O");let D=0;C[0]=C[0].replace(/%([a-zA-Z%])/g,(k,P)=>{if(k==="%%")return"%";D++;let R=t.formatters[P];if(typeof R=="function"){let M=C[D];k=R.call(L,M),C.splice(D,1),D--}return k}),t.formatArgs.call(L,C),(L.log||t.log).apply(L,C)}return b.namespace=f,b.useColors=t.useColors(),b.color=t.selectColor(f),b.extend=n,b.destroy=t.destroy,Object.defineProperty(b,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(g!==t.namespaces&&(g=t.namespaces,y=t.enabled(f)),y),set:C=>{m=C}}),typeof t.init=="function"&&t.init(b),b}function n(f,h){let m=t(this.namespace+(typeof h>"u"?":":h)+f);return m.log=this.log,m}function i(f){t.save(f),t.namespaces=f,t.names=[],t.skips=[];let h,m=(typeof f=="string"?f:"").split(/[\s,]+/),g=m.length;for(h=0;h<g;h++)m[h]&&(f=m[h].replace(/\*/g,".*?"),f[0]==="-"?t.skips.push(new RegExp("^"+f.slice(1)+"$")):t.names.push(new RegExp("^"+f+"$")))}function s(){let f=[...t.names.map(l),...t.skips.map(l).map(h=>"-"+h)].join(",");return t.enable(""),f}function o(f){if(f[f.length-1]==="*")return!0;let h,m;for(h=0,m=t.skips.length;h<m;h++)if(t.skips[h].test(f))return!1;for(h=0,m=t.names.length;h<m;h++)if(t.names[h].test(f))return!0;return!1}function l(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function u(f){return f instanceof Error?f.stack||f.message:f}function d(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}iS.exports=HP});var sS=W((dr,ku)=>{dr.formatArgs=YP;dr.save=KP;dr.load=JP;dr.useColors=GP;dr.storage=QP();dr.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();dr.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function GP(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let r;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(r=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(r[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function YP(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+ku.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(t++,i==="%c"&&(n=t))}),r.splice(n,0,e)}dr.log=console.debug||console.log||(()=>{});function KP(r){try{r?dr.storage.setItem("debug",r):dr.storage.removeItem("debug")}catch{}}function JP(){let r;try{r=dr.storage.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function QP(){try{return localStorage}catch{}}ku.exports=Sp()(dr);var{formatters:XP}=ku.exports;XP.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var aS=W((vt,Ru)=>{var ZP=require("tty"),Tu=require("util");vt.init=oU;vt.log=nU;vt.formatArgs=tU;vt.save=iU;vt.load=sU;vt.useColors=eU;vt.destroy=Tu.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");vt.colors=[6,2,3,4,5,1];try{let r=nu();r&&(r.stderr||r).level>=2&&(vt.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}vt.inspectOpts=Object.keys(process.env).filter(r=>/^debug_/i.test(r)).reduce((r,e)=>{let t=e.substring(6).toLowerCase().replace(/_([a-z])/g,(i,s)=>s.toUpperCase()),n=process.env[e];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),r[t]=n,r},{});function eU(){return"colors"in vt.inspectOpts?!!vt.inspectOpts.colors:ZP.isatty(process.stderr.fd)}function tU(r){let{namespace:e,useColors:t}=this;if(t){let n=this.color,i="\x1B[3"+(n<8?n:"8;5;"+n),s=`  ${i};1m${e} \x1B[0m`;r[0]=s+r[0].split(`
`).join(`
`+s),r.push(i+"m+"+Ru.exports.humanize(this.diff)+"\x1B[0m")}else r[0]=rU()+e+" "+r[0]}function rU(){return vt.inspectOpts.hideDate?"":new Date().toISOString()+" "}function nU(...r){return process.stderr.write(Tu.formatWithOptions(vt.inspectOpts,...r)+`
`)}function iU(r){r?process.env.DEBUG=r:delete process.env.DEBUG}function sU(){return process.env.DEBUG}function oU(r){r.inspectOpts={};let e=Object.keys(vt.inspectOpts);for(let t=0;t<e.length;t++)r.inspectOpts[e[t]]=vt.inspectOpts[e[t]]}Ru.exports=Sp()(vt);var{formatters:oS}=Ru.exports;oS.o=function(r){return this.inspectOpts.colors=this.useColors,Tu.inspect(r,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};oS.O=function(r){return this.inspectOpts.colors=this.useColors,Tu.inspect(r,this.inspectOpts)}});var cS=W((o8,xp)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?xp.exports=sS():xp.exports=aS()});var Tf=W((Yq,dE)=>{function mF(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}dE.exports=mF});var pE=W((Kq,hE)=>{var gF=typeof global=="object"&&global&&global.Object===Object&&global;hE.exports=gF});var Lm=W((Jq,mE)=>{var yF=pE(),wF=typeof self=="object"&&self&&self.Object===Object&&self,bF=yF||wF||Function("return this")();mE.exports=bF});var yE=W((Qq,gE)=>{var vF=Lm(),_F=function(){return vF.Date.now()};gE.exports=_F});var bE=W((Xq,wE)=>{var SF=/\s/;function xF(r){for(var e=r.length;e--&&SF.test(r.charAt(e)););return e}wE.exports=xF});var _E=W((Zq,vE)=>{var EF=bE(),CF=/^\s+/;function kF(r){return r&&r.slice(0,EF(r)+1).replace(CF,"")}vE.exports=kF});var Fm=W((ej,SE)=>{var TF=Lm(),RF=TF.Symbol;SE.exports=RF});var kE=W((tj,CE)=>{var xE=Fm(),EE=Object.prototype,AF=EE.hasOwnProperty,IF=EE.toString,kc=xE?xE.toStringTag:void 0;function OF(r){var e=AF.call(r,kc),t=r[kc];try{r[kc]=void 0;var n=!0}catch{}var i=IF.call(r);return n&&(e?r[kc]=t:delete r[kc]),i}CE.exports=OF});var RE=W((rj,TE)=>{var DF=Object.prototype,PF=DF.toString;function UF(r){return PF.call(r)}TE.exports=UF});var DE=W((nj,OE)=>{var AE=Fm(),LF=kE(),FF=RE(),NF="[object Null]",BF="[object Undefined]",IE=AE?AE.toStringTag:void 0;function MF(r){return r==null?r===void 0?BF:NF:IE&&IE in Object(r)?LF(r):FF(r)}OE.exports=MF});var UE=W((ij,PE)=>{function qF(r){return r!=null&&typeof r=="object"}PE.exports=qF});var FE=W((sj,LE)=>{var jF=DE(),$F=UE(),VF="[object Symbol]";function WF(r){return typeof r=="symbol"||$F(r)&&jF(r)==VF}LE.exports=WF});var qE=W((oj,ME)=>{var zF=_E(),NE=Tf(),HF=FE(),BE=NaN,GF=/^[-+]0x[0-9a-f]+$/i,YF=/^0b[01]+$/i,KF=/^0o[0-7]+$/i,JF=parseInt;function QF(r){if(typeof r=="number")return r;if(HF(r))return BE;if(NE(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=NE(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=zF(r);var t=YF.test(r);return t||KF.test(r)?JF(r.slice(2),t?2:8):GF.test(r)?BE:+r}ME.exports=QF});var Bm=W((aj,$E)=>{var XF=Tf(),Nm=yE(),jE=qE(),ZF="Expected a function",eN=Math.max,tN=Math.min;function rN(r,e,t){var n,i,s,o,l,u,d=0,f=!1,h=!1,m=!0;if(typeof r!="function")throw new TypeError(ZF);e=jE(e)||0,XF(t)&&(f=!!t.leading,h="maxWait"in t,s=h?eN(jE(t.maxWait)||0,e):s,m="trailing"in t?!!t.trailing:m);function g(k){var P=n,R=i;return n=i=void 0,d=k,o=r.apply(R,P),o}function y(k){return d=k,l=setTimeout(L,e),f?g(k):o}function b(k){var P=k-u,R=k-d,M=e-P;return h?tN(M,s-R):M}function C(k){var P=k-u,R=k-d;return u===void 0||P>=e||P<0||h&&R>=s}function L(){var k=Nm();if(C(k))return j(k);l=setTimeout(L,b(k))}function j(k){return l=void 0,m&&n?g(k):(n=i=void 0,o)}function O(){l!==void 0&&clearTimeout(l),d=0,n=u=i=l=void 0}function D(){return l===void 0?o:j(Nm())}function N(){var k=Nm(),P=C(k);if(n=arguments,i=this,u=k,P){if(l===void 0)return y(u);if(h)return clearTimeout(l),l=setTimeout(L,e),g(u)}return l===void 0&&(l=setTimeout(L,e)),o}return N.cancel=O,N.flush=D,N}$E.exports=rN});var WE=W((cj,VE)=>{var nN=Bm(),iN=Tf(),sN="Expected a function";function oN(r,e,t){var n=!0,i=!0;if(typeof r!="function")throw new TypeError(sN);return iN(t)&&(n="leading"in t?!!t.leading:n,i="trailing"in t?!!t.trailing:i),nN(r,e,{leading:n,maxWait:e,trailing:i})}VE.exports=oN});var qC=W((Vf,MC)=>{(function(r,e){typeof Vf=="object"&&typeof MC<"u"?e(Vf):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis<"u"?globalThis:r||self,e(r.WebStreamsPolyfill={}))})(Vf,function(r){"use strict";function e(){}function t(a){return typeof a=="object"&&a!==null||typeof a=="function"}let n=e;function i(a,c){try{Object.defineProperty(a,"name",{value:c,configurable:!0})}catch{}}let s=Promise,o=Promise.prototype.then,l=Promise.reject.bind(s);function u(a){return new s(a)}function d(a){return u(c=>c(a))}function f(a){return l(a)}function h(a,c,p){return o.call(a,c,p)}function m(a,c,p){h(h(a,c,p),void 0,n)}function g(a,c){m(a,c)}function y(a,c){m(a,void 0,c)}function b(a,c,p){return h(a,c,p)}function C(a){h(a,void 0,n)}let L=a=>{if(typeof queueMicrotask=="function")L=queueMicrotask;else{let c=d(void 0);L=p=>h(c,p)}return L(a)};function j(a,c,p){if(typeof a!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(a,c,p)}function O(a,c,p){try{return d(j(a,c,p))}catch(w){return f(w)}}let D=16384;class N{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(c){let p=this._back,w=p;p._elements.length===D-1&&(w={_elements:[],_next:void 0}),p._elements.push(c),w!==p&&(this._back=w,p._next=w),++this._size}shift(){let c=this._front,p=c,w=this._cursor,v=w+1,I=c._elements,U=I[w];return v===D&&(p=c._next,v=0),--this._size,this._cursor=v,c!==p&&(this._front=p),I[w]=void 0,U}forEach(c){let p=this._cursor,w=this._front,v=w._elements;for(;(p!==v.length||w._next!==void 0)&&!(p===v.length&&(w=w._next,v=w._elements,p=0,v.length===0));)c(v[p]),++p}peek(){let c=this._front,p=this._cursor;return c._elements[p]}}let k=Symbol("[[AbortSteps]]"),P=Symbol("[[ErrorSteps]]"),R=Symbol("[[CancelSteps]]"),M=Symbol("[[PullSteps]]"),Q=Symbol("[[ReleaseSteps]]");function te(a,c){a._ownerReadableStream=c,c._reader=a,c._state==="readable"?$(a):c._state==="closed"?F(a):q(a,c._storedError)}function he(a,c){let p=a._ownerReadableStream;return Mr(p,c)}function pe(a){let c=a._ownerReadableStream;c._state==="readable"?V(a,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):X(a,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),c._readableStreamController[Q](),c._reader=void 0,a._ownerReadableStream=void 0}function S(a){return new TypeError("Cannot "+a+" a stream using a released reader")}function $(a){a._closedPromise=u((c,p)=>{a._closedPromise_resolve=c,a._closedPromise_reject=p})}function q(a,c){$(a),V(a,c)}function F(a){$(a),me(a)}function V(a,c){a._closedPromise_reject!==void 0&&(C(a._closedPromise),a._closedPromise_reject(c),a._closedPromise_resolve=void 0,a._closedPromise_reject=void 0)}function X(a,c){q(a,c)}function me(a){a._closedPromise_resolve!==void 0&&(a._closedPromise_resolve(void 0),a._closedPromise_resolve=void 0,a._closedPromise_reject=void 0)}let oe=Number.isFinite||function(a){return typeof a=="number"&&isFinite(a)},z=Math.trunc||function(a){return a<0?Math.ceil(a):Math.floor(a)};function ce(a){return typeof a=="object"||typeof a=="function"}function ue(a,c){if(a!==void 0&&!ce(a))throw new TypeError(`${c} is not an object.`)}function J(a,c){if(typeof a!="function")throw new TypeError(`${c} is not a function.`)}function Ue(a){return typeof a=="object"&&a!==null||typeof a=="function"}function kt(a,c){if(!Ue(a))throw new TypeError(`${c} is not an object.`)}function nt(a,c,p){if(a===void 0)throw new TypeError(`Parameter ${c} is required in '${p}'.`)}function an(a,c,p){if(a===void 0)throw new TypeError(`${c} is required in '${p}'.`)}function lt(a){return Number(a)}function Fr(a){return a===0?0:a}function $t(a){return Fr(z(a))}function tr(a,c){let w=Number.MAX_SAFE_INTEGER,v=Number(a);if(v=Fr(v),!oe(v))throw new TypeError(`${c} is not a finite number`);if(v=$t(v),v<0||v>w)throw new TypeError(`${c} is outside the accepted range of 0 to ${w}, inclusive`);return!oe(v)||v===0?0:v}function An(a,c){if(!di(a))throw new TypeError(`${c} is not a ReadableStream.`)}function cn(a){return new Nr(a)}function ra(a,c){a._reader._readRequests.push(c)}function js(a,c,p){let v=a._reader._readRequests.shift();p?v._closeSteps():v._chunkSteps(c)}function zi(a){return a._reader._readRequests.length}function na(a){let c=a._reader;return!(c===void 0||!vr(c))}class Nr{constructor(c){if(nt(c,1,"ReadableStreamDefaultReader"),An(c,"First parameter"),hi(c))throw new TypeError("This stream has already been locked for exclusive reading by another reader");te(this,c),this._readRequests=new N}get closed(){return vr(this)?this._closedPromise:f($s("closed"))}cancel(c=void 0){return vr(this)?this._ownerReadableStream===void 0?f(S("cancel")):he(this,c):f($s("cancel"))}read(){if(!vr(this))return f($s("read"));if(this._ownerReadableStream===void 0)return f(S("read from"));let c,p,w=u((I,U)=>{c=I,p=U});return Hi(this,{_chunkSteps:I=>c({value:I,done:!1}),_closeSteps:()=>c({value:void 0,done:!0}),_errorSteps:I=>p(I)}),w}releaseLock(){if(!vr(this))throw $s("releaseLock");this._ownerReadableStream!==void 0&&ed(this)}}Object.defineProperties(Nr.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),i(Nr.prototype.cancel,"cancel"),i(Nr.prototype.read,"read"),i(Nr.prototype.releaseLock,"releaseLock"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Nr.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function vr(a){return!t(a)||!Object.prototype.hasOwnProperty.call(a,"_readRequests")?!1:a instanceof Nr}function Hi(a,c){let p=a._ownerReadableStream;p._disturbed=!0,p._state==="closed"?c._closeSteps():p._state==="errored"?c._errorSteps(p._storedError):p._readableStreamController[M](c)}function ed(a){pe(a);let c=new TypeError("Reader was released");jc(a,c)}function jc(a,c){let p=a._readRequests;a._readRequests=new N,p.forEach(w=>{w._errorSteps(c)})}function $s(a){return new TypeError(`ReadableStreamDefaultReader.prototype.${a} can only be used on a ReadableStreamDefaultReader`)}let Gi=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class $c{constructor(c,p){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=c,this._preventCancel=p}next(){let c=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?b(this._ongoingPromise,c,c):c(),this._ongoingPromise}return(c){let p=()=>this._returnSteps(c);return this._ongoingPromise?b(this._ongoingPromise,p,p):p()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let c=this._reader,p,w,v=u((U,Z)=>{p=U,w=Z});return Hi(c,{_chunkSteps:U=>{this._ongoingPromise=void 0,L(()=>p({value:U,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,pe(c),p({value:void 0,done:!0})},_errorSteps:U=>{this._ongoingPromise=void 0,this._isFinished=!0,pe(c),w(U)}}),v}_returnSteps(c){if(this._isFinished)return Promise.resolve({value:c,done:!0});this._isFinished=!0;let p=this._reader;if(!this._preventCancel){let w=he(p,c);return pe(p),b(w,()=>({value:c,done:!0}))}return pe(p),d({value:c,done:!0})}}let Vc={next(){return Vs(this)?this._asyncIteratorImpl.next():f(E("next"))},return(a){return Vs(this)?this._asyncIteratorImpl.return(a):f(E("return"))}};Object.setPrototypeOf(Vc,Gi);function td(a,c){let p=cn(a),w=new $c(p,c),v=Object.create(Vc);return v._asyncIteratorImpl=w,v}function Vs(a){if(!t(a)||!Object.prototype.hasOwnProperty.call(a,"_asyncIteratorImpl"))return!1;try{return a._asyncIteratorImpl instanceof $c}catch{return!1}}function E(a){return new TypeError(`ReadableStreamAsyncIterator.${a} can only be used on a ReadableSteamAsyncIterator`)}let A=Number.isNaN||function(a){return a!==a};var B,H,ae;function Ne(a){return a.slice()}function et(a,c,p,w,v){new Uint8Array(a).set(new Uint8Array(p,w,v),c)}let ge=a=>(typeof a.transfer=="function"?ge=c=>c.transfer():typeof structuredClone=="function"?ge=c=>structuredClone(c,{transfer:[c]}):ge=c=>c,ge(a)),Y=a=>(typeof a.detached=="boolean"?Y=c=>c.detached:Y=c=>c.byteLength===0,Y(a));function ee(a,c,p){if(a.slice)return a.slice(c,p);let w=p-c,v=new ArrayBuffer(w);return et(v,0,a,c,w),v}function re(a,c){let p=a[c];if(p!=null){if(typeof p!="function")throw new TypeError(`${String(c)} is not a function`);return p}}function se(a){let c={[Symbol.iterator]:()=>a.iterator},p=async function*(){return yield*c}(),w=p.next;return{iterator:p,nextMethod:w,done:!1}}let Ce=(ae=(B=Symbol.asyncIterator)!==null&&B!==void 0?B:(H=Symbol.for)===null||H===void 0?void 0:H.call(Symbol,"Symbol.asyncIterator"))!==null&&ae!==void 0?ae:"@@asyncIterator";function Le(a,c="sync",p){if(p===void 0)if(c==="async"){if(p=re(a,Ce),p===void 0){let I=re(a,Symbol.iterator),U=Le(a,"sync",I);return se(U)}}else p=re(a,Symbol.iterator);if(p===void 0)throw new TypeError("The object is not iterable");let w=j(p,a,[]);if(!t(w))throw new TypeError("The iterator method must return an object");let v=w.next;return{iterator:w,nextMethod:v,done:!1}}function Xe(a){let c=j(a.nextMethod,a.iterator,[]);if(!t(c))throw new TypeError("The iterator.next() method must return an object");return c}function rr(a){return!!a.done}function Wc(a){return a.value}function rd(a){return!(typeof a!="number"||A(a)||a<0)}function zc(a){let c=ee(a.buffer,a.byteOffset,a.byteOffset+a.byteLength);return new Uint8Array(c)}function nd(a){let c=a._queue.shift();return a._queueTotalSize-=c.size,a._queueTotalSize<0&&(a._queueTotalSize=0),c.value}function id(a,c,p){if(!rd(p)||p===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");a._queue.push({value:c,size:p}),a._queueTotalSize+=p}function wk(a){return a._queue.peek().value}function li(a){a._queue=new N,a._queueTotalSize=0}function Rg(a){return a===DataView}function bk(a){return Rg(a.constructor)}function vk(a){return Rg(a)?1:a.BYTES_PER_ELEMENT}class Yi{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!sd(this))throw ud("view");return this._view}respond(c){if(!sd(this))throw ud("respond");if(nt(c,1,"respond"),c=tr(c,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(Y(this._view.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be used as a response");Kc(this._associatedReadableByteStreamController,c)}respondWithNewView(c){if(!sd(this))throw ud("respondWithNewView");if(nt(c,1,"respondWithNewView"),!ArrayBuffer.isView(c))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(Y(c.buffer))throw new TypeError("The given view's buffer has been detached and so cannot be used as a response");Jc(this._associatedReadableByteStreamController,c)}}Object.defineProperties(Yi.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),i(Yi.prototype.respond,"respond"),i(Yi.prototype.respondWithNewView,"respondWithNewView"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Yi.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class In{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Ki(this))throw sa("byobRequest");return ld(this)}get desiredSize(){if(!Ki(this))throw sa("desiredSize");return Bg(this)}close(){if(!Ki(this))throw sa("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let c=this._controlledReadableByteStream._state;if(c!=="readable")throw new TypeError(`The stream (in ${c} state) is not in the readable state and cannot be closed`);ia(this)}enqueue(c){if(!Ki(this))throw sa("enqueue");if(nt(c,1,"enqueue"),!ArrayBuffer.isView(c))throw new TypeError("chunk must be an array buffer view");if(c.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(c.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let p=this._controlledReadableByteStream._state;if(p!=="readable")throw new TypeError(`The stream (in ${p} state) is not in the readable state and cannot be enqueued to`);Yc(this,c)}error(c=void 0){if(!Ki(this))throw sa("error");_r(this,c)}[R](c){Ag(this),li(this);let p=this._cancelAlgorithm(c);return Gc(this),p}[M](c){let p=this._controlledReadableByteStream;if(this._queueTotalSize>0){Ng(this,c);return}let w=this._autoAllocateChunkSize;if(w!==void 0){let v;try{v=new ArrayBuffer(w)}catch(U){c._errorSteps(U);return}let I={buffer:v,bufferByteLength:w,byteOffset:0,byteLength:w,bytesFilled:0,minimumFill:1,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(I)}ra(p,c),Ji(this)}[Q](){if(this._pendingPullIntos.length>0){let c=this._pendingPullIntos.peek();c.readerType="none",this._pendingPullIntos=new N,this._pendingPullIntos.push(c)}}}Object.defineProperties(In.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),i(In.prototype.close,"close"),i(In.prototype.enqueue,"enqueue"),i(In.prototype.error,"error"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(In.prototype,Symbol.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function Ki(a){return!t(a)||!Object.prototype.hasOwnProperty.call(a,"_controlledReadableByteStream")?!1:a instanceof In}function sd(a){return!t(a)||!Object.prototype.hasOwnProperty.call(a,"_associatedReadableByteStreamController")?!1:a instanceof Yi}function Ji(a){if(!Ck(a))return;if(a._pulling){a._pullAgain=!0;return}a._pulling=!0;let p=a._pullAlgorithm();m(p,()=>(a._pulling=!1,a._pullAgain&&(a._pullAgain=!1,Ji(a)),null),w=>(_r(a,w),null))}function Ag(a){ad(a),a._pendingPullIntos=new N}function od(a,c){let p=!1;a._state==="closed"&&(p=!0);let w=Ig(c);c.readerType==="default"?js(a,w,p):Ok(a,w,p)}function Ig(a){let c=a.bytesFilled,p=a.elementSize;return new a.viewConstructor(a.buffer,a.byteOffset,c/p)}function Hc(a,c,p,w){a._queue.push({buffer:c,byteOffset:p,byteLength:w}),a._queueTotalSize+=w}function Og(a,c,p,w){let v;try{v=ee(c,p,p+w)}catch(I){throw _r(a,I),I}Hc(a,v,0,w)}function Dg(a,c){c.bytesFilled>0&&Og(a,c.buffer,c.byteOffset,c.bytesFilled),Ws(a)}function Pg(a,c){let p=Math.min(a._queueTotalSize,c.byteLength-c.bytesFilled),w=c.bytesFilled+p,v=p,I=!1,U=w%c.elementSize,Z=w-U;Z>=c.minimumFill&&(v=Z-c.bytesFilled,I=!0);let ye=a._queue;for(;v>0;){let le=ye.peek(),Se=Math.min(v,le.byteLength),Te=c.byteOffset+c.bytesFilled;et(c.buffer,Te,le.buffer,le.byteOffset,Se),le.byteLength===Se?ye.shift():(le.byteOffset+=Se,le.byteLength-=Se),a._queueTotalSize-=Se,Ug(a,Se,c),v-=Se}return I}function Ug(a,c,p){p.bytesFilled+=c}function Lg(a){a._queueTotalSize===0&&a._closeRequested?(Gc(a),fa(a._controlledReadableByteStream)):Ji(a)}function ad(a){a._byobRequest!==null&&(a._byobRequest._associatedReadableByteStreamController=void 0,a._byobRequest._view=null,a._byobRequest=null)}function cd(a){for(;a._pendingPullIntos.length>0;){if(a._queueTotalSize===0)return;let c=a._pendingPullIntos.peek();Pg(a,c)&&(Ws(a),od(a._controlledReadableByteStream,c))}}function _k(a){let c=a._controlledReadableByteStream._reader;for(;c._readRequests.length>0;){if(a._queueTotalSize===0)return;let p=c._readRequests.shift();Ng(a,p)}}function Sk(a,c,p,w){let v=a._controlledReadableByteStream,I=c.constructor,U=vk(I),{byteOffset:Z,byteLength:ye}=c,le=p*U,Se;try{Se=ge(c.buffer)}catch(Be){w._errorSteps(Be);return}let Te={buffer:Se,bufferByteLength:Se.byteLength,byteOffset:Z,byteLength:ye,bytesFilled:0,minimumFill:le,elementSize:U,viewConstructor:I,readerType:"byob"};if(a._pendingPullIntos.length>0){a._pendingPullIntos.push(Te),jg(v,w);return}if(v._state==="closed"){let Be=new I(Te.buffer,Te.byteOffset,0);w._closeSteps(Be);return}if(a._queueTotalSize>0){if(Pg(a,Te)){let Be=Ig(Te);Lg(a),w._chunkSteps(Be);return}if(a._closeRequested){let Be=new TypeError("Insufficient bytes to fill elements in the given buffer");_r(a,Be),w._errorSteps(Be);return}}a._pendingPullIntos.push(Te),jg(v,w),Ji(a)}function xk(a,c){c.readerType==="none"&&Ws(a);let p=a._controlledReadableByteStream;if(fd(p))for(;$g(p)>0;){let w=Ws(a);od(p,w)}}function Ek(a,c,p){if(Ug(a,c,p),p.readerType==="none"){Dg(a,p),cd(a);return}if(p.bytesFilled<p.minimumFill)return;Ws(a);let w=p.bytesFilled%p.elementSize;if(w>0){let v=p.byteOffset+p.bytesFilled;Og(a,p.buffer,v-w,w)}p.bytesFilled-=w,od(a._controlledReadableByteStream,p),cd(a)}function Fg(a,c){let p=a._pendingPullIntos.peek();ad(a),a._controlledReadableByteStream._state==="closed"?xk(a,p):Ek(a,c,p),Ji(a)}function Ws(a){return a._pendingPullIntos.shift()}function Ck(a){let c=a._controlledReadableByteStream;return c._state!=="readable"||a._closeRequested||!a._started?!1:!!(na(c)&&zi(c)>0||fd(c)&&$g(c)>0||Bg(a)>0)}function Gc(a){a._pullAlgorithm=void 0,a._cancelAlgorithm=void 0}function ia(a){let c=a._controlledReadableByteStream;if(!(a._closeRequested||c._state!=="readable")){if(a._queueTotalSize>0){a._closeRequested=!0;return}if(a._pendingPullIntos.length>0){let p=a._pendingPullIntos.peek();if(p.bytesFilled%p.elementSize!==0){let w=new TypeError("Insufficient bytes to fill elements in the given buffer");throw _r(a,w),w}}Gc(a),fa(c)}}function Yc(a,c){let p=a._controlledReadableByteStream;if(a._closeRequested||p._state!=="readable")return;let{buffer:w,byteOffset:v,byteLength:I}=c;if(Y(w))throw new TypeError("chunk's buffer is detached and so cannot be enqueued");let U=ge(w);if(a._pendingPullIntos.length>0){let Z=a._pendingPullIntos.peek();if(Y(Z.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be filled with an enqueued chunk");ad(a),Z.buffer=ge(Z.buffer),Z.readerType==="none"&&Dg(a,Z)}if(na(p))if(_k(a),zi(p)===0)Hc(a,U,v,I);else{a._pendingPullIntos.length>0&&Ws(a);let Z=new Uint8Array(U,v,I);js(p,Z,!1)}else fd(p)?(Hc(a,U,v,I),cd(a)):Hc(a,U,v,I);Ji(a)}function _r(a,c){let p=a._controlledReadableByteStream;p._state==="readable"&&(Ag(a),li(a),Gc(a),dy(p,c))}function Ng(a,c){let p=a._queue.shift();a._queueTotalSize-=p.byteLength,Lg(a);let w=new Uint8Array(p.buffer,p.byteOffset,p.byteLength);c._chunkSteps(w)}function ld(a){if(a._byobRequest===null&&a._pendingPullIntos.length>0){let c=a._pendingPullIntos.peek(),p=new Uint8Array(c.buffer,c.byteOffset+c.bytesFilled,c.byteLength-c.bytesFilled),w=Object.create(Yi.prototype);Tk(w,a,p),a._byobRequest=w}return a._byobRequest}function Bg(a){let c=a._controlledReadableByteStream._state;return c==="errored"?null:c==="closed"?0:a._strategyHWM-a._queueTotalSize}function Kc(a,c){let p=a._pendingPullIntos.peek();if(a._controlledReadableByteStream._state==="closed"){if(c!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(c===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(p.bytesFilled+c>p.byteLength)throw new RangeError("bytesWritten out of range")}p.buffer=ge(p.buffer),Fg(a,c)}function Jc(a,c){let p=a._pendingPullIntos.peek();if(a._controlledReadableByteStream._state==="closed"){if(c.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(c.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(p.byteOffset+p.bytesFilled!==c.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(p.bufferByteLength!==c.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(p.bytesFilled+c.byteLength>p.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let v=c.byteLength;p.buffer=ge(c.buffer),Fg(a,v)}function Mg(a,c,p,w,v,I,U){c._controlledReadableByteStream=a,c._pullAgain=!1,c._pulling=!1,c._byobRequest=null,c._queue=c._queueTotalSize=void 0,li(c),c._closeRequested=!1,c._started=!1,c._strategyHWM=I,c._pullAlgorithm=w,c._cancelAlgorithm=v,c._autoAllocateChunkSize=U,c._pendingPullIntos=new N,a._readableStreamController=c;let Z=p();m(d(Z),()=>(c._started=!0,Ji(c),null),ye=>(_r(c,ye),null))}function kk(a,c,p){let w=Object.create(In.prototype),v,I,U;c.start!==void 0?v=()=>c.start(w):v=()=>{},c.pull!==void 0?I=()=>c.pull(w):I=()=>d(void 0),c.cancel!==void 0?U=ye=>c.cancel(ye):U=()=>d(void 0);let Z=c.autoAllocateChunkSize;if(Z===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");Mg(a,w,v,I,U,p,Z)}function Tk(a,c,p){a._associatedReadableByteStreamController=c,a._view=p}function ud(a){return new TypeError(`ReadableStreamBYOBRequest.prototype.${a} can only be used on a ReadableStreamBYOBRequest`)}function sa(a){return new TypeError(`ReadableByteStreamController.prototype.${a} can only be used on a ReadableByteStreamController`)}function Rk(a,c){ue(a,c);let p=a?.mode;return{mode:p===void 0?void 0:Ak(p,`${c} has member 'mode' that`)}}function Ak(a,c){if(a=`${a}`,a!=="byob")throw new TypeError(`${c} '${a}' is not a valid enumeration value for ReadableStreamReaderMode`);return a}function Ik(a,c){var p;ue(a,c);let w=(p=a?.min)!==null&&p!==void 0?p:1;return{min:tr(w,`${c} has member 'min' that`)}}function qg(a){return new ui(a)}function jg(a,c){a._reader._readIntoRequests.push(c)}function Ok(a,c,p){let v=a._reader._readIntoRequests.shift();p?v._closeSteps(c):v._chunkSteps(c)}function $g(a){return a._reader._readIntoRequests.length}function fd(a){let c=a._reader;return!(c===void 0||!Qi(c))}class ui{constructor(c){if(nt(c,1,"ReadableStreamBYOBReader"),An(c,"First parameter"),hi(c))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Ki(c._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");te(this,c),this._readIntoRequests=new N}get closed(){return Qi(this)?this._closedPromise:f(Qc("closed"))}cancel(c=void 0){return Qi(this)?this._ownerReadableStream===void 0?f(S("cancel")):he(this,c):f(Qc("cancel"))}read(c,p={}){if(!Qi(this))return f(Qc("read"));if(!ArrayBuffer.isView(c))return f(new TypeError("view must be an array buffer view"));if(c.byteLength===0)return f(new TypeError("view must have non-zero byteLength"));if(c.buffer.byteLength===0)return f(new TypeError("view's buffer must have non-zero byteLength"));if(Y(c.buffer))return f(new TypeError("view's buffer has been detached"));let w;try{w=Ik(p,"options")}catch(le){return f(le)}let v=w.min;if(v===0)return f(new TypeError("options.min must be greater than 0"));if(bk(c)){if(v>c.byteLength)return f(new RangeError("options.min must be less than or equal to view's byteLength"))}else if(v>c.length)return f(new RangeError("options.min must be less than or equal to view's length"));if(this._ownerReadableStream===void 0)return f(S("read from"));let I,U,Z=u((le,Se)=>{I=le,U=Se});return Vg(this,c,v,{_chunkSteps:le=>I({value:le,done:!1}),_closeSteps:le=>I({value:le,done:!0}),_errorSteps:le=>U(le)}),Z}releaseLock(){if(!Qi(this))throw Qc("releaseLock");this._ownerReadableStream!==void 0&&Dk(this)}}Object.defineProperties(ui.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),i(ui.prototype.cancel,"cancel"),i(ui.prototype.read,"read"),i(ui.prototype.releaseLock,"releaseLock"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ui.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function Qi(a){return!t(a)||!Object.prototype.hasOwnProperty.call(a,"_readIntoRequests")?!1:a instanceof ui}function Vg(a,c,p,w){let v=a._ownerReadableStream;v._disturbed=!0,v._state==="errored"?w._errorSteps(v._storedError):Sk(v._readableStreamController,c,p,w)}function Dk(a){pe(a);let c=new TypeError("Reader was released");Wg(a,c)}function Wg(a,c){let p=a._readIntoRequests;a._readIntoRequests=new N,p.forEach(w=>{w._errorSteps(c)})}function Qc(a){return new TypeError(`ReadableStreamBYOBReader.prototype.${a} can only be used on a ReadableStreamBYOBReader`)}function oa(a,c){let{highWaterMark:p}=a;if(p===void 0)return c;if(A(p)||p<0)throw new RangeError("Invalid highWaterMark");return p}function Xc(a){let{size:c}=a;return c||(()=>1)}function Zc(a,c){ue(a,c);let p=a?.highWaterMark,w=a?.size;return{highWaterMark:p===void 0?void 0:lt(p),size:w===void 0?void 0:Pk(w,`${c} has member 'size' that`)}}function Pk(a,c){return J(a,c),p=>lt(a(p))}function Uk(a,c){ue(a,c);let p=a?.abort,w=a?.close,v=a?.start,I=a?.type,U=a?.write;return{abort:p===void 0?void 0:Lk(p,a,`${c} has member 'abort' that`),close:w===void 0?void 0:Fk(w,a,`${c} has member 'close' that`),start:v===void 0?void 0:Nk(v,a,`${c} has member 'start' that`),write:U===void 0?void 0:Bk(U,a,`${c} has member 'write' that`),type:I}}function Lk(a,c,p){return J(a,p),w=>O(a,c,[w])}function Fk(a,c,p){return J(a,p),()=>O(a,c,[])}function Nk(a,c,p){return J(a,p),w=>j(a,c,[w])}function Bk(a,c,p){return J(a,p),(w,v)=>O(a,c,[w,v])}function zg(a,c){if(!zs(a))throw new TypeError(`${c} is not a WritableStream.`)}function Mk(a){if(typeof a!="object"||a===null)return!1;try{return typeof a.aborted=="boolean"}catch{return!1}}let qk=typeof AbortController=="function";function jk(){if(qk)return new AbortController}class fi{constructor(c={},p={}){c===void 0?c=null:kt(c,"First parameter");let w=Zc(p,"Second parameter"),v=Uk(c,"First parameter");if(Gg(this),v.type!==void 0)throw new RangeError("Invalid type is specified");let U=Xc(w),Z=oa(w,1);tT(this,v,Z,U)}get locked(){if(!zs(this))throw il("locked");return Hs(this)}abort(c=void 0){return zs(this)?Hs(this)?f(new TypeError("Cannot abort a stream that already has a writer")):el(this,c):f(il("abort"))}close(){return zs(this)?Hs(this)?f(new TypeError("Cannot close a stream that already has a writer")):ln(this)?f(new TypeError("Cannot close an already-closing stream")):Yg(this):f(il("close"))}getWriter(){if(!zs(this))throw il("getWriter");return Hg(this)}}Object.defineProperties(fi.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),i(fi.prototype.abort,"abort"),i(fi.prototype.close,"close"),i(fi.prototype.getWriter,"getWriter"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(fi.prototype,Symbol.toStringTag,{value:"WritableStream",configurable:!0});function Hg(a){return new On(a)}function $k(a,c,p,w,v=1,I=()=>1){let U=Object.create(fi.prototype);Gg(U);let Z=Object.create(Gs.prototype);return ey(U,Z,a,c,p,w,v,I),U}function Gg(a){a._state="writable",a._storedError=void 0,a._writer=void 0,a._writableStreamController=void 0,a._writeRequests=new N,a._inFlightWriteRequest=void 0,a._closeRequest=void 0,a._inFlightCloseRequest=void 0,a._pendingAbortRequest=void 0,a._backpressure=!1}function zs(a){return!t(a)||!Object.prototype.hasOwnProperty.call(a,"_writableStreamController")?!1:a instanceof fi}function Hs(a){return a._writer!==void 0}function el(a,c){var p;if(a._state==="closed"||a._state==="errored")return d(void 0);a._writableStreamController._abortReason=c,(p=a._writableStreamController._abortController)===null||p===void 0||p.abort(c);let w=a._state;if(w==="closed"||w==="errored")return d(void 0);if(a._pendingAbortRequest!==void 0)return a._pendingAbortRequest._promise;let v=!1;w==="erroring"&&(v=!0,c=void 0);let I=u((U,Z)=>{a._pendingAbortRequest={_promise:void 0,_resolve:U,_reject:Z,_reason:c,_wasAlreadyErroring:v}});return a._pendingAbortRequest._promise=I,v||hd(a,c),I}function Yg(a){let c=a._state;if(c==="closed"||c==="errored")return f(new TypeError(`The stream (in ${c} state) is not in the writable state and cannot be closed`));let p=u((v,I)=>{let U={_resolve:v,_reject:I};a._closeRequest=U}),w=a._writer;return w!==void 0&&a._backpressure&&c==="writable"&&_d(w),rT(a._writableStreamController),p}function Vk(a){return u((p,w)=>{let v={_resolve:p,_reject:w};a._writeRequests.push(v)})}function dd(a,c){if(a._state==="writable"){hd(a,c);return}pd(a)}function hd(a,c){let p=a._writableStreamController;a._state="erroring",a._storedError=c;let w=a._writer;w!==void 0&&Jg(w,c),!Yk(a)&&p._started&&pd(a)}function pd(a){a._state="errored",a._writableStreamController[P]();let c=a._storedError;if(a._writeRequests.forEach(v=>{v._reject(c)}),a._writeRequests=new N,a._pendingAbortRequest===void 0){tl(a);return}let p=a._pendingAbortRequest;if(a._pendingAbortRequest=void 0,p._wasAlreadyErroring){p._reject(c),tl(a);return}let w=a._writableStreamController[k](p._reason);m(w,()=>(p._resolve(),tl(a),null),v=>(p._reject(v),tl(a),null))}function Wk(a){a._inFlightWriteRequest._resolve(void 0),a._inFlightWriteRequest=void 0}function zk(a,c){a._inFlightWriteRequest._reject(c),a._inFlightWriteRequest=void 0,dd(a,c)}function Hk(a){a._inFlightCloseRequest._resolve(void 0),a._inFlightCloseRequest=void 0,a._state==="erroring"&&(a._storedError=void 0,a._pendingAbortRequest!==void 0&&(a._pendingAbortRequest._resolve(),a._pendingAbortRequest=void 0)),a._state="closed";let p=a._writer;p!==void 0&&iy(p)}function Gk(a,c){a._inFlightCloseRequest._reject(c),a._inFlightCloseRequest=void 0,a._pendingAbortRequest!==void 0&&(a._pendingAbortRequest._reject(c),a._pendingAbortRequest=void 0),dd(a,c)}function ln(a){return!(a._closeRequest===void 0&&a._inFlightCloseRequest===void 0)}function Yk(a){return!(a._inFlightWriteRequest===void 0&&a._inFlightCloseRequest===void 0)}function Kk(a){a._inFlightCloseRequest=a._closeRequest,a._closeRequest=void 0}function Jk(a){a._inFlightWriteRequest=a._writeRequests.shift()}function tl(a){a._closeRequest!==void 0&&(a._closeRequest._reject(a._storedError),a._closeRequest=void 0);let c=a._writer;c!==void 0&&bd(c,a._storedError)}function md(a,c){let p=a._writer;p!==void 0&&c!==a._backpressure&&(c?lT(p):_d(p)),a._backpressure=c}class On{constructor(c){if(nt(c,1,"WritableStreamDefaultWriter"),zg(c,"First parameter"),Hs(c))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=c,c._writer=this;let p=c._state;if(p==="writable")!ln(c)&&c._backpressure?ol(this):sy(this),sl(this);else if(p==="erroring")vd(this,c._storedError),sl(this);else if(p==="closed")sy(this),aT(this);else{let w=c._storedError;vd(this,w),ny(this,w)}}get closed(){return Xi(this)?this._closedPromise:f(Zi("closed"))}get desiredSize(){if(!Xi(this))throw Zi("desiredSize");if(this._ownerWritableStream===void 0)throw ca("desiredSize");return eT(this)}get ready(){return Xi(this)?this._readyPromise:f(Zi("ready"))}abort(c=void 0){return Xi(this)?this._ownerWritableStream===void 0?f(ca("abort")):Qk(this,c):f(Zi("abort"))}close(){if(!Xi(this))return f(Zi("close"));let c=this._ownerWritableStream;return c===void 0?f(ca("close")):ln(c)?f(new TypeError("Cannot close an already-closing stream")):Kg(this)}releaseLock(){if(!Xi(this))throw Zi("releaseLock");this._ownerWritableStream!==void 0&&Qg(this)}write(c=void 0){return Xi(this)?this._ownerWritableStream===void 0?f(ca("write to")):Xg(this,c):f(Zi("write"))}}Object.defineProperties(On.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),i(On.prototype.abort,"abort"),i(On.prototype.close,"close"),i(On.prototype.releaseLock,"releaseLock"),i(On.prototype.write,"write"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(On.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function Xi(a){return!t(a)||!Object.prototype.hasOwnProperty.call(a,"_ownerWritableStream")?!1:a instanceof On}function Qk(a,c){let p=a._ownerWritableStream;return el(p,c)}function Kg(a){let c=a._ownerWritableStream;return Yg(c)}function Xk(a){let c=a._ownerWritableStream,p=c._state;return ln(c)||p==="closed"?d(void 0):p==="errored"?f(c._storedError):Kg(a)}function Zk(a,c){a._closedPromiseState==="pending"?bd(a,c):cT(a,c)}function Jg(a,c){a._readyPromiseState==="pending"?oy(a,c):uT(a,c)}function eT(a){let c=a._ownerWritableStream,p=c._state;return p==="errored"||p==="erroring"?null:p==="closed"?0:ty(c._writableStreamController)}function Qg(a){let c=a._ownerWritableStream,p=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Jg(a,p),Zk(a,p),c._writer=void 0,a._ownerWritableStream=void 0}function Xg(a,c){let p=a._ownerWritableStream,w=p._writableStreamController,v=nT(w,c);if(p!==a._ownerWritableStream)return f(ca("write to"));let I=p._state;if(I==="errored")return f(p._storedError);if(ln(p)||I==="closed")return f(new TypeError("The stream is closing or closed and cannot be written to"));if(I==="erroring")return f(p._storedError);let U=Vk(p);return iT(w,c,v),U}let Zg={};class Gs{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!gd(this))throw wd("abortReason");return this._abortReason}get signal(){if(!gd(this))throw wd("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(c=void 0){if(!gd(this))throw wd("error");this._controlledWritableStream._state==="writable"&&ry(this,c)}[k](c){let p=this._abortAlgorithm(c);return rl(this),p}[P](){li(this)}}Object.defineProperties(Gs.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Gs.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function gd(a){return!t(a)||!Object.prototype.hasOwnProperty.call(a,"_controlledWritableStream")?!1:a instanceof Gs}function ey(a,c,p,w,v,I,U,Z){c._controlledWritableStream=a,a._writableStreamController=c,c._queue=void 0,c._queueTotalSize=void 0,li(c),c._abortReason=void 0,c._abortController=jk(),c._started=!1,c._strategySizeAlgorithm=Z,c._strategyHWM=U,c._writeAlgorithm=w,c._closeAlgorithm=v,c._abortAlgorithm=I;let ye=yd(c);md(a,ye);let le=p(),Se=d(le);m(Se,()=>(c._started=!0,nl(c),null),Te=>(c._started=!0,dd(a,Te),null))}function tT(a,c,p,w){let v=Object.create(Gs.prototype),I,U,Z,ye;c.start!==void 0?I=()=>c.start(v):I=()=>{},c.write!==void 0?U=le=>c.write(le,v):U=()=>d(void 0),c.close!==void 0?Z=()=>c.close():Z=()=>d(void 0),c.abort!==void 0?ye=le=>c.abort(le):ye=()=>d(void 0),ey(a,v,I,U,Z,ye,p,w)}function rl(a){a._writeAlgorithm=void 0,a._closeAlgorithm=void 0,a._abortAlgorithm=void 0,a._strategySizeAlgorithm=void 0}function rT(a){id(a,Zg,0),nl(a)}function nT(a,c){try{return a._strategySizeAlgorithm(c)}catch(p){return aa(a,p),1}}function ty(a){return a._strategyHWM-a._queueTotalSize}function iT(a,c,p){try{id(a,c,p)}catch(v){aa(a,v);return}let w=a._controlledWritableStream;if(!ln(w)&&w._state==="writable"){let v=yd(a);md(w,v)}nl(a)}function nl(a){let c=a._controlledWritableStream;if(!a._started||c._inFlightWriteRequest!==void 0)return;if(c._state==="erroring"){pd(c);return}if(a._queue.length===0)return;let w=wk(a);w===Zg?sT(a):oT(a,w)}function aa(a,c){a._controlledWritableStream._state==="writable"&&ry(a,c)}function sT(a){let c=a._controlledWritableStream;Kk(c),nd(a);let p=a._closeAlgorithm();rl(a),m(p,()=>(Hk(c),null),w=>(Gk(c,w),null))}function oT(a,c){let p=a._controlledWritableStream;Jk(p);let w=a._writeAlgorithm(c);m(w,()=>{Wk(p);let v=p._state;if(nd(a),!ln(p)&&v==="writable"){let I=yd(a);md(p,I)}return nl(a),null},v=>(p._state==="writable"&&rl(a),zk(p,v),null))}function yd(a){return ty(a)<=0}function ry(a,c){let p=a._controlledWritableStream;rl(a),hd(p,c)}function il(a){return new TypeError(`WritableStream.prototype.${a} can only be used on a WritableStream`)}function wd(a){return new TypeError(`WritableStreamDefaultController.prototype.${a} can only be used on a WritableStreamDefaultController`)}function Zi(a){return new TypeError(`WritableStreamDefaultWriter.prototype.${a} can only be used on a WritableStreamDefaultWriter`)}function ca(a){return new TypeError("Cannot "+a+" a stream using a released writer")}function sl(a){a._closedPromise=u((c,p)=>{a._closedPromise_resolve=c,a._closedPromise_reject=p,a._closedPromiseState="pending"})}function ny(a,c){sl(a),bd(a,c)}function aT(a){sl(a),iy(a)}function bd(a,c){a._closedPromise_reject!==void 0&&(C(a._closedPromise),a._closedPromise_reject(c),a._closedPromise_resolve=void 0,a._closedPromise_reject=void 0,a._closedPromiseState="rejected")}function cT(a,c){ny(a,c)}function iy(a){a._closedPromise_resolve!==void 0&&(a._closedPromise_resolve(void 0),a._closedPromise_resolve=void 0,a._closedPromise_reject=void 0,a._closedPromiseState="resolved")}function ol(a){a._readyPromise=u((c,p)=>{a._readyPromise_resolve=c,a._readyPromise_reject=p}),a._readyPromiseState="pending"}function vd(a,c){ol(a),oy(a,c)}function sy(a){ol(a),_d(a)}function oy(a,c){a._readyPromise_reject!==void 0&&(C(a._readyPromise),a._readyPromise_reject(c),a._readyPromise_resolve=void 0,a._readyPromise_reject=void 0,a._readyPromiseState="rejected")}function lT(a){ol(a)}function uT(a,c){vd(a,c)}function _d(a){a._readyPromise_resolve!==void 0&&(a._readyPromise_resolve(void 0),a._readyPromise_resolve=void 0,a._readyPromise_reject=void 0,a._readyPromiseState="fulfilled")}function fT(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof global<"u")return global}let Sd=fT();function dT(a){if(!(typeof a=="function"||typeof a=="object")||a.name!=="DOMException")return!1;try{return new a,!0}catch{return!1}}function hT(){let a=Sd?.DOMException;return dT(a)?a:void 0}function pT(){let a=function(p,w){this.message=p||"",this.name=w||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return i(a,"DOMException"),a.prototype=Object.create(Error.prototype),Object.defineProperty(a.prototype,"constructor",{value:a,writable:!0,configurable:!0}),a}let mT=hT()||pT();function ay(a,c,p,w,v,I){let U=cn(a),Z=Hg(c);a._disturbed=!0;let ye=!1,le=d(void 0);return u((Se,Te)=>{let Be;if(I!==void 0){if(Be=()=>{let fe=I.reason!==void 0?I.reason:new mT("Aborted","AbortError"),Ae=[];w||Ae.push(()=>c._state==="writable"?el(c,fe):d(void 0)),v||Ae.push(()=>a._state==="readable"?Mr(a,fe):d(void 0)),Vt(()=>Promise.all(Ae.map($e=>$e())),!0,fe)},I.aborted){Be();return}I.addEventListener("abort",Be)}function qr(){return u((fe,Ae)=>{function $e(nr){nr?fe():h(Qs(),$e,Ae)}$e(!1)})}function Qs(){return ye?d(!0):h(Z._readyPromise,()=>u((fe,Ae)=>{Hi(U,{_chunkSteps:$e=>{le=h(Xg(Z,$e),void 0,e),fe(!1)},_closeSteps:()=>fe(!0),_errorSteps:Ae})}))}if(Pn(a,U._closedPromise,fe=>(w?Sr(!0,fe):Vt(()=>el(c,fe),!0,fe),null)),Pn(c,Z._closedPromise,fe=>(v?Sr(!0,fe):Vt(()=>Mr(a,fe),!0,fe),null)),Pt(a,U._closedPromise,()=>(p?Sr():Vt(()=>Xk(Z)),null)),ln(c)||c._state==="closed"){let fe=new TypeError("the destination writable stream closed before all data could be piped to it");v?Sr(!0,fe):Vt(()=>Mr(a,fe),!0,fe)}C(qr());function mi(){let fe=le;return h(le,()=>fe!==le?mi():void 0)}function Pn(fe,Ae,$e){fe._state==="errored"?$e(fe._storedError):y(Ae,$e)}function Pt(fe,Ae,$e){fe._state==="closed"?$e():g(Ae,$e)}function Vt(fe,Ae,$e){if(ye)return;ye=!0,c._state==="writable"&&!ln(c)?g(mi(),nr):nr();function nr(){return m(fe(),()=>Un(Ae,$e),Xs=>Un(!0,Xs)),null}}function Sr(fe,Ae){ye||(ye=!0,c._state==="writable"&&!ln(c)?g(mi(),()=>Un(fe,Ae)):Un(fe,Ae))}function Un(fe,Ae){return Qg(Z),pe(U),I!==void 0&&I.removeEventListener("abort",Be),fe?Te(Ae):Se(void 0),null}})}class Dn{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!al(this))throw ll("desiredSize");return xd(this)}close(){if(!al(this))throw ll("close");if(!Ks(this))throw new TypeError("The stream is not in a state that permits close");es(this)}enqueue(c=void 0){if(!al(this))throw ll("enqueue");if(!Ks(this))throw new TypeError("The stream is not in a state that permits enqueue");return Ys(this,c)}error(c=void 0){if(!al(this))throw ll("error");Br(this,c)}[R](c){li(this);let p=this._cancelAlgorithm(c);return cl(this),p}[M](c){let p=this._controlledReadableStream;if(this._queue.length>0){let w=nd(this);this._closeRequested&&this._queue.length===0?(cl(this),fa(p)):la(this),c._chunkSteps(w)}else ra(p,c),la(this)}[Q](){}}Object.defineProperties(Dn.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),i(Dn.prototype.close,"close"),i(Dn.prototype.enqueue,"enqueue"),i(Dn.prototype.error,"error"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Dn.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function al(a){return!t(a)||!Object.prototype.hasOwnProperty.call(a,"_controlledReadableStream")?!1:a instanceof Dn}function la(a){if(!cy(a))return;if(a._pulling){a._pullAgain=!0;return}a._pulling=!0;let p=a._pullAlgorithm();m(p,()=>(a._pulling=!1,a._pullAgain&&(a._pullAgain=!1,la(a)),null),w=>(Br(a,w),null))}function cy(a){let c=a._controlledReadableStream;return!Ks(a)||!a._started?!1:!!(hi(c)&&zi(c)>0||xd(a)>0)}function cl(a){a._pullAlgorithm=void 0,a._cancelAlgorithm=void 0,a._strategySizeAlgorithm=void 0}function es(a){if(!Ks(a))return;let c=a._controlledReadableStream;a._closeRequested=!0,a._queue.length===0&&(cl(a),fa(c))}function Ys(a,c){if(!Ks(a))return;let p=a._controlledReadableStream;if(hi(p)&&zi(p)>0)js(p,c,!1);else{let w;try{w=a._strategySizeAlgorithm(c)}catch(v){throw Br(a,v),v}try{id(a,c,w)}catch(v){throw Br(a,v),v}}la(a)}function Br(a,c){let p=a._controlledReadableStream;p._state==="readable"&&(li(a),cl(a),dy(p,c))}function xd(a){let c=a._controlledReadableStream._state;return c==="errored"?null:c==="closed"?0:a._strategyHWM-a._queueTotalSize}function gT(a){return!cy(a)}function Ks(a){let c=a._controlledReadableStream._state;return!a._closeRequested&&c==="readable"}function ly(a,c,p,w,v,I,U){c._controlledReadableStream=a,c._queue=void 0,c._queueTotalSize=void 0,li(c),c._started=!1,c._closeRequested=!1,c._pullAgain=!1,c._pulling=!1,c._strategySizeAlgorithm=U,c._strategyHWM=I,c._pullAlgorithm=w,c._cancelAlgorithm=v,a._readableStreamController=c;let Z=p();m(d(Z),()=>(c._started=!0,la(c),null),ye=>(Br(c,ye),null))}function yT(a,c,p,w){let v=Object.create(Dn.prototype),I,U,Z;c.start!==void 0?I=()=>c.start(v):I=()=>{},c.pull!==void 0?U=()=>c.pull(v):U=()=>d(void 0),c.cancel!==void 0?Z=ye=>c.cancel(ye):Z=()=>d(void 0),ly(a,v,I,U,Z,p,w)}function ll(a){return new TypeError(`ReadableStreamDefaultController.prototype.${a} can only be used on a ReadableStreamDefaultController`)}function wT(a,c){return Ki(a._readableStreamController)?vT(a):bT(a)}function bT(a,c){let p=cn(a),w=!1,v=!1,I=!1,U=!1,Z,ye,le,Se,Te,Be=u(Pt=>{Te=Pt});function qr(){return w?(v=!0,d(void 0)):(w=!0,Hi(p,{_chunkSteps:Vt=>{L(()=>{v=!1;let Sr=Vt,Un=Vt;I||Ys(le._readableStreamController,Sr),U||Ys(Se._readableStreamController,Un),w=!1,v&&qr()})},_closeSteps:()=>{w=!1,I||es(le._readableStreamController),U||es(Se._readableStreamController),(!I||!U)&&Te(void 0)},_errorSteps:()=>{w=!1}}),d(void 0))}function Qs(Pt){if(I=!0,Z=Pt,U){let Vt=Ne([Z,ye]),Sr=Mr(a,Vt);Te(Sr)}return Be}function mi(Pt){if(U=!0,ye=Pt,I){let Vt=Ne([Z,ye]),Sr=Mr(a,Vt);Te(Sr)}return Be}function Pn(){}return le=ua(Pn,qr,Qs),Se=ua(Pn,qr,mi),y(p._closedPromise,Pt=>(Br(le._readableStreamController,Pt),Br(Se._readableStreamController,Pt),(!I||!U)&&Te(void 0),null)),[le,Se]}function vT(a){let c=cn(a),p=!1,w=!1,v=!1,I=!1,U=!1,Z,ye,le,Se,Te,Be=u(fe=>{Te=fe});function qr(fe){y(fe._closedPromise,Ae=>(fe!==c||(_r(le._readableStreamController,Ae),_r(Se._readableStreamController,Ae),(!I||!U)&&Te(void 0)),null))}function Qs(){Qi(c)&&(pe(c),c=cn(a),qr(c)),Hi(c,{_chunkSteps:Ae=>{L(()=>{w=!1,v=!1;let $e=Ae,nr=Ae;if(!I&&!U)try{nr=zc(Ae)}catch(Xs){_r(le._readableStreamController,Xs),_r(Se._readableStreamController,Xs),Te(Mr(a,Xs));return}I||Yc(le._readableStreamController,$e),U||Yc(Se._readableStreamController,nr),p=!1,w?Pn():v&&Pt()})},_closeSteps:()=>{p=!1,I||ia(le._readableStreamController),U||ia(Se._readableStreamController),le._readableStreamController._pendingPullIntos.length>0&&Kc(le._readableStreamController,0),Se._readableStreamController._pendingPullIntos.length>0&&Kc(Se._readableStreamController,0),(!I||!U)&&Te(void 0)},_errorSteps:()=>{p=!1}})}function mi(fe,Ae){vr(c)&&(pe(c),c=qg(a),qr(c));let $e=Ae?Se:le,nr=Ae?le:Se;Vg(c,fe,1,{_chunkSteps:Zs=>{L(()=>{w=!1,v=!1;let eo=Ae?U:I;if(Ae?I:U)eo||Jc($e._readableStreamController,Zs);else{let Cy;try{Cy=zc(Zs)}catch(Rd){_r($e._readableStreamController,Rd),_r(nr._readableStreamController,Rd),Te(Mr(a,Rd));return}eo||Jc($e._readableStreamController,Zs),Yc(nr._readableStreamController,Cy)}p=!1,w?Pn():v&&Pt()})},_closeSteps:Zs=>{p=!1;let eo=Ae?U:I,yl=Ae?I:U;eo||ia($e._readableStreamController),yl||ia(nr._readableStreamController),Zs!==void 0&&(eo||Jc($e._readableStreamController,Zs),!yl&&nr._readableStreamController._pendingPullIntos.length>0&&Kc(nr._readableStreamController,0)),(!eo||!yl)&&Te(void 0)},_errorSteps:()=>{p=!1}})}function Pn(){if(p)return w=!0,d(void 0);p=!0;let fe=ld(le._readableStreamController);return fe===null?Qs():mi(fe._view,!1),d(void 0)}function Pt(){if(p)return v=!0,d(void 0);p=!0;let fe=ld(Se._readableStreamController);return fe===null?Qs():mi(fe._view,!0),d(void 0)}function Vt(fe){if(I=!0,Z=fe,U){let Ae=Ne([Z,ye]),$e=Mr(a,Ae);Te($e)}return Be}function Sr(fe){if(U=!0,ye=fe,I){let Ae=Ne([Z,ye]),$e=Mr(a,Ae);Te($e)}return Be}function Un(){}return le=fy(Un,Pn,Vt),Se=fy(Un,Pt,Sr),qr(c),[le,Se]}function _T(a){return t(a)&&typeof a.getReader<"u"}function ST(a){return _T(a)?ET(a.getReader()):xT(a)}function xT(a){let c,p=Le(a,"async"),w=e;function v(){let U;try{U=Xe(p)}catch(ye){return f(ye)}let Z=d(U);return b(Z,ye=>{if(!t(ye))throw new TypeError("The promise returned by the iterator.next() method must fulfill with an object");if(rr(ye))es(c._readableStreamController);else{let Se=Wc(ye);Ys(c._readableStreamController,Se)}})}function I(U){let Z=p.iterator,ye;try{ye=re(Z,"return")}catch(Te){return f(Te)}if(ye===void 0)return d(void 0);let le;try{le=j(ye,Z,[U])}catch(Te){return f(Te)}let Se=d(le);return b(Se,Te=>{if(!t(Te))throw new TypeError("The promise returned by the iterator.return() method must fulfill with an object")})}return c=ua(w,v,I,0),c}function ET(a){let c,p=e;function w(){let I;try{I=a.read()}catch(U){return f(U)}return b(I,U=>{if(!t(U))throw new TypeError("The promise returned by the reader.read() method must fulfill with an object");if(U.done)es(c._readableStreamController);else{let Z=U.value;Ys(c._readableStreamController,Z)}})}function v(I){try{return d(a.cancel(I))}catch(U){return f(U)}}return c=ua(p,w,v,0),c}function CT(a,c){ue(a,c);let p=a,w=p?.autoAllocateChunkSize,v=p?.cancel,I=p?.pull,U=p?.start,Z=p?.type;return{autoAllocateChunkSize:w===void 0?void 0:tr(w,`${c} has member 'autoAllocateChunkSize' that`),cancel:v===void 0?void 0:kT(v,p,`${c} has member 'cancel' that`),pull:I===void 0?void 0:TT(I,p,`${c} has member 'pull' that`),start:U===void 0?void 0:RT(U,p,`${c} has member 'start' that`),type:Z===void 0?void 0:AT(Z,`${c} has member 'type' that`)}}function kT(a,c,p){return J(a,p),w=>O(a,c,[w])}function TT(a,c,p){return J(a,p),w=>O(a,c,[w])}function RT(a,c,p){return J(a,p),w=>j(a,c,[w])}function AT(a,c){if(a=`${a}`,a!=="bytes")throw new TypeError(`${c} '${a}' is not a valid enumeration value for ReadableStreamType`);return a}function IT(a,c){return ue(a,c),{preventCancel:!!a?.preventCancel}}function uy(a,c){ue(a,c);let p=a?.preventAbort,w=a?.preventCancel,v=a?.preventClose,I=a?.signal;return I!==void 0&&OT(I,`${c} has member 'signal' that`),{preventAbort:!!p,preventCancel:!!w,preventClose:!!v,signal:I}}function OT(a,c){if(!Mk(a))throw new TypeError(`${c} is not an AbortSignal.`)}function DT(a,c){ue(a,c);let p=a?.readable;an(p,"readable","ReadableWritablePair"),An(p,`${c} has member 'readable' that`);let w=a?.writable;return an(w,"writable","ReadableWritablePair"),zg(w,`${c} has member 'writable' that`),{readable:p,writable:w}}class Tt{constructor(c={},p={}){c===void 0?c=null:kt(c,"First parameter");let w=Zc(p,"Second parameter"),v=CT(c,"First parameter");if(Ed(this),v.type==="bytes"){if(w.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let I=oa(w,0);kk(this,v,I)}else{let I=Xc(w),U=oa(w,1);yT(this,v,U,I)}}get locked(){if(!di(this))throw ts("locked");return hi(this)}cancel(c=void 0){return di(this)?hi(this)?f(new TypeError("Cannot cancel a stream that already has a reader")):Mr(this,c):f(ts("cancel"))}getReader(c=void 0){if(!di(this))throw ts("getReader");return Rk(c,"First parameter").mode===void 0?cn(this):qg(this)}pipeThrough(c,p={}){if(!di(this))throw ts("pipeThrough");nt(c,1,"pipeThrough");let w=DT(c,"First parameter"),v=uy(p,"Second parameter");if(hi(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(Hs(w.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let I=ay(this,w.writable,v.preventClose,v.preventAbort,v.preventCancel,v.signal);return C(I),w.readable}pipeTo(c,p={}){if(!di(this))return f(ts("pipeTo"));if(c===void 0)return f("Parameter 1 is required in 'pipeTo'.");if(!zs(c))return f(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let w;try{w=uy(p,"Second parameter")}catch(v){return f(v)}return hi(this)?f(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):Hs(c)?f(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):ay(this,c,w.preventClose,w.preventAbort,w.preventCancel,w.signal)}tee(){if(!di(this))throw ts("tee");let c=wT(this);return Ne(c)}values(c=void 0){if(!di(this))throw ts("values");let p=IT(c,"First parameter");return td(this,p.preventCancel)}[Ce](c){return this.values(c)}static from(c){return ST(c)}}Object.defineProperties(Tt,{from:{enumerable:!0}}),Object.defineProperties(Tt.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),i(Tt.from,"from"),i(Tt.prototype.cancel,"cancel"),i(Tt.prototype.getReader,"getReader"),i(Tt.prototype.pipeThrough,"pipeThrough"),i(Tt.prototype.pipeTo,"pipeTo"),i(Tt.prototype.tee,"tee"),i(Tt.prototype.values,"values"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Tt.prototype,Symbol.toStringTag,{value:"ReadableStream",configurable:!0}),Object.defineProperty(Tt.prototype,Ce,{value:Tt.prototype.values,writable:!0,configurable:!0});function ua(a,c,p,w=1,v=()=>1){let I=Object.create(Tt.prototype);Ed(I);let U=Object.create(Dn.prototype);return ly(I,U,a,c,p,w,v),I}function fy(a,c,p){let w=Object.create(Tt.prototype);Ed(w);let v=Object.create(In.prototype);return Mg(w,v,a,c,p,0,void 0),w}function Ed(a){a._state="readable",a._reader=void 0,a._storedError=void 0,a._disturbed=!1}function di(a){return!t(a)||!Object.prototype.hasOwnProperty.call(a,"_readableStreamController")?!1:a instanceof Tt}function hi(a){return a._reader!==void 0}function Mr(a,c){if(a._disturbed=!0,a._state==="closed")return d(void 0);if(a._state==="errored")return f(a._storedError);fa(a);let p=a._reader;if(p!==void 0&&Qi(p)){let v=p._readIntoRequests;p._readIntoRequests=new N,v.forEach(I=>{I._closeSteps(void 0)})}let w=a._readableStreamController[R](c);return b(w,e)}function fa(a){a._state="closed";let c=a._reader;if(c!==void 0&&(me(c),vr(c))){let p=c._readRequests;c._readRequests=new N,p.forEach(w=>{w._closeSteps()})}}function dy(a,c){a._state="errored",a._storedError=c;let p=a._reader;p!==void 0&&(V(p,c),vr(p)?jc(p,c):Wg(p,c))}function ts(a){return new TypeError(`ReadableStream.prototype.${a} can only be used on a ReadableStream`)}function hy(a,c){ue(a,c);let p=a?.highWaterMark;return an(p,"highWaterMark","QueuingStrategyInit"),{highWaterMark:lt(p)}}let py=a=>a.byteLength;i(py,"size");class ul{constructor(c){nt(c,1,"ByteLengthQueuingStrategy"),c=hy(c,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=c.highWaterMark}get highWaterMark(){if(!gy(this))throw my("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!gy(this))throw my("size");return py}}Object.defineProperties(ul.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ul.prototype,Symbol.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function my(a){return new TypeError(`ByteLengthQueuingStrategy.prototype.${a} can only be used on a ByteLengthQueuingStrategy`)}function gy(a){return!t(a)||!Object.prototype.hasOwnProperty.call(a,"_byteLengthQueuingStrategyHighWaterMark")?!1:a instanceof ul}let yy=()=>1;i(yy,"size");class fl{constructor(c){nt(c,1,"CountQueuingStrategy"),c=hy(c,"First parameter"),this._countQueuingStrategyHighWaterMark=c.highWaterMark}get highWaterMark(){if(!by(this))throw wy("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!by(this))throw wy("size");return yy}}Object.defineProperties(fl.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(fl.prototype,Symbol.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function wy(a){return new TypeError(`CountQueuingStrategy.prototype.${a} can only be used on a CountQueuingStrategy`)}function by(a){return!t(a)||!Object.prototype.hasOwnProperty.call(a,"_countQueuingStrategyHighWaterMark")?!1:a instanceof fl}function PT(a,c){ue(a,c);let p=a?.cancel,w=a?.flush,v=a?.readableType,I=a?.start,U=a?.transform,Z=a?.writableType;return{cancel:p===void 0?void 0:NT(p,a,`${c} has member 'cancel' that`),flush:w===void 0?void 0:UT(w,a,`${c} has member 'flush' that`),readableType:v,start:I===void 0?void 0:LT(I,a,`${c} has member 'start' that`),transform:U===void 0?void 0:FT(U,a,`${c} has member 'transform' that`),writableType:Z}}function UT(a,c,p){return J(a,p),w=>O(a,c,[w])}function LT(a,c,p){return J(a,p),w=>j(a,c,[w])}function FT(a,c,p){return J(a,p),(w,v)=>O(a,c,[w,v])}function NT(a,c,p){return J(a,p),w=>O(a,c,[w])}class dl{constructor(c={},p={},w={}){c===void 0&&(c=null);let v=Zc(p,"Second parameter"),I=Zc(w,"Third parameter"),U=PT(c,"First parameter");if(U.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(U.writableType!==void 0)throw new RangeError("Invalid writableType specified");let Z=oa(I,0),ye=Xc(I),le=oa(v,1),Se=Xc(v),Te,Be=u(qr=>{Te=qr});BT(this,Be,le,Se,Z,ye),qT(this,U),U.start!==void 0?Te(U.start(this._transformStreamController)):Te(void 0)}get readable(){if(!vy(this))throw Ey("readable");return this._readable}get writable(){if(!vy(this))throw Ey("writable");return this._writable}}Object.defineProperties(dl.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(dl.prototype,Symbol.toStringTag,{value:"TransformStream",configurable:!0});function BT(a,c,p,w,v,I){function U(){return c}function Z(Be){return VT(a,Be)}function ye(Be){return WT(a,Be)}function le(){return zT(a)}a._writable=$k(U,Z,le,ye,p,w);function Se(){return HT(a)}function Te(Be){return GT(a,Be)}a._readable=ua(U,Se,Te,v,I),a._backpressure=void 0,a._backpressureChangePromise=void 0,a._backpressureChangePromise_resolve=void 0,hl(a,!0),a._transformStreamController=void 0}function vy(a){return!t(a)||!Object.prototype.hasOwnProperty.call(a,"_transformStreamController")?!1:a instanceof dl}function _y(a,c){Br(a._readable._readableStreamController,c),Cd(a,c)}function Cd(a,c){ml(a._transformStreamController),aa(a._writable._writableStreamController,c),kd(a)}function kd(a){a._backpressure&&hl(a,!1)}function hl(a,c){a._backpressureChangePromise!==void 0&&a._backpressureChangePromise_resolve(),a._backpressureChangePromise=u(p=>{a._backpressureChangePromise_resolve=p}),a._backpressure=c}class pi{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!pl(this))throw gl("desiredSize");let c=this._controlledTransformStream._readable._readableStreamController;return xd(c)}enqueue(c=void 0){if(!pl(this))throw gl("enqueue");Sy(this,c)}error(c=void 0){if(!pl(this))throw gl("error");jT(this,c)}terminate(){if(!pl(this))throw gl("terminate");$T(this)}}Object.defineProperties(pi.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),i(pi.prototype.enqueue,"enqueue"),i(pi.prototype.error,"error"),i(pi.prototype.terminate,"terminate"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(pi.prototype,Symbol.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function pl(a){return!t(a)||!Object.prototype.hasOwnProperty.call(a,"_controlledTransformStream")?!1:a instanceof pi}function MT(a,c,p,w,v){c._controlledTransformStream=a,a._transformStreamController=c,c._transformAlgorithm=p,c._flushAlgorithm=w,c._cancelAlgorithm=v,c._finishPromise=void 0,c._finishPromise_resolve=void 0,c._finishPromise_reject=void 0}function qT(a,c){let p=Object.create(pi.prototype),w,v,I;c.transform!==void 0?w=U=>c.transform(U,p):w=U=>{try{return Sy(p,U),d(void 0)}catch(Z){return f(Z)}},c.flush!==void 0?v=()=>c.flush(p):v=()=>d(void 0),c.cancel!==void 0?I=U=>c.cancel(U):I=()=>d(void 0),MT(a,p,w,v,I)}function ml(a){a._transformAlgorithm=void 0,a._flushAlgorithm=void 0,a._cancelAlgorithm=void 0}function Sy(a,c){let p=a._controlledTransformStream,w=p._readable._readableStreamController;if(!Ks(w))throw new TypeError("Readable side is not in a state that permits enqueue");try{Ys(w,c)}catch(I){throw Cd(p,I),p._readable._storedError}gT(w)!==p._backpressure&&hl(p,!0)}function jT(a,c){_y(a._controlledTransformStream,c)}function xy(a,c){let p=a._transformAlgorithm(c);return b(p,void 0,w=>{throw _y(a._controlledTransformStream,w),w})}function $T(a){let c=a._controlledTransformStream,p=c._readable._readableStreamController;es(p);let w=new TypeError("TransformStream terminated");Cd(c,w)}function VT(a,c){let p=a._transformStreamController;if(a._backpressure){let w=a._backpressureChangePromise;return b(w,()=>{let v=a._writable;if(v._state==="erroring")throw v._storedError;return xy(p,c)})}return xy(p,c)}function WT(a,c){let p=a._transformStreamController;if(p._finishPromise!==void 0)return p._finishPromise;let w=a._readable;p._finishPromise=u((I,U)=>{p._finishPromise_resolve=I,p._finishPromise_reject=U});let v=p._cancelAlgorithm(c);return ml(p),m(v,()=>(w._state==="errored"?Js(p,w._storedError):(Br(w._readableStreamController,c),Td(p)),null),I=>(Br(w._readableStreamController,I),Js(p,I),null)),p._finishPromise}function zT(a){let c=a._transformStreamController;if(c._finishPromise!==void 0)return c._finishPromise;let p=a._readable;c._finishPromise=u((v,I)=>{c._finishPromise_resolve=v,c._finishPromise_reject=I});let w=c._flushAlgorithm();return ml(c),m(w,()=>(p._state==="errored"?Js(c,p._storedError):(es(p._readableStreamController),Td(c)),null),v=>(Br(p._readableStreamController,v),Js(c,v),null)),c._finishPromise}function HT(a){return hl(a,!1),a._backpressureChangePromise}function GT(a,c){let p=a._transformStreamController;if(p._finishPromise!==void 0)return p._finishPromise;let w=a._writable;p._finishPromise=u((I,U)=>{p._finishPromise_resolve=I,p._finishPromise_reject=U});let v=p._cancelAlgorithm(c);return ml(p),m(v,()=>(w._state==="errored"?Js(p,w._storedError):(aa(w._writableStreamController,c),kd(a),Td(p)),null),I=>(aa(w._writableStreamController,I),kd(a),Js(p,I),null)),p._finishPromise}function gl(a){return new TypeError(`TransformStreamDefaultController.prototype.${a} can only be used on a TransformStreamDefaultController`)}function Td(a){a._finishPromise_resolve!==void 0&&(a._finishPromise_resolve(),a._finishPromise_resolve=void 0,a._finishPromise_reject=void 0)}function Js(a,c){a._finishPromise_reject!==void 0&&(C(a._finishPromise),a._finishPromise_reject(c),a._finishPromise_resolve=void 0,a._finishPromise_reject=void 0)}function Ey(a){return new TypeError(`TransformStream.prototype.${a} can only be used on a TransformStream`)}r.ByteLengthQueuingStrategy=ul,r.CountQueuingStrategy=fl,r.ReadableByteStreamController=In,r.ReadableStream=Tt,r.ReadableStreamBYOBReader=ui,r.ReadableStreamBYOBRequest=Yi,r.ReadableStreamDefaultController=Dn,r.ReadableStreamDefaultReader=Nr,r.TransformStream=dl,r.TransformStreamDefaultController=pi,r.WritableStream=fi,r.WritableStreamDefaultController=Gs,r.WritableStreamDefaultWriter=On})});var jC=W(()=>{if(!globalThis.ReadableStream)try{let r=require("node:process"),{emitWarning:e}=r;try{r.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),r.emitWarning=e}catch(t){throw r.emitWarning=e,t}}catch{Object.assign(globalThis,qC())}try{let{Blob:r}=require("buffer");r&&!r.prototype.stream&&(r.prototype.stream=function(t){let n=0,i=this;return new ReadableStream({type:"bytes",async pull(s){let l=await i.slice(n,Math.min(i.size,n+65536)).arrayBuffer();n+=l.byteLength,s.enqueue(new Uint8Array(l)),n===i.size&&s.close()}})})}catch{}});async function*wg(r,e=!0){for(let t of r)if("stream"in t)yield*t.stream();else if(ArrayBuffer.isView(t))if(e){let n=t.byteOffset,i=t.byteOffset+t.byteLength;for(;n!==i;){let s=Math.min(i-n,$C),o=t.buffer.slice(n,n+s);n+=o.byteLength,yield new Uint8Array(o)}}else yield t;else{let n=0,i=t;for(;n!==i.size;){let o=await i.slice(n,Math.min(i.size,n+$C)).arrayBuffer();n+=o.byteLength,yield new Uint8Array(o)}}}var p$,$C,VC,qN,oi,Uc=da(()=>{p$=de(jC(),1);$C=65536;VC=class bg{#e=[];#t="";#r=0;#n="transparent";constructor(e=[],t={}){if(typeof e!="object"||e===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof e[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof t!="object"&&typeof t!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");t===null&&(t={});let n=new TextEncoder;for(let s of e){let o;ArrayBuffer.isView(s)?o=new Uint8Array(s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)):s instanceof ArrayBuffer?o=new Uint8Array(s.slice(0)):s instanceof bg?o=s:o=n.encode(`${s}`),this.#r+=ArrayBuffer.isView(o)?o.byteLength:o.size,this.#e.push(o)}this.#n=`${t.endings===void 0?"transparent":t.endings}`;let i=t.type===void 0?"":String(t.type);this.#t=/^[\x20-\x7E]*$/.test(i)?i:""}get size(){return this.#r}get type(){return this.#t}async text(){let e=new TextDecoder,t="";for await(let n of wg(this.#e,!1))t+=e.decode(n,{stream:!0});return t+=e.decode(),t}async arrayBuffer(){let e=new Uint8Array(this.size),t=0;for await(let n of wg(this.#e,!1))e.set(n,t),t+=n.length;return e.buffer}stream(){let e=wg(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(t){let n=await e.next();n.done?t.close():t.enqueue(n.value)},async cancel(){await e.return()}})}slice(e=0,t=this.size,n=""){let{size:i}=this,s=e<0?Math.max(i+e,0):Math.min(e,i),o=t<0?Math.max(i+t,0):Math.min(t,i),l=Math.max(o-s,0),u=this.#e,d=[],f=0;for(let m of u){if(f>=l)break;let g=ArrayBuffer.isView(m)?m.byteLength:m.size;if(s&&g<=s)s-=g,o-=g;else{let y;ArrayBuffer.isView(m)?(y=m.subarray(s,Math.min(g,o)),f+=y.byteLength):(y=m.slice(s,Math.min(g,o)),f+=y.size),o-=g,d.push(y),s=0}}let h=new bg([],{type:String(n).toLowerCase()});return h.#r=l,h.#e=d,h}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](e){return e&&typeof e=="object"&&typeof e.constructor=="function"&&(typeof e.stream=="function"||typeof e.arrayBuffer=="function")&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}};Object.defineProperties(VC.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});qN=VC,oi=qN});var jN,$N,Zo,vg=da(()=>{Uc();jN=class extends oi{#e=0;#t="";constructor(e,t,n={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(e,n),n===null&&(n={});let i=n.lastModified===void 0?Date.now():Number(n.lastModified);Number.isNaN(i)||(this.#e=i),this.#t=String(t)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](e){return!!e&&e instanceof oi&&/^(File)$/.test(e[Symbol.toStringTag])}},$N=jN,Zo=$N});function HC(r,e=oi){var t=`${WC()}${WC()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),n=[],i=`--${t}\r
Content-Disposition: form-data; name="`;return r.forEach((s,o)=>typeof s=="string"?n.push(i+_g(o)+`"\r
\r
${s.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):n.push(i+_g(o)+`"; filename="${_g(s.name,1)}"\r
Content-Type: ${s.type||"application/octet-stream"}\r
\r
`,s,`\r
`)),n.push(`--${t}--`),new e(n,{type:"multipart/form-data; boundary="+t})}var Lc,VN,WN,WC,zN,zC,_g,Fs,Ns,Wf=da(()=>{Uc();vg();({toStringTag:Lc,iterator:VN,hasInstance:WN}=Symbol),WC=Math.random,zN="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),zC=(r,e,t)=>(r+="",/^(Blob|File)$/.test(e&&e[Lc])?[(t=t!==void 0?t+"":e[Lc]=="File"?e.name:"blob",r),e.name!==t||e[Lc]=="blob"?new Zo([e],t,e):e]:[r,e+""]),_g=(r,e)=>(e?r:r.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),Fs=(r,e,t)=>{if(e.length<t)throw new TypeError(`Failed to execute '${r}' on 'FormData': ${t} arguments required, but only ${e.length} present.`)},Ns=class{#e=[];constructor(...e){if(e.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[Lc](){return"FormData"}[VN](){return this.entries()}static[WN](e){return e&&typeof e=="object"&&e[Lc]==="FormData"&&!zN.some(t=>typeof e[t]!="function")}append(...e){Fs("append",arguments,2),this.#e.push(zC(...e))}delete(e){Fs("delete",arguments,1),e+="",this.#e=this.#e.filter(([t])=>t!==e)}get(e){Fs("get",arguments,1),e+="";for(var t=this.#e,n=t.length,i=0;i<n;i++)if(t[i][0]===e)return t[i][1];return null}getAll(e,t){return Fs("getAll",arguments,1),t=[],e+="",this.#e.forEach(n=>n[0]===e&&t.push(n[1])),t}has(e){return Fs("has",arguments,1),e+="",this.#e.some(t=>t[0]===e)}forEach(e,t){Fs("forEach",arguments,1);for(var[n,i]of this)e.call(t,i,n,this)}set(...e){Fs("set",arguments,2);var t=[],n=!0;e=zC(...e),this.#e.forEach(i=>{i[0]===e[0]?n&&(n=!t.push(e)):t.push(i)}),n&&t.push(e),this.#e=t}*entries(){yield*this.#e}*keys(){for(var[e]of this)yield e}*values(){for(var[,e]of this)yield e}}});var QC=W((T$,JC)=>{if(!globalThis.DOMException)try{let{MessageChannel:r}=require("worker_threads"),e=new r().port1,t=new ArrayBuffer;e.postMessage(t,[t,t])}catch(r){r.constructor.name==="DOMException"&&(globalThis.DOMException=r.constructor)}JC.exports=globalThis.DOMException});var Hf,HN,I$,xg=da(()=>{Hf=require("node:fs"),HN=de(QC(),1);vg();Uc();({stat:I$}=Hf.promises)});var ZC={};Ad(ZC,{toFormData:()=>ZN});function XN(r){let e=r.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!e)return;let t=e[2]||e[3]||"",n=t.slice(t.lastIndexOf("\\")+1);return n=n.replace(/%22/g,'"'),n=n.replace(/&#(\d{4});/g,(i,s)=>String.fromCharCode(s)),n}async function ZN(r,e){if(!/multipart/i.test(e))throw new TypeError("Failed to fetch");let t=e.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!t)throw new TypeError("no or bad content-type header, no multipart boundary");let n=new Eg(t[1]||t[2]),i,s,o,l,u,d,f=[],h=new Ns,m=L=>{o+=C.decode(L,{stream:!0})},g=L=>{f.push(L)},y=()=>{let L=new Zo(f,d,{type:u});h.append(l,L)},b=()=>{h.append(l,o)},C=new TextDecoder("utf-8");C.decode(),n.onPartBegin=function(){n.onPartData=m,n.onPartEnd=b,i="",s="",o="",l="",u="",d=null,f.length=0},n.onHeaderField=function(L){i+=C.decode(L,{stream:!0})},n.onHeaderValue=function(L){s+=C.decode(L,{stream:!0})},n.onHeaderEnd=function(){if(s+=C.decode(),i=i.toLowerCase(),i==="content-disposition"){let L=s.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);L&&(l=L[2]||L[3]||""),d=XN(s),d&&(n.onPartData=g,n.onPartEnd=y)}else i==="content-type"&&(u=s);s="",i=""};for await(let L of r)n.write(L);return n.end(),h}var Tn,Ye,XC,Wi,Gf,Yf,GN,Nc,YN,KN,JN,QN,Bs,Eg,ek=da(()=>{xg();Wf();Tn=0,Ye={START_BOUNDARY:Tn++,HEADER_FIELD_START:Tn++,HEADER_FIELD:Tn++,HEADER_VALUE_START:Tn++,HEADER_VALUE:Tn++,HEADER_VALUE_ALMOST_DONE:Tn++,HEADERS_ALMOST_DONE:Tn++,PART_DATA_START:Tn++,PART_DATA:Tn++,END:Tn++},XC=1,Wi={PART_BOUNDARY:XC,LAST_BOUNDARY:XC*=2},Gf=10,Yf=13,GN=32,Nc=45,YN=58,KN=97,JN=122,QN=r=>r|32,Bs=()=>{},Eg=class{constructor(e){this.index=0,this.flags=0,this.onHeaderEnd=Bs,this.onHeaderField=Bs,this.onHeadersEnd=Bs,this.onHeaderValue=Bs,this.onPartBegin=Bs,this.onPartData=Bs,this.onPartEnd=Bs,this.boundaryChars={},e=`\r
--`+e;let t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n),this.boundaryChars[t[n]]=!0;this.boundary=t,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=Ye.START_BOUNDARY}write(e){let t=0,n=e.length,i=this.index,{lookbehind:s,boundary:o,boundaryChars:l,index:u,state:d,flags:f}=this,h=this.boundary.length,m=h-1,g=e.length,y,b,C=D=>{this[D+"Mark"]=t},L=D=>{delete this[D+"Mark"]},j=(D,N,k,P)=>{(N===void 0||N!==k)&&this[D](P&&P.subarray(N,k))},O=(D,N)=>{let k=D+"Mark";k in this&&(N?(j(D,this[k],t,e),delete this[k]):(j(D,this[k],e.length,e),this[k]=0))};for(t=0;t<n;t++)switch(y=e[t],d){case Ye.START_BOUNDARY:if(u===o.length-2){if(y===Nc)f|=Wi.LAST_BOUNDARY;else if(y!==Yf)return;u++;break}else if(u-1===o.length-2){if(f&Wi.LAST_BOUNDARY&&y===Nc)d=Ye.END,f=0;else if(!(f&Wi.LAST_BOUNDARY)&&y===Gf)u=0,j("onPartBegin"),d=Ye.HEADER_FIELD_START;else return;break}y!==o[u+2]&&(u=-2),y===o[u+2]&&u++;break;case Ye.HEADER_FIELD_START:d=Ye.HEADER_FIELD,C("onHeaderField"),u=0;case Ye.HEADER_FIELD:if(y===Yf){L("onHeaderField"),d=Ye.HEADERS_ALMOST_DONE;break}if(u++,y===Nc)break;if(y===YN){if(u===1)return;O("onHeaderField",!0),d=Ye.HEADER_VALUE_START;break}if(b=QN(y),b<KN||b>JN)return;break;case Ye.HEADER_VALUE_START:if(y===GN)break;C("onHeaderValue"),d=Ye.HEADER_VALUE;case Ye.HEADER_VALUE:y===Yf&&(O("onHeaderValue",!0),j("onHeaderEnd"),d=Ye.HEADER_VALUE_ALMOST_DONE);break;case Ye.HEADER_VALUE_ALMOST_DONE:if(y!==Gf)return;d=Ye.HEADER_FIELD_START;break;case Ye.HEADERS_ALMOST_DONE:if(y!==Gf)return;j("onHeadersEnd"),d=Ye.PART_DATA_START;break;case Ye.PART_DATA_START:d=Ye.PART_DATA,C("onPartData");case Ye.PART_DATA:if(i=u,u===0){for(t+=m;t<g&&!(e[t]in l);)t+=h;t-=m,y=e[t]}if(u<o.length)o[u]===y?(u===0&&O("onPartData",!0),u++):u=0;else if(u===o.length)u++,y===Yf?f|=Wi.PART_BOUNDARY:y===Nc?f|=Wi.LAST_BOUNDARY:u=0;else if(u-1===o.length)if(f&Wi.PART_BOUNDARY){if(u=0,y===Gf){f&=~Wi.PART_BOUNDARY,j("onPartEnd"),j("onPartBegin"),d=Ye.HEADER_FIELD_START;break}}else f&Wi.LAST_BOUNDARY&&y===Nc?(j("onPartEnd"),d=Ye.END,f=0):u=0;if(u>0)s[u-1]=y;else if(i>0){let D=new Uint8Array(s.buffer,s.byteOffset,s.byteLength);j("onPartData",0,i,D),i=0,C("onPartData"),t--}break;case Ye.END:break;default:throw new Error(`Unexpected state entered: ${d}`)}O("onHeaderField"),O("onHeaderValue"),O("onPartData"),this.index=u,this.state=d,this.flags=f}end(){if(this.state===Ye.HEADER_FIELD_START&&this.index===0||this.state===Ye.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==Ye.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var lB={};Ad(lB,{activate:()=>aB,deactivate:()=>cB});module.exports=ZT(lB);var bV=de(Id()),yk=de(require("node:crypto"));function Je(r){return typeof r=="object"&&r!==null}function Iy(r,e){return Array.isArray(r)?e?r.every(e):!0:!1}function xr(r){return typeof r=="string"}var _w=de(Kd(),1),jr="0.3.0",Jd=new _w.SemVer(jr);function Sw(r,e=Jd){return e.major!==r.major?!1:e.major===0&&r.major===0?e.minor===r.minor:!0}var Qd;(function(r){function e(t){return Je(t)&&Xd.is(t.encryption)&&Zd.is(t.compression)}r.is=e})(Qd||(Qd={}));var ns={encryption:{keys:[]},compression:{algorithm:"none"}},Xd;(function(r){function e(t){return Je(t)&&Iy(t.keys,eh.is)}r.is=e})(Xd||(Xd={}));var Zd;(function(r){function e(t){return Je(t)&&xr(t.algorithm)}r.is=e})(Zd||(Zd={}));var eh;(function(r){function e(t){return Je(t)&&xr(t.target)&&xr(t.key)&&xr(t.iv)}r.is=e})(eh||(eh={}));var zt;(function(r){function e(n){return Je(n)&&xr(n.version)&&xr(n.kind)&&Qd.is(n.metadata)}r.is=e;function t(n){return n.content instanceof Uint8Array}r.isEncrypted=t})(zt||(zt={}));var io;(function(r){function e(s){return{version:jr,kind:"error",metadata:ns,content:{message:s}}}r.create=e;function t(s){return zt.is(s)&&s.kind==="error"}r.isAny=t;function n(s){return t(s)&&Je(s.content)&&xr(s.content.message)}r.is=n;function i(s){return t(s)&&zt.isEncrypted(s)}r.isBinary=i})(io||(io={}));var is;(function(r){function e(s,o,l,u,d){return{version:jr,id:o,metadata:ns,origin:l,target:u,kind:"request",content:{method:typeof s=="string"?s:s.method,params:d}}}r.create=e;function t(s){return zt.is(s)&&s.kind==="request"}r.isAny=t;function n(s){if(!t(s))return!1;let o=s.content;return Je(o)&&xr(o.method)}r.is=n;function i(s){return t(s)&&zt.isEncrypted(s)}r.isEncrypted=i})(is||(is={}));var ss;(function(r){function e(s,o){return{kind:"response",version:jr,id:s,metadata:ns,content:{response:o}}}r.create=e;function t(s){return zt.is(s)&&s.kind==="response"}r.isAny=t;function n(s){return t(s)&&Je(s.content)&&"response"in s.content}r.is=n;function i(s){return t(s)&&zt.isEncrypted(s)}r.isEncrypted=i})(ss||(ss={}));var os;(function(r){function e(s,o){return typeof o=="string"?{kind:"response-error",version:jr,metadata:ns,id:s,content:{message:o}}:{kind:"response-error",version:jr,metadata:ns,id:s,content:o}}r.create=e;function t(s){return zt.is(s)&&s.kind==="response-error"}r.isAny=t;function n(s){return t(s)&&Je(s.content)&&xr(s.content.message)}r.is=n;function i(s){return t(s)&&zt.isEncrypted(s)}r.isEncrypted=i})(os||(os={}));var as;(function(r){function e(s,o,l,u){return{version:jr,kind:"notification",metadata:ns,target:l,origin:o,content:{method:typeof s=="string"?s:s.method,params:u}}}r.create=e;function t(s){return zt.is(s)&&s.kind==="notification"}r.isAny=t;function n(s){if(!t(s))return!1;let o=s.content;return Je(o)&&xr(o.method)}r.is=n;function i(s){return t(s)&&zt.isEncrypted(s)}r.isEncrypted=i})(as||(as={}));var gi;(function(r){function e(s,o,l){return{version:jr,kind:"broadcast",metadata:ns,origin:o,content:{method:typeof s=="string"?s:s.method,params:l}}}r.create=e;function t(s){return zt.is(s)&&s.kind==="broadcast"}r.isAny=t;function n(s){if(!t(s))return!1;let o=s.content;return Je(o)&&xr(o.method)}r.is=n;function i(s){return t(s)&&zt.isEncrypted(s)}r.isEncrypted=i})(gi||(gi={}));var va=class{method;constructor(e){this.method=e}},kr=class extends va{_;constructor(e){super(e)}},$r=class extends va{_;constructor(e){super(e)}},Ln=class extends va{_;constructor(e){super(e)}};var Al;(function(r){function e(n){return Je(n)&&typeof n.dispose=="function"}r.is=e;function t(n){return{dispose:n}}r.create=t})(Al||(Al={}));Object.defineProperty(Al,"NULL",{configurable:!1,enumerable:!0,get(){return{dispose:()=>{}}}});var cs=class{disposables=[];onDisposeEmitter=new ir;constructor(...e){e.forEach(t=>this.push(t))}get onDispose(){return this.onDisposeEmitter.event}checkDisposed(){this.disposed&&!this.disposingElements&&(this.onDisposeEmitter.fire(void 0),this.onDisposeEmitter.dispose())}get disposed(){return this.disposables.length===0}disposingElements=!1;dispose(){if(!(this.disposed||this.disposingElements)){for(this.disposingElements=!0;!this.disposed;)try{this.disposables.pop().dispose()}catch(e){console.error(e)}this.disposingElements=!1,this.checkDisposed()}}push(e){let t=this.disposables;t.push(e);let n=e.dispose.bind(e),i=Al.create(()=>{let s=t.indexOf(e);s!==-1&&t.splice(s,1),this.checkDisposed()});return e.dispose=()=>{i.dispose(),e.dispose=n,n()},i}pushAll(e){return e.map(t=>this.push(t))}},_a;(function(r){function e(n){return!!(n&&n.push)}r.canPush=e;function t(n){return!!(n&&n.add)}r.canAdd=t})(_a||(_a={}));var th;(function(r){let e={dispose(){}};function t(d){let{maxListeners:f}=d;return typeof f=="number"?f:0}r.getMaxListeners=t;function n(d,f){return typeof d.maxListeners=="number"?d.maxListeners=f:f}r.setMaxListeners=n;function i(d,f){return typeof d.maxListeners=="number"?d.maxListeners+=f:f}r.addMaxListeners=i,r.None=Object.assign(function(){return e},{get maxListeners(){return 0},set maxListeners(d){}});function s(d){return(f,h=void 0,m)=>{let g=!1,y;return y=d(b=>{if(!g)return y?y.dispose():g=!0,f.call(h,b)},void 0,m),g&&y.dispose(),y}}r.once=s;function o(d){return new Promise(f=>s(d)(f))}r.toPromise=o;function l(d,f){return Object.assign((h,m,g)=>d(y=>h.call(m,f(y)),void 0,g),{get maxListeners(){return 0},set maxListeners(h){}})}r.map=l;function u(...d){return(f,h=void 0,m)=>new cs(...d.map(g=>g(y=>f.call(h,y),void 0,m)))}r.any=u})(th||(th={}));var rh=class{_callbacks;_contexts;get length(){return this._callbacks&&this._callbacks.length||0}add(e,t=void 0,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=void 0){if(!this._callbacks)return;let n=!1;for(let i=0;i<this._callbacks.length;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else n=!0;if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}[Symbol.iterator](){if(!this._callbacks)return[][Symbol.iterator]();let e=this._callbacks.slice(0),t=this._contexts.slice(0);return e.map((n,i)=>(...s)=>n.apply(t[i],s))[Symbol.iterator]()}invoke(...e){let t=[];for(let n of this)try{t.push(n(...e))}catch(i){console.error(i)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},ir=class r{_options;static LEAK_WARNING_THRESHHOLD=175;static _noop=function(){};_event;_callbacks;_disposed=!1;_leakingStacks;_leakWarnCountdown=0;constructor(e){this._options=e}get event(){return this._event||(this._event=Object.assign((e,t,n)=>{this._callbacks||(this._callbacks=new rh),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i=this.checkMaxListeners(th.getMaxListeners(this._event)),s={dispose:()=>{i&&i(),s.dispose=r._noop,this._disposed||(this._callbacks.remove(e,t),s.dispose=r._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return _a.canPush(n)?n.push(s):_a.canAdd(n)&&n.add(s),s},{maxListeners:r.LEAK_WARNING_THRESHHOLD})),this._event}checkMaxListeners(e){if(e===0||!this._callbacks)return;let t=this._callbacks.length;if(t<=e)return;let n=this.pushLeakingStack();if(this._leakWarnCountdown-=1,this._leakWarnCountdown<=0){this._leakWarnCountdown=e*.5;let i,s=0;this._leakingStacks.forEach((o,l)=>{(!i||s<o)&&(i=l,s=o)}),console.warn(`Possible Emitter memory leak detected. ${t} listeners added. Use event.maxListeners to increase the limit (${e}). MOST frequent listener (${s}):`),console.warn(i)}return n}pushLeakingStack(){this._leakingStacks||(this._leakingStacks=new Map);let e=new Error().stack.split(`
`).slice(3).join(`
`),t=this._leakingStacks.get(e)||0;return this._leakingStacks.set(e,t+1),()=>this.popLeakingStack(e)}popLeakingStack(e){if(!this._leakingStacks)return;let t=this._leakingStacks.get(e)||0;this._leakingStacks.set(e,t-1)}fire(e){if(this._callbacks)return this._callbacks.invoke(e)}async sequence(e){if(this._callbacks){for(let t of this._callbacks)if(!await e(t))break}}dispose(){this._leakingStacks&&(this._leakingStacks.clear(),this._leakingStacks=void 0),this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0),this._disposed=!0}};var Vr=class{resolve;reject;promise=new Promise((e,t)=>{this.resolve=n=>(e(n),this),this.reject=n=>(t(n),this)})};var ih;try{ih=new TextDecoder}catch{}var G,or,_=0;var ch=[],us=ch,Sa=0,Ve={},De,Fn,sr=0,Tr=0,ut,Nn,Ht=[],Ie,xw={useRecords:!1,mapsAsObjects:!0},xa=class{},lh=new xa;lh.name="MessagePack 0xC1";var yi=!1,Ow=2,sh,oh,ah;try{new Function("")}catch{Ow=1/0}var wi=class r{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.sequential&&e.trusted!==!1&&(e.trusted=!0,!e.structures&&e.useRecords!=!1&&(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,t){if(G)return $w(()=>(Dl(),this?this.unpack(e,t):r.prototype.unpack.call(xw,e,t)));!e.buffer&&e.constructor===ArrayBuffer&&(e=typeof Buffer<"u"?Buffer.from(e):new Uint8Array(e)),typeof t=="object"?(or=t.end||e.length,_=t.start||0):(_=0,or=t>-1?t:e.length),Sa=0,Tr=0,Fn=null,us=ch,ut=null,G=e;try{Ie=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(n){throw G=null,e instanceof Uint8Array?n:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof r){if(Ve=this,this.structures)return De=this.structures,Il(t);(!De||De.length>0)&&(De=[])}else Ve=xw,(!De||De.length>0)&&(De=[]);return Il(t)}unpackMultiple(e,t){let n,i=0;try{yi=!0;let s=e.length,o=this?this.unpack(e,s):Pl.unpack(e,s);if(t){if(t(o,i,_)===!1)return;for(;_<s;)if(i=_,t(Il(),i,_)===!1)return}else{for(n=[o];_<s;)i=_,n.push(Il());return n}}catch(s){throw s.lastPosition=i,s.values=n,s}finally{yi=!1,Dl()}}_mergeStructures(e,t){oh&&(e=oh.call(this,e)),e=e||[],Object.isFrozen(e)&&(e=e.map(n=>n.slice(0)));for(let n=0,i=e.length;n<i;n++){let s=e[n];s&&(s.isShared=!0,n>=32&&(s.highByte=n-32>>5))}e.sharedLength=e.length;for(let n in t||[])if(n>=0){let i=e[n],s=t[n];s&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[n]=i),e[n]=s)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function Il(r){try{if(!Ve.trusted&&!yi){let t=De.sharedLength||0;t<De.length&&(De.length=t)}let e;if(Ve.randomAccessStructure&&G[_]<64&&G[_]>=32&&sh?(e=sh(G,_,or,Ve),G=null,!(r&&r.lazy)&&e&&(e=e.toJSON()),_=or):e=it(),ut&&(_=ut.postBundlePosition,ut=null),yi&&(De.restoreStructures=null),_==or)De&&De.restoreStructures&&Ew(),De=null,G=null,Nn&&(Nn=null);else{if(_>or)throw new Error("Unexpected end of MessagePack data");if(!yi){let t;try{t=JSON.stringify(e,(n,i)=>typeof i=="bigint"?`${i}n`:i).slice(0,100)}catch(n){t="(JSON view not available "+n+")"}throw new Error("Data read, but end of buffer not reached "+t)}}return e}catch(e){throw De&&De.restoreStructures&&Ew(),Dl(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||_>or)&&(e.incomplete=!0),e}}function Ew(){for(let r in De.restoreStructures)De[r]=De.restoreStructures[r];De.restoreStructures=null}function it(){let r=G[_++];if(r<160)if(r<128){if(r<64)return r;{let e=De[r&63]||Ve.getStructures&&Dw()[r&63];return e?(e.read||(e.read=uh(e,r&63)),e.read()):r}}else if(r<144)if(r-=128,Ve.mapsAsObjects){let e={};for(let t=0;t<r;t++){let n=qw();n==="__proto__"&&(n="__proto_"),e[n]=it()}return e}else{let e=new Map;for(let t=0;t<r;t++)e.set(it(),it());return e}else{r-=144;let e=new Array(r);for(let t=0;t<r;t++)e[t]=it();return Ve.freezeData?Object.freeze(e):e}else if(r<192){let e=r-160;if(Tr>=_)return Fn.slice(_-sr,(_+=e)-sr);if(Tr==0&&or<140){let t=e<16?fh(e):Mw(e);if(t!=null)return t}return Ol(e)}else{let e;switch(r){case 192:return null;case 193:return ut?(e=it(),e>0?ut[1].slice(ut.position1,ut.position1+=e):ut[0].slice(ut.position0,ut.position0-=e)):lh;case 194:return!1;case 195:return!0;case 196:if(e=G[_++],e===void 0)throw new Error("Unexpected end of buffer");return nh(e);case 197:return e=Ie.getUint16(_),_+=2,nh(e);case 198:return e=Ie.getUint32(_),_+=4,nh(e);case 199:return ls(G[_++]);case 200:return e=Ie.getUint16(_),_+=2,ls(e);case 201:return e=Ie.getUint32(_),_+=4,ls(e);case 202:if(e=Ie.getFloat32(_),Ve.useFloat32>2){let t=ds[(G[_]&127)<<1|G[_+1]>>7];return _+=4,(t*e+(e>0?.5:-.5)>>0)/t}return _+=4,e;case 203:return e=Ie.getFloat64(_),_+=8,e;case 204:return G[_++];case 205:return e=Ie.getUint16(_),_+=2,e;case 206:return e=Ie.getUint32(_),_+=4,e;case 207:return Ve.int64AsType==="number"?(e=Ie.getUint32(_)*4294967296,e+=Ie.getUint32(_+4)):Ve.int64AsType==="string"?e=Ie.getBigUint64(_).toString():Ve.int64AsType==="auto"?(e=Ie.getBigUint64(_),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=Ie.getBigUint64(_),_+=8,e;case 208:return Ie.getInt8(_++);case 209:return e=Ie.getInt16(_),_+=2,e;case 210:return e=Ie.getInt32(_),_+=4,e;case 211:return Ve.int64AsType==="number"?(e=Ie.getInt32(_)*4294967296,e+=Ie.getUint32(_+4)):Ve.int64AsType==="string"?e=Ie.getBigInt64(_).toString():Ve.int64AsType==="auto"?(e=Ie.getBigInt64(_),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=Ie.getBigInt64(_),_+=8,e;case 212:if(e=G[_++],e==114)return Iw(G[_++]&63);{let t=Ht[e];if(t)return t.read?(_++,t.read(it())):t.noBuffer?(_++,t()):t(G.subarray(_,++_));throw new Error("Unknown extension "+e)}case 213:return e=G[_],e==114?(_++,Iw(G[_++]&63,G[_++])):ls(2);case 214:return ls(4);case 215:return ls(8);case 216:return ls(16);case 217:return e=G[_++],Tr>=_?Fn.slice(_-sr,(_+=e)-sr):Pw(e);case 218:return e=Ie.getUint16(_),_+=2,Tr>=_?Fn.slice(_-sr,(_+=e)-sr):Uw(e);case 219:return e=Ie.getUint32(_),_+=4,Tr>=_?Fn.slice(_-sr,(_+=e)-sr):Lw(e);case 220:return e=Ie.getUint16(_),_+=2,kw(e);case 221:return e=Ie.getUint32(_),_+=4,kw(e);case 222:return e=Ie.getUint16(_),_+=2,Tw(e);case 223:return e=Ie.getUint32(_),_+=4,Tw(e);default:if(r>=224)return r-256;if(r===void 0){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+r)}}}var J1=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function uh(r,e){function t(){if(t.count++>Ow){let i=r.read=new Function("r","return function(){return "+(Ve.freezeData?"Object.freeze":"")+"({"+r.map(s=>s==="__proto__"?"__proto_:r()":J1.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"})}")(it);return r.highByte===0&&(r.read=Cw(e,r.read)),i()}let n={};for(let i=0,s=r.length;i<s;i++){let o=r[i];o==="__proto__"&&(o="__proto_"),n[o]=it()}return Ve.freezeData?Object.freeze(n):n}return t.count=0,r.highByte===0?Cw(e,t):t}var Cw=(r,e)=>function(){let t=G[_++];if(t===0)return e();let n=r<32?-(r+(t<<5)):r+(t<<5),i=De[n]||Dw()[n];if(!i)throw new Error("Record id is not defined for "+n);return i.read||(i.read=uh(i,r)),i.read()};function Dw(){let r=$w(()=>(G=null,Ve.getStructures()));return De=Ve._mergeStructures(r,De)}var Ol=fs,Pw=fs,Uw=fs,Lw=fs,Fw=!1;function Nw(r){Fw=!0,Ol=e(1),Pw=e(2),Uw=e(3),Lw=e(5);function e(t){return function(i){let s=us[Sa++];if(s==null){if(ut)return fs(i);let l=G.byteOffset,u=r(_-t+l,or+l,G.buffer);if(typeof u=="string")s=u,us=ch;else if(us=u,Sa=1,Tr=1,s=us[0],s===void 0)throw new Error("Unexpected end of buffer")}let o=s.length;return o<=i?(_+=i,s):(Fn=s,sr=_,Tr=_+o,_+=i,s.slice(0,i))}}}function fs(r){let e;if(r<16&&(e=fh(r)))return e;if(r>64&&ih)return ih.decode(G.subarray(_,_+=r));let t=_+r,n=[];for(e="";_<t;){let i=G[_++];if((i&128)===0)n.push(i);else if((i&224)===192){let s=G[_++]&63;n.push((i&31)<<6|s)}else if((i&240)===224){let s=G[_++]&63,o=G[_++]&63;n.push((i&31)<<12|s<<6|o)}else if((i&248)===240){let s=G[_++]&63,o=G[_++]&63,l=G[_++]&63,u=(i&7)<<18|s<<12|o<<6|l;u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|u&1023),n.push(u)}else n.push(i);n.length>=4096&&(e+=gt.apply(String,n),n.length=0)}return n.length>0&&(e+=gt.apply(String,n)),e}function Bw(r,e,t){let n=G;G=r,_=e;try{return fs(t)}finally{G=n}}function kw(r){let e=new Array(r);for(let t=0;t<r;t++)e[t]=it();return Ve.freezeData?Object.freeze(e):e}function Tw(r){if(Ve.mapsAsObjects){let e={};for(let t=0;t<r;t++){let n=qw();n==="__proto__"&&(n="__proto_"),e[n]=it()}return e}else{let e=new Map;for(let t=0;t<r;t++)e.set(it(),it());return e}}var gt=String.fromCharCode;function Mw(r){let e=_,t=new Array(r);for(let n=0;n<r;n++){let i=G[_++];if((i&128)>0){_=e;return}t[n]=i}return gt.apply(String,t)}function fh(r){if(r<4)if(r<2){if(r===0)return"";{let e=G[_++];if((e&128)>1){_-=1;return}return gt(e)}}else{let e=G[_++],t=G[_++];if((e&128)>0||(t&128)>0){_-=2;return}if(r<3)return gt(e,t);let n=G[_++];if((n&128)>0){_-=3;return}return gt(e,t,n)}else{let e=G[_++],t=G[_++],n=G[_++],i=G[_++];if((e&128)>0||(t&128)>0||(n&128)>0||(i&128)>0){_-=4;return}if(r<6){if(r===4)return gt(e,t,n,i);{let s=G[_++];if((s&128)>0){_-=5;return}return gt(e,t,n,i,s)}}else if(r<8){let s=G[_++],o=G[_++];if((s&128)>0||(o&128)>0){_-=6;return}if(r<7)return gt(e,t,n,i,s,o);let l=G[_++];if((l&128)>0){_-=7;return}return gt(e,t,n,i,s,o,l)}else{let s=G[_++],o=G[_++],l=G[_++],u=G[_++];if((s&128)>0||(o&128)>0||(l&128)>0||(u&128)>0){_-=8;return}if(r<10){if(r===8)return gt(e,t,n,i,s,o,l,u);{let d=G[_++];if((d&128)>0){_-=9;return}return gt(e,t,n,i,s,o,l,u,d)}}else if(r<12){let d=G[_++],f=G[_++];if((d&128)>0||(f&128)>0){_-=10;return}if(r<11)return gt(e,t,n,i,s,o,l,u,d,f);let h=G[_++];if((h&128)>0){_-=11;return}return gt(e,t,n,i,s,o,l,u,d,f,h)}else{let d=G[_++],f=G[_++],h=G[_++],m=G[_++];if((d&128)>0||(f&128)>0||(h&128)>0||(m&128)>0){_-=12;return}if(r<14){if(r===12)return gt(e,t,n,i,s,o,l,u,d,f,h,m);{let g=G[_++];if((g&128)>0){_-=13;return}return gt(e,t,n,i,s,o,l,u,d,f,h,m,g)}}else{let g=G[_++],y=G[_++];if((g&128)>0||(y&128)>0){_-=14;return}if(r<15)return gt(e,t,n,i,s,o,l,u,d,f,h,m,g,y);let b=G[_++];if((b&128)>0){_-=15;return}return gt(e,t,n,i,s,o,l,u,d,f,h,m,g,y,b)}}}}}function Rw(){let r=G[_++],e;if(r<192)e=r-160;else switch(r){case 217:e=G[_++];break;case 218:e=Ie.getUint16(_),_+=2;break;case 219:e=Ie.getUint32(_),_+=4;break;default:throw new Error("Expected string")}return fs(e)}function nh(r){return Ve.copyBuffers?Uint8Array.prototype.slice.call(G,_,_+=r):G.subarray(_,_+=r)}function ls(r){let e=G[_++];if(Ht[e]){let t;return Ht[e](G.subarray(_,t=_+=r),n=>{_=n;try{return it()}finally{_=t}})}else throw new Error("Unknown extension type "+e)}var Aw=new Array(4096);function qw(){let r=G[_++];if(r>=160&&r<192){if(r=r-160,Tr>=_)return Fn.slice(_-sr,(_+=r)-sr);if(!(Tr==0&&or<180))return Ol(r)}else return _--,jw(it());let e=(r<<5^(r>1?Ie.getUint16(_):r>0?G[_]:0))&4095,t=Aw[e],n=_,i=_+r-3,s,o=0;if(t&&t.bytes==r){for(;n<i;){if(s=Ie.getUint32(n),s!=t[o++]){n=1879048192;break}n+=4}for(i+=3;n<i;)if(s=G[n++],s!=t[o++]){n=1879048192;break}if(n===i)return _=n,t.string;i-=3,n=_}for(t=[],Aw[e]=t,t.bytes=r;n<i;)s=Ie.getUint32(n),t.push(s),n+=4;for(i+=3;n<i;)s=G[n++],t.push(s);let l=r<16?fh(r):Mw(r);return l!=null?t.string=l:t.string=Ol(r)}function jw(r){if(typeof r=="string")return r;if(typeof r=="number"||typeof r=="boolean"||typeof r=="bigint")return r.toString();if(r==null)return r+"";throw new Error("Invalid property type for record",typeof r)}var Iw=(r,e)=>{let t=it().map(jw),n=r;e!==void 0&&(r=r<32?-((e<<5)+r):(e<<5)+r,t.highByte=e);let i=De[r];return i&&(i.isShared||yi)&&((De.restoreStructures||(De.restoreStructures=[]))[r]=i),De[r]=t,t.read=uh(t,n),t.read()};Ht[0]=()=>{};Ht[0].noBuffer=!0;Ht[66]=r=>{let e=r.length,t=BigInt(r[0]&128?r[0]-256:r[0]);for(let n=1;n<e;n++)t<<=BigInt(8),t+=BigInt(r[n]);return t};var Q1={Error,TypeError,ReferenceError};Ht[101]=()=>{let r=it();return(Q1[r[0]]||Error)(r[1],{cause:r[2]})};Ht[105]=r=>{if(Ve.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=Ie.getUint32(_-4);Nn||(Nn=new Map);let t=G[_],n;t>=144&&t<160||t==220||t==221?n=[]:n={};let i={target:n};Nn.set(e,i);let s=it();return i.used?Object.assign(n,s):(i.target=s,s)};Ht[112]=r=>{if(Ve.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=Ie.getUint32(_-4),t=Nn.get(e);return t.used=!0,t.target};Ht[115]=()=>new Set(it());var dh=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(r=>r+"Array"),X1=typeof globalThis=="object"?globalThis:window;Ht[116]=r=>{let e=r[0],t=dh[e];if(!t){if(e===16){let n=new ArrayBuffer(r.length-1);return new Uint8Array(n).set(r.subarray(1)),n}throw new Error("Could not find typed array for code "+e)}return new X1[t](Uint8Array.prototype.slice.call(r,1).buffer)};Ht[120]=()=>{let r=it();return new RegExp(r[0],r[1])};var Z1=[];Ht[98]=r=>{let e=(r[0]<<24)+(r[1]<<16)+(r[2]<<8)+r[3],t=_;return _+=e-r.length,ut=Z1,ut=[Rw(),Rw()],ut.position0=0,ut.position1=0,ut.postBundlePosition=_,_=t,it()};Ht[255]=r=>r.length==4?new Date((r[0]*16777216+(r[1]<<16)+(r[2]<<8)+r[3])*1e3):r.length==8?new Date(((r[0]<<22)+(r[1]<<14)+(r[2]<<6)+(r[3]>>2))/1e6+((r[3]&3)*4294967296+r[4]*16777216+(r[5]<<16)+(r[6]<<8)+r[7])*1e3):r.length==12?new Date(((r[0]<<24)+(r[1]<<16)+(r[2]<<8)+r[3])/1e6+((r[4]&128?-281474976710656:0)+r[6]*1099511627776+r[7]*4294967296+r[8]*16777216+(r[9]<<16)+(r[10]<<8)+r[11])*1e3):new Date("invalid");function $w(r){ah&&ah();let e=or,t=_,n=Sa,i=sr,s=Tr,o=Fn,l=us,u=Nn,d=ut,f=new Uint8Array(G.slice(0,or)),h=De,m=De.slice(0,De.length),g=Ve,y=yi,b=r();return or=e,_=t,Sa=n,sr=i,Tr=s,Fn=o,us=l,Nn=u,ut=d,G=f,yi=y,De=h,De.splice(0,De.length,...m),Ve=g,Ie=new DataView(G.buffer,G.byteOffset,G.byteLength),b}function Dl(){G=null,Nn=null,De=null}var ds=new Array(147);for(let r=0;r<256;r++)ds[r]=+("1e"+Math.floor(45.15-r*.30103));var Pl=new wi({useRecords:!1}),eI=Pl.unpack,tI=Pl.unpackMultiple,hh=Pl.unpack,Ul={NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4},rI=new Float32Array(1),h2=new Uint8Array(rI.buffer,0,4);function Vw(r,e,t){sh=r,oh=e,ah=t}var Fl;try{Fl=new TextEncoder}catch{}var ph,Yw,Nl=typeof Buffer<"u",Ll=Nl?function(r){return Buffer.allocUnsafeSlow(r)}:Uint8Array,Kw=Nl?Buffer:Uint8Array,Ww=Nl?4294967296:2144337920,T,Ea,We,x=0,Ft,Ze=null,Jw,nI=21760,iI=/[\u0080-\uFFFF]/,fn=Symbol("record-id"),so=class extends wi{constructor(e){super(e),this.offset=0;let t,n,i,s,o,l=Kw.prototype.utf8Write?function(S,$){return T.utf8Write(S,$,T.byteLength-$)}:Fl&&Fl.encodeInto?function(S,$){return Fl.encodeInto(S,T.subarray($)).written}:!1,u=this;e||(e={});let d=e&&e.sequential,f=e.structures||e.saveStructures,h=e.maxSharedStructures;if(h==null&&(h=f?32:0),h>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&e.moreTypes==null&&(this.moreTypes=!0);let m=e.maxOwnStructures;m==null&&(m=f?32:64),!this.structures&&e.useRecords!=!1&&(this.structures=[]);let g=h>32||m+h>64,y=h+64,b=h+m+64;if(b>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let C=[],L=0,j=0;this.pack=this.encode=function(S,$){if(T||(T=new Ll(8192),We=T.dataView||(T.dataView=new DataView(T.buffer,0,8192)),x=0),Ft=T.length-10,Ft-x<2048?(T=new Ll(T.length),We=T.dataView||(T.dataView=new DataView(T.buffer,0,T.length)),Ft=T.length-10,x=0):x=x+7&2147483640,n=x,$&pI&&(x+=$&255),o=u.structuredClone?new Map:null,u.bundleStrings&&typeof S!="string"?(Ze=[],Ze.size=1/0):Ze=null,s=u.structures,s){s.uninitialized&&(s=u._mergeStructures(u.getStructures()));let F=s.sharedLength||0;if(F>h)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+s.sharedLength);if(!s.transitions){s.transitions=Object.create(null);for(let V=0;V<F;V++){let X=s[V];if(!X)continue;let me,oe=s.transitions;for(let z=0,ce=X.length;z<ce;z++){let ue=X[z];me=oe[ue],me||(me=oe[ue]=Object.create(null)),oe=me}oe[fn]=V+64}this.lastNamedStructuresLength=F}d||(s.nextId=F+64)}i&&(i=!1);let q;try{u.randomAccessStructure&&S&&S.constructor&&S.constructor===Object?pe(S):N(S);let F=Ze;if(Ze&&Gw(n,N,0),o&&o.idsToInsert){let V=o.idsToInsert.sort((z,ce)=>z.offset>ce.offset?1:-1),X=V.length,me=-1;for(;F&&X>0;){let z=V[--X].offset+n;z<F.stringsPosition+n&&me===-1&&(me=0),z>F.position+n?me>=0&&(me+=6):(me>=0&&(We.setUint32(F.position+n,We.getUint32(F.position+n)+me),me=-1),F=F.previous,X++)}me>=0&&F&&We.setUint32(F.position+n,We.getUint32(F.position+n)+me),x+=V.length*6,x>Ft&&Q(x),u.offset=x;let oe=oI(T.subarray(n,x),V);return o=null,oe}return u.offset=x,$&dI?(T.start=n,T.end=x,T):T.subarray(n,x)}catch(F){throw q=F,F}finally{if(s&&(O(),i&&u.saveStructures)){let F=s.sharedLength||0,V=T.subarray(n,x),X=Qw(s,u);if(!q)return u.saveStructures(X,X.isCompatible)===!1?u.pack(S,$):(u.lastNamedStructuresLength=F,T.length>1073741824&&(T=null),V)}T.length>1073741824&&(T=null),$&hI&&(x=n)}};let O=()=>{j<10&&j++;let S=s.sharedLength||0;if(s.length>S&&!d&&(s.length=S),L>1e4)s.transitions=null,j=0,L=0,C.length>0&&(C=[]);else if(C.length>0&&!d){for(let $=0,q=C.length;$<q;$++)C[$][fn]=0;C=[]}},D=S=>{var $=S.length;$<16?T[x++]=144|$:$<65536?(T[x++]=220,T[x++]=$>>8,T[x++]=$&255):(T[x++]=221,We.setUint32(x,$),x+=4);for(let q=0;q<$;q++)N(S[q])},N=S=>{x>Ft&&(T=Q(x));var $=typeof S,q;if($==="string"){let F=S.length;if(Ze&&F>=4&&F<4096){if((Ze.size+=F)>nI){let oe,z=(Ze[0]?Ze[0].length*3+Ze[1].length:0)+10;x+z>Ft&&(T=Q(x+z));let ce;Ze.position?(ce=Ze,T[x]=200,x+=3,T[x++]=98,oe=x-n,x+=4,Gw(n,N,0),We.setUint16(oe+n-3,x-n-oe)):(T[x++]=214,T[x++]=98,oe=x-n,x+=4),Ze=["",""],Ze.previous=ce,Ze.size=0,Ze.position=oe}let me=iI.test(S);Ze[me?0:1]+=S,T[x++]=193,N(me?-F:F);return}let V;F<32?V=1:F<256?V=2:F<65536?V=3:V=5;let X=F*3;if(x+X>Ft&&(T=Q(x+X)),F<64||!l){let me,oe,z,ce=x+V;for(me=0;me<F;me++)oe=S.charCodeAt(me),oe<128?T[ce++]=oe:oe<2048?(T[ce++]=oe>>6|192,T[ce++]=oe&63|128):(oe&64512)===55296&&((z=S.charCodeAt(me+1))&64512)===56320?(oe=65536+((oe&1023)<<10)+(z&1023),me++,T[ce++]=oe>>18|240,T[ce++]=oe>>12&63|128,T[ce++]=oe>>6&63|128,T[ce++]=oe&63|128):(T[ce++]=oe>>12|224,T[ce++]=oe>>6&63|128,T[ce++]=oe&63|128);q=ce-x-V}else q=l(S,x+V);q<32?T[x++]=160|q:q<256?(V<2&&T.copyWithin(x+2,x+1,x+1+q),T[x++]=217,T[x++]=q):q<65536?(V<3&&T.copyWithin(x+3,x+2,x+2+q),T[x++]=218,T[x++]=q>>8,T[x++]=q&255):(V<5&&T.copyWithin(x+5,x+3,x+3+q),T[x++]=219,We.setUint32(x,q),x+=4),x+=q}else if($==="number")if(S>>>0===S)S<32||S<128&&this.useRecords===!1||S<64&&!this.randomAccessStructure?T[x++]=S:S<256?(T[x++]=204,T[x++]=S):S<65536?(T[x++]=205,T[x++]=S>>8,T[x++]=S&255):(T[x++]=206,We.setUint32(x,S),x+=4);else if(S>>0===S)S>=-32?T[x++]=256+S:S>=-128?(T[x++]=208,T[x++]=S+256):S>=-32768?(T[x++]=209,We.setInt16(x,S),x+=2):(T[x++]=210,We.setInt32(x,S),x+=4);else{let F;if((F=this.useFloat32)>0&&S<4294967296&&S>=-2147483648){T[x++]=202,We.setFloat32(x,S);let V;if(F<4||(V=S*ds[(T[x]&127)<<1|T[x+1]>>7])>>0===V){x+=4;return}else x--}T[x++]=203,We.setFloat64(x,S),x+=8}else if($==="object"||$==="function")if(!S)T[x++]=192;else{if(o){let V=o.get(S);if(V){if(!V.id){let X=o.idsToInsert||(o.idsToInsert=[]);V.id=X.push(V)}T[x++]=214,T[x++]=112,We.setUint32(x,V.id),x+=4;return}else o.set(S,{offset:x-n})}let F=S.constructor;if(F===Object)M(S);else if(F===Array)D(S);else if(F===Map)if(this.mapAsEmptyObject)T[x++]=128;else{q=S.size,q<16?T[x++]=128|q:q<65536?(T[x++]=222,T[x++]=q>>8,T[x++]=q&255):(T[x++]=223,We.setUint32(x,q),x+=4);for(let[V,X]of S)N(V),N(X)}else{for(let V=0,X=ph.length;V<X;V++){let me=Yw[V];if(S instanceof me){let oe=ph[V];if(oe.write){oe.type&&(T[x++]=212,T[x++]=oe.type,T[x++]=0);let Ue=oe.write.call(this,S);Ue===S?Array.isArray(S)?D(S):M(S):N(Ue);return}let z=T,ce=We,ue=x;T=null;let J;try{J=oe.pack.call(this,S,Ue=>(T=z,z=null,x+=Ue,x>Ft&&Q(x),{target:T,targetView:We,position:x-Ue}),N)}finally{z&&(T=z,We=ce,x=ue,Ft=T.length-10)}J&&(J.length+x>Ft&&Q(J.length+x),x=sI(J,T,x,oe.type));return}}if(Array.isArray(S))D(S);else{if(S.toJSON){let V=S.toJSON();if(V!==S)return N(V)}if($==="function")return N(this.writeFunction&&this.writeFunction(S));M(S)}}}else if($==="boolean")T[x++]=S?195:194;else if($==="bigint"){if(S<BigInt(1)<<BigInt(63)&&S>=-(BigInt(1)<<BigInt(63)))T[x++]=211,We.setBigInt64(x,S);else if(S<BigInt(1)<<BigInt(64)&&S>0)T[x++]=207,We.setBigUint64(x,S);else if(this.largeBigIntToFloat)T[x++]=203,We.setFloat64(x,Number(S));else{if(this.largeBigIntToString)return N(S.toString());if(this.useBigIntExtension&&S<BigInt(2)**BigInt(1023)&&S>-(BigInt(2)**BigInt(1023))){T[x++]=199,x++,T[x++]=66;let F=[],V;do{let X=S&BigInt(255);V=(X&BigInt(128))===(S<BigInt(0)?BigInt(128):BigInt(0)),F.push(X),S>>=BigInt(8)}while(!((S===BigInt(0)||S===BigInt(-1))&&V));T[x-2]=F.length;for(let X=F.length;X>0;)T[x++]=Number(F[--X]);return}else throw new RangeError(S+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}x+=8}else if($==="undefined")this.encodeUndefinedAsNil?T[x++]=192:(T[x++]=212,T[x++]=0,T[x++]=0);else throw new Error("Unknown type: "+$)},k=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?S=>{let $;if(this.skipValues){$=[];for(let V in S)(typeof S.hasOwnProperty!="function"||S.hasOwnProperty(V))&&!this.skipValues.includes(S[V])&&$.push(V)}else $=Object.keys(S);let q=$.length;q<16?T[x++]=128|q:q<65536?(T[x++]=222,T[x++]=q>>8,T[x++]=q&255):(T[x++]=223,We.setUint32(x,q),x+=4);let F;if(this.coercibleKeyAsNumber)for(let V=0;V<q;V++){F=$[V];let X=Number(F);N(isNaN(X)?F:X),N(S[F])}else for(let V=0;V<q;V++)N(F=$[V]),N(S[F])}:S=>{T[x++]=222;let $=x-n;x+=2;let q=0;for(let F in S)(typeof S.hasOwnProperty!="function"||S.hasOwnProperty(F))&&(N(F),N(S[F]),q++);if(q>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');T[$+++n]=q>>8,T[$+n]=q&255},P=this.useRecords===!1?k:e.progressiveRecords&&!g?S=>{let $,q=s.transitions||(s.transitions=Object.create(null)),F=x++-n,V;for(let X in S)if(typeof S.hasOwnProperty!="function"||S.hasOwnProperty(X)){if($=q[X],$)q=$;else{let me=Object.keys(S),oe=q;q=s.transitions;let z=0;for(let ce=0,ue=me.length;ce<ue;ce++){let J=me[ce];$=q[J],$||($=q[J]=Object.create(null),z++),q=$}F+n+1==x?(x--,te(q,me,z)):he(q,me,F,z),V=!0,q=oe[X]}N(S[X])}if(!V){let X=q[fn];X?T[F+n]=X:he(q,Object.keys(S),F,0)}}:S=>{let $,q=s.transitions||(s.transitions=Object.create(null)),F=0;for(let X in S)(typeof S.hasOwnProperty!="function"||S.hasOwnProperty(X))&&($=q[X],$||($=q[X]=Object.create(null),F++),q=$);let V=q[fn];V?V>=96&&g?(T[x++]=((V-=96)&31)+96,T[x++]=V>>5):T[x++]=V:te(q,q.__keys__||Object.keys(S),F);for(let X in S)(typeof S.hasOwnProperty!="function"||S.hasOwnProperty(X))&&N(S[X])},R=typeof this.useRecords=="function"&&this.useRecords,M=R?S=>{R(S)?P(S):k(S)}:P,Q=S=>{let $;if(S>16777216){if(S-n>Ww)throw new Error("Packed buffer would be larger than maximum buffer size");$=Math.min(Ww,Math.round(Math.max((S-n)*(S>67108864?1.25:2),4194304)/4096)*4096)}else $=(Math.max(S-n<<2,T.length-1)>>12)+1<<12;let q=new Ll($);return We=q.dataView||(q.dataView=new DataView(q.buffer,0,$)),S=Math.min(S,T.length),T.copy?T.copy(q,0,n,S):q.set(T.slice(n,S)),x-=n,n=0,Ft=q.length-10,T=q},te=(S,$,q)=>{let F=s.nextId;F||(F=64),F<y&&this.shouldShareStructure&&!this.shouldShareStructure($)?(F=s.nextOwnId,F<b||(F=y),s.nextOwnId=F+1):(F>=b&&(F=y),s.nextId=F+1);let V=$.highByte=F>=96&&g?F-96>>5:-1;S[fn]=F,S.__keys__=$,s[F-64]=$,F<y?($.isShared=!0,s.sharedLength=F-63,i=!0,V>=0?(T[x++]=(F&31)+96,T[x++]=V):T[x++]=F):(V>=0?(T[x++]=213,T[x++]=114,T[x++]=(F&31)+96,T[x++]=V):(T[x++]=212,T[x++]=114,T[x++]=F),q&&(L+=j*q),C.length>=m&&(C.shift()[fn]=0),C.push(S),N($))},he=(S,$,q,F)=>{let V=T,X=x,me=Ft,oe=n;T=Ea,x=0,n=0,T||(Ea=T=new Ll(8192)),Ft=T.length-10,te(S,$,F),Ea=T;let z=x;if(T=V,x=X,Ft=me,n=oe,z>1){let ce=x+z-1;ce>Ft&&Q(ce);let ue=q+n;T.copyWithin(ue+z,ue+1,x),T.set(Ea.slice(0,z),ue),x=ce}else T[q+n]=Ea[0]},pe=S=>{let $=Jw(S,T,n,x,s,Q,(q,F,V)=>{if(V)return i=!0;x=F;let X=T;return N(q),O(),X!==T?{position:x,targetView:We,target:T}:x},this);if($===0)return M(S);x=$}}useBuffer(e){T=e,T.dataView||(T.dataView=new DataView(T.buffer,T.byteOffset,T.byteLength)),x=0}set position(e){x=e}get position(){return x}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}};Yw=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,xa];ph=[{pack(r,e,t){let n=r.getTime()/1e3;if((this.useTimestamp32||r.getMilliseconds()===0)&&n>=0&&n<4294967296){let{target:i,targetView:s,position:o}=e(6);i[o++]=214,i[o++]=255,s.setUint32(o,n)}else if(n>0&&n<4294967296){let{target:i,targetView:s,position:o}=e(10);i[o++]=215,i[o++]=255,s.setUint32(o,r.getMilliseconds()*4e6+(n/1e3/4294967296>>0)),s.setUint32(o+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return e(0),t(this.onInvalidDate());let{target:i,targetView:s,position:o}=e(3);i[o++]=212,i[o++]=255,i[o++]=255}else{let{target:i,targetView:s,position:o}=e(15);i[o++]=199,i[o++]=12,i[o++]=255,s.setUint32(o,r.getMilliseconds()*1e6),s.setBigInt64(o+4,BigInt(Math.floor(n)))}}},{pack(r,e,t){if(this.setAsEmptyObject)return e(0),t({});let n=Array.from(r),{target:i,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(i[s++]=212,i[s++]=115,i[s++]=0),t(n)}},{pack(r,e,t){let{target:n,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(n[i++]=212,n[i++]=101,n[i++]=0),t([r.name,r.message,r.cause])}},{pack(r,e,t){let{target:n,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(n[i++]=212,n[i++]=120,n[i++]=0),t([r.source,r.flags])}},{pack(r,e){this.moreTypes?zw(r,16,e):Hw(Nl?Buffer.from(r):new Uint8Array(r),e)}},{pack(r,e){let t=r.constructor;t!==Kw&&this.moreTypes?zw(r,dh.indexOf(t.name),e):Hw(r,e)}},{pack(r,e){let{target:t,position:n}=e(1);t[n]=193}}];function zw(r,e,t,n){let i=r.byteLength;if(i+1<256){var{target:s,position:o}=t(4+i);s[o++]=199,s[o++]=i+1}else if(i+1<65536){var{target:s,position:o}=t(5+i);s[o++]=200,s[o++]=i+1>>8,s[o++]=i+1&255}else{var{target:s,position:o,targetView:l}=t(7+i);s[o++]=201,l.setUint32(o,i+1),o+=4}s[o++]=116,s[o++]=e,r.buffer||(r=new Uint8Array(r)),s.set(new Uint8Array(r.buffer,r.byteOffset,r.byteLength),o)}function Hw(r,e){let t=r.byteLength;var n,i;if(t<256){var{target:n,position:i}=e(t+2);n[i++]=196,n[i++]=t}else if(t<65536){var{target:n,position:i}=e(t+3);n[i++]=197,n[i++]=t>>8,n[i++]=t&255}else{var{target:n,position:i,targetView:s}=e(t+5);n[i++]=198,s.setUint32(i,t),i+=4}n.set(r,i)}function sI(r,e,t,n){let i=r.length;switch(i){case 1:e[t++]=212;break;case 2:e[t++]=213;break;case 4:e[t++]=214;break;case 8:e[t++]=215;break;case 16:e[t++]=216;break;default:i<256?(e[t++]=199,e[t++]=i):i<65536?(e[t++]=200,e[t++]=i>>8,e[t++]=i&255):(e[t++]=201,e[t++]=i>>24,e[t++]=i>>16&255,e[t++]=i>>8&255,e[t++]=i&255)}return e[t++]=n,e.set(r,t),t+=i,t}function oI(r,e){let t,n=e.length*6,i=r.length-n;for(;t=e.pop();){let s=t.offset,o=t.id;r.copyWithin(s+n,s,i),n-=6;let l=s+n;r[l++]=214,r[l++]=105,r[l++]=o>>24,r[l++]=o>>16&255,r[l++]=o>>8&255,r[l++]=o&255,i=s}return r}function Gw(r,e,t){if(Ze.length>0){We.setUint32(Ze.position+r,x+t-Ze.position-r),Ze.stringsPosition=x-r;let n=Ze;Ze=null,e(n[0]),e(n[1])}}function Qw(r,e){return r.isCompatible=t=>{let n=!t||(e.lastNamedStructuresLength||0)===t.length;return n||e._mergeStructures(t),n},r}function Xw(r,e){Jw=r,Qw=e}var Zw=new so({useRecords:!1}),aI=Zw.pack,mh=Zw.pack;var{NEVER:cI,ALWAYS:lI,DECIMAL_ROUND:uI,DECIMAL_FIT:fI}=Ul,dI=512,hI=1024,pI=2048;var gh=3,ao=0,Ca=2,Bl=1,wh=16,tb=["num","object","string","ascii"];tb[wh]="date";var mI=[!1,!0,!0,!1,!1,!0,!0,!1],rb;try{new Function(""),rb=!0}catch{}var hs,gI=typeof Buffer<"u",Ml,dn;try{Ml=new TextEncoder}catch{}var yI=gI?function(r,e,t){return r.utf8Write(e,t,r.byteLength-t)}:Ml&&Ml.encodeInto?function(r,e,t){return Ml.encodeInto(e,r.subarray(t)).written}:!1,x2=Symbol("type"),E2=Symbol("parent");Xw(nb,SI);function nb(r,e,t,n,i,s,o,l){let u=l.typedStructs||(l.typedStructs=[]),d=e.dataView,f=(u.lastStringStart||100)+n,h=e.length-10,m=n;n>h&&(e=s(n),d=e.dataView,n-=t,m-=t,f-=t,t=0,h=e.length-10);let g,y=f,b=u.transitions||(u.transitions=Object.create(null)),C=u.nextId||u.length,L=C<15?1:C<240?2:C<61440?3:C<15728640?4:0;if(L===0)return 0;n+=L;let j=[],O,D=0;for(let k in r){let P=r[k],R=b[k];switch(R||(b[k]=R={key:k,parent:b,enumerationOffset:0,ascii0:null,ascii8:null,num8:null,string16:null,object16:null,num32:null,float64:null,date64:null}),n>h&&(e=s(n),d=e.dataView,n-=t,m-=t,f-=t,y-=t,t=0,h=e.length-10),typeof P){case"number":let M=P;if(C<200||!R.num64){if(M>>0===M&&M<536870912&&M>-520093696){M<246&&M>=0&&(R.num8&&!(C>200&&R.num32)||M<32&&!R.num32)?(b=R.num8||Gt(R,ao,1),e[n++]=M):(b=R.num32||Gt(R,ao,4),d.setUint32(n,M,!0),n+=4);break}else if(M<4294967296&&M>=-2147483648&&(d.setFloat32(n,M,!0),mI[e[n+3]>>>5])){let pe;if((pe=M*ds[(e[n+3]&127)<<1|e[n+2]>>7])>>0===pe){b=R.num32||Gt(R,ao,4),n+=4;break}}}b=R.num64||Gt(R,ao,8),d.setFloat64(n,M,!0),n+=8;break;case"string":let Q=P.length;if(g=y-f,(Q<<2)+y>h&&(e=s((Q<<2)+y),d=e.dataView,n-=t,m-=t,f-=t,y-=t,t=0,h=e.length-10),Q>65280+g>>2){j.push(k,P,n-m);break}let te,he=y;if(Q<64){let pe,S,$;for(pe=0;pe<Q;pe++)S=P.charCodeAt(pe),S<128?e[y++]=S:S<2048?(te=!0,e[y++]=S>>6|192,e[y++]=S&63|128):(S&64512)===55296&&(($=P.charCodeAt(pe+1))&64512)===56320?(te=!0,S=65536+((S&1023)<<10)+($&1023),pe++,e[y++]=S>>18|240,e[y++]=S>>12&63|128,e[y++]=S>>6&63|128,e[y++]=S&63|128):(te=!0,e[y++]=S>>12|224,e[y++]=S>>6&63|128,e[y++]=S&63|128)}else y+=yI(e,P,y),te=y-he>Q;if(g<160||g<246&&(R.ascii8||R.string8)){if(te)(b=R.string8)||(u.length>10&&(b=R.ascii8)?(b.__type=Ca,R.ascii8=null,R.string8=b,o(null,0,!0)):b=Gt(R,Ca,1));else if(g===0&&!O){O=!0,b=R.ascii0||Gt(R,gh,0);break}else!(b=R.ascii8)&&!(u.length>10&&(b=R.string8))&&(b=Gt(R,gh,1));e[n++]=g}else b=R.string16||Gt(R,Ca,2),d.setUint16(n,g,!0),n+=2;break;case"object":if(P){P.constructor===Date?(b=R.date64||Gt(R,wh,8),d.setFloat64(n,P.getTime(),!0),n+=8):j.push(k,P,D);break}else R=eb(R,n,d,-10),R?(b=R,n=hs):j.push(k,P,D);break;case"boolean":b=R.num8||R.ascii8||Gt(R,ao,1),e[n++]=P?249:248;break;case"undefined":R=eb(R,n,d,-9),R?(b=R,n=hs):j.push(k,P,D);break;default:j.push(k,P,D)}D++}for(let k=0,P=j.length;k<P;){let R=j[k++],M=j[k++],Q=j[k++],te=b[R];te||(b[R]=te={key:R,parent:b,enumerationOffset:Q-D,ascii0:null,ascii8:null,num8:null,string16:null,object16:null,num32:null,float64:null});let he;if(M){let pe;g=y-f,g<65280?(b=te.object16,b?pe=2:(b=te.object32)?pe=4:(b=Gt(te,Bl,2),pe=2)):(b=te.object32||Gt(te,Bl,4),pe=4),he=o(M,y),typeof he=="object"?(y=he.position,d=he.targetView,e=he.target,f-=t,n-=t,m-=t,t=0):y=he,pe===2?(d.setUint16(n,g,!0),n+=2):(d.setUint32(n,g,!0),n+=4)}else b=te.object16||Gt(te,Bl,2),d.setInt16(n,M===null?-10:-9,!0),n+=2;D++}let N=b[fn];if(N==null){N=l.typedStructs.length;let k=[],P=b,R,M;for(;(M=P.__type)!==void 0;){let Q=P.__size;P=P.__parent,R=P.key;let te=[M,Q,R];P.enumerationOffset&&te.push(P.enumerationOffset),k.push(te),P=P.parent}k.reverse(),b[fn]=N,l.typedStructs[N]=k,o(null,0,!0)}switch(L){case 1:if(N>=16)return 0;e[m]=N+32;break;case 2:if(N>=256)return 0;e[m]=56,e[m+1]=N;break;case 3:if(N>=65536)return 0;e[m]=57,d.setUint16(m+1,N,!0);break;case 4:if(N>=16777216)return 0;d.setUint32(m,(N<<8)+58,!0);break}if(n<f){if(f===y)return n;e.copyWithin(n,f,y),y+=n-f,u.lastStringStart=n-m}else if(n>f)return f===y?n:(u.lastStringStart=n-m,nb(r,e,t,m,i,s,o,l));return y}function eb(r,e,t,n){let i;if(i=r.ascii8||r.num8)return t.setInt8(e,n,!0),hs=e+1,i;if(i=r.string16||r.object16)return t.setInt16(e,n,!0),hs=e+2,i;if(i=r.num32)return t.setUint32(e,3758096640+n,!0),hs=e+4,i;if(i=r.num64)return t.setFloat64(e,NaN,!0),t.setInt8(e,n),hs=e+8,i;hs=e}function Gt(r,e,t){let n=tb[e]+(t<<3),i=r[n]||(r[n]=Object.create(null));return i.__type=e,i.__size=t,i.__parent=r,i}function wI(r){if(!(r instanceof Map))return r;let e=r.get("typed")||[];Object.isFrozen(e)&&(e=e.map(i=>i.slice(0)));let t=r.get("named"),n=Object.create(null);for(let i=0,s=e.length;i<s;i++){let o=e[i],l=n;for(let[u,d,f]of o){let h=l[f];h||(l[f]=h={key:f,parent:l,enumerationOffset:0,ascii0:null,ascii8:null,num8:null,string16:null,object16:null,num32:null,float64:null,date64:null}),l=Gt(h,u,d)}l[fn]=i}return e.transitions=n,this.typedStructs=e,this.lastTypedStructuresLength=e.length,t}var yh=Symbol.for("source");function bI(r,e,t,n){let i=r[e++]-32;if(i>=24)switch(i){case 24:i=r[e++];break;case 25:i=r[e++]+(r[e++]<<8);break;case 26:i=r[e++]+(r[e++]<<8)+(r[e++]<<16);break;case 27:i=r[e++]+(r[e++]<<8)+(r[e++]<<16)+(r[e++]<<24);break}let s=n.typedStructs&&n.typedStructs[i];if(!s){if(r=Uint8Array.prototype.slice.call(r,e,t),t-=e,e=0,!n.getStructures)throw new Error(`Reference to shared structure ${i} without getStructures method`);if(n._mergeStructures(n.getStructures()),!n.typedStructs)throw new Error("Could not find any shared typed structures");if(n.lastTypedStructuresLength=n.typedStructs.length,s=n.typedStructs[i],!s)throw new Error("Could not find typed structure "+i)}var o=s.construct;if(!o){o=s.construct=function(){};var l=o.prototype;let d=[],f=0,h;for(let m=0,g=s.length;m<g;m++){let y=s[m],[b,C,L,j]=y;L==="__proto__"&&(L="__proto_");let O={key:L,offset:f};j?d.splice(m+j,0,O):d.push(O);let D;switch(C){case 0:D=()=>0;break;case 1:D=(k,P)=>{let R=k.bytes[P+O.offset];return R>=246?oo(R):R};break;case 2:D=(k,P)=>{let R=k.bytes,Q=(R.dataView||(R.dataView=new DataView(R.buffer,R.byteOffset,R.byteLength))).getUint16(P+O.offset,!0);return Q>=65280?oo(Q&255):Q};break;case 4:D=(k,P)=>{let R=k.bytes,Q=(R.dataView||(R.dataView=new DataView(R.buffer,R.byteOffset,R.byteLength))).getUint32(P+O.offset,!0);return Q>=4294967040?oo(Q&255):Q};break}O.getRef=D,f+=C;let N;switch(b){case gh:h&&!h.next&&(h.next=O),h=O,O.multiGetCount=0,N=function(k){let P=k.bytes,R=k.position,M=f+R,Q=D(k,R);if(typeof Q!="number")return Q;let te,he=O.next;for(;he&&(te=he.getRef(k,R),typeof te!="number");)te=null,he=he.next;return te==null&&(te=k.bytesEnd-M),k.srcString?k.srcString.slice(Q,te):Bw(P,Q+M,te-Q)};break;case Ca:case Bl:h&&!h.next&&(h.next=O),h=O,N=function(k){let P=k.position,R=f+P,M=D(k,P);if(typeof M!="number")return M;let Q=k.bytes,te,he=O.next;for(;he&&(te=he.getRef(k,P),typeof te!="number");)te=null,he=he.next;if(te==null&&(te=k.bytesEnd-R),b===Ca)return Q.toString("utf8",M+R,te+R);dn=k;try{return n.unpack(Q,{start:M+R,end:te+R})}finally{dn=null}};break;case ao:switch(C){case 4:N=function(k){let P=k.bytes,R=P.dataView||(P.dataView=new DataView(P.buffer,P.byteOffset,P.byteLength)),M=k.position+O.offset,Q=R.getInt32(M,!0);if(Q<536870912){if(Q>-520093696)return Q;if(Q>-536870912)return oo(Q&255)}let te=R.getFloat32(M,!0),he=ds[(P[M+3]&127)<<1|P[M+2]>>7];return(he*te+(te>0?.5:-.5)>>0)/he};break;case 8:N=function(k){let P=k.bytes,M=(P.dataView||(P.dataView=new DataView(P.buffer,P.byteOffset,P.byteLength))).getFloat64(k.position+O.offset,!0);if(isNaN(M)){let Q=P[k.position+O.offset];if(Q>=246)return oo(Q)}return M};break;case 1:N=function(k){let R=k.bytes[k.position+O.offset];return R<246?R:oo(R)};break}break;case wh:N=function(k){let P=k.bytes,R=P.dataView||(P.dataView=new DataView(P.buffer,P.byteOffset,P.byteLength));return new Date(R.getFloat64(k.position+O.offset,!0))};break}O.get=N}if(rb){let m=[],g=[],y=0,b;for(let L of d){if(n.alwaysLazyProperty&&n.alwaysLazyProperty(L.key)){b=!0;continue}Object.defineProperty(l,L.key,{get:vI(L.get),enumerable:!0});let j="v"+y++;g.push(j),m.push("["+JSON.stringify(L.key)+"]:"+j+"(s)")}b&&m.push("__proto__:this");let C=new Function(...g,"return function(s){return{"+m.join(",")+"}}").apply(null,d.map(L=>L.get));Object.defineProperty(l,"toJSON",{value(L){return C.call(this,this[yh])}})}else Object.defineProperty(l,"toJSON",{value(m){let g={};for(let y=0,b=d.length;y<b;y++){let C=d[y].key;g[C]=this[C]}return g}})}var u=new o;return u[yh]={bytes:r,position:e,srcString:"",bytesEnd:t},u}function oo(r){switch(r){case 246:return null;case 247:return;case 248:return!1;case 249:return!0}throw new Error("Unknown constant")}function vI(r){return function(){return r(this[yh])}}function _I(){dn&&(dn.bytes=Uint8Array.prototype.slice.call(dn.bytes,dn.position,dn.bytesEnd),dn.position=0,dn.bytesEnd=dn.bytes.length)}function SI(r,e){if(e.typedStructs){let n=new Map;n.set("named",r),n.set("typed",e.typedStructs),r=n}let t=e.lastTypedStructuresLength||0;return r.isCompatible=n=>{let i=!0;return n instanceof Map?((n.get("named")||[]).length!==(e.lastNamedStructuresLength||0)&&(i=!1),(n.get("typed")||[]).length!==t&&(i=!1)):(n instanceof Array||Array.isArray(n))&&n.length!==(e.lastNamedStructuresLength||0)&&(i=!1),i||e._mergeStructures(n),i},e.lastTypedStructuresLength=e.typedStructs&&e.typedStructs.length,r}Vw(bI,wI,_I);var zb=require("module"),YI={};var HI=process.env.MSGPACKR_NATIVE_ACCELERATION_DISABLED!==void 0&&process.env.MSGPACKR_NATIVE_ACCELERATION_DISABLED.toLowerCase()==="true";if(!HI){let r;try{typeof require=="function"?r=Wb():r=(0,zb.createRequire)(YI.url)("msgpackr-extract"),r&&Nw(r.extractStrings)}catch{}}var _i;(function(r){function e(n){return mh(n)}r.encode=e;function t(n){return hh(n)}r.decode=t})(_i||(_i={}));var Kb=require("module"),KI=(0,Kb.createRequire)("/"),JI;try{JI=KI("worker_threads").Worker}catch{}var Et=Uint8Array,ar=Uint16Array,Uh=Int32Array,Wl=new Et([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),zl=new Et([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ah=new Et([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Jb=function(r,e){for(var t=new ar(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var i=new Uh(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)i[s]=s-t[n]<<5|n;return{b:t,r:i}},Qb=Jb(Wl,2),Xb=Qb.b,Ih=Qb.r;Xb[28]=258,Ih[258]=28;var Zb=Jb(zl,0),QI=Zb.b,Hb=Zb.r,Oh=new ar(32768);for(Pe=0;Pe<32768;++Pe)Bn=(Pe&43690)>>1|(Pe&21845)<<1,Bn=(Bn&52428)>>2|(Bn&13107)<<2,Bn=(Bn&61680)>>4|(Bn&3855)<<4,Oh[Pe]=((Bn&65280)>>8|(Bn&255)<<8)>>1;var Bn,Pe,gn=function(r,e,t){for(var n=r.length,i=0,s=new ar(e);i<n;++i)r[i]&&++s[r[i]-1];var o=new ar(e);for(i=1;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;var l;if(t){l=new ar(1<<e);var u=15-e;for(i=0;i<n;++i)if(r[i])for(var d=i<<4|r[i],f=e-r[i],h=o[r[i]-1]++<<f,m=h|(1<<f)-1;h<=m;++h)l[Oh[h]>>u]=d}else for(l=new ar(n),i=0;i<n;++i)r[i]&&(l[i]=Oh[o[r[i]-1]++]>>15-r[i]);return l},Si=new Et(288);for(Pe=0;Pe<144;++Pe)Si[Pe]=8;var Pe;for(Pe=144;Pe<256;++Pe)Si[Pe]=9;var Pe;for(Pe=256;Pe<280;++Pe)Si[Pe]=7;var Pe;for(Pe=280;Pe<288;++Pe)Si[Pe]=8;var Pe,Ra=new Et(32);for(Pe=0;Pe<32;++Pe)Ra[Pe]=5;var Pe,XI=gn(Si,9,0),ZI=gn(Si,9,1),eO=gn(Ra,5,0),tO=gn(Ra,5,1),kh=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},zr=function(r,e,t){var n=e/8|0;return(r[n]|r[n+1]<<8)>>(e&7)&t},Th=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},Lh=function(r){return(r+7)/8|0},ev=function(r,e,t){return(e==null||e<0)&&(e=0),(t==null||t>r.length)&&(t=r.length),new Et(r.subarray(e,t))};var rO=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Hr=function(r,e,t){var n=new Error(e||rO[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,Hr),!t)throw n;return n},nO=function(r,e,t,n){var i=r.length,s=n?n.length:0;if(!i||e.f&&!e.l)return t||new Et(0);var o=!t,l=o||e.i!=2,u=e.i;o&&(t=new Et(i*3));var d=function(Fr){var $t=t.length;if(Fr>$t){var tr=new Et(Math.max($t*2,Fr));tr.set(t),t=tr}},f=e.f||0,h=e.p||0,m=e.b||0,g=e.l,y=e.d,b=e.m,C=e.n,L=i*8;do{if(!g){f=zr(r,h,1);var j=zr(r,h+1,3);if(h+=3,j)if(j==1)g=ZI,y=tO,b=9,C=5;else if(j==2){var k=zr(r,h,31)+257,P=zr(r,h+10,15)+4,R=k+zr(r,h+5,31)+1;h+=14;for(var M=new Et(R),Q=new Et(19),te=0;te<P;++te)Q[Ah[te]]=zr(r,h+te*3,7);h+=P*3;for(var he=kh(Q),pe=(1<<he)-1,S=gn(Q,he,1),te=0;te<R;){var $=S[zr(r,h,pe)];h+=$&15;var O=$>>4;if(O<16)M[te++]=O;else{var q=0,F=0;for(O==16?(F=3+zr(r,h,3),h+=2,q=M[te-1]):O==17?(F=3+zr(r,h,7),h+=3):O==18&&(F=11+zr(r,h,127),h+=7);F--;)M[te++]=q}}var V=M.subarray(0,k),X=M.subarray(k);b=kh(V),C=kh(X),g=gn(V,b,1),y=gn(X,C,1)}else Hr(1);else{var O=Lh(h)+4,D=r[O-4]|r[O-3]<<8,N=O+D;if(N>i){u&&Hr(0);break}l&&d(m+D),t.set(r.subarray(O,N),m),e.b=m+=D,e.p=h=N*8,e.f=f;continue}if(h>L){u&&Hr(0);break}}l&&d(m+131072);for(var me=(1<<b)-1,oe=(1<<C)-1,z=h;;z=h){var q=g[Th(r,h)&me],ce=q>>4;if(h+=q&15,h>L){u&&Hr(0);break}if(q||Hr(2),ce<256)t[m++]=ce;else if(ce==256){z=h,g=null;break}else{var ue=ce-254;if(ce>264){var te=ce-257,J=Wl[te];ue=zr(r,h,(1<<J)-1)+Xb[te],h+=J}var Ue=y[Th(r,h)&oe],kt=Ue>>4;Ue||Hr(3),h+=Ue&15;var X=QI[kt];if(kt>3){var J=zl[kt];X+=Th(r,h)&(1<<J)-1,h+=J}if(h>L){u&&Hr(0);break}l&&d(m+131072);var nt=m+ue;if(m<X){var an=s-X,lt=Math.min(X,nt);for(an+m<0&&Hr(3);m<lt;++m)t[m]=n[an+m]}for(;m<nt;++m)t[m]=t[m-X]}}e.l=g,e.p=z,e.b=m,e.f=f,g&&(f=1,e.m=b,e.d=y,e.n=C)}while(!f);return m!=t.length&&o?ev(t,0,m):t.subarray(0,m)},Mn=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8},ka=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8,r[n+2]|=t>>16},Rh=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var i=t.length,s=t.slice();if(!i)return{t:rv,l:0};if(i==1){var o=new Et(t[0].s+1);return o[t[0].s]=1,{t:o,l:1}}t.sort(function(N,k){return N.f-k.f}),t.push({s:-1,f:25001});var l=t[0],u=t[1],d=0,f=1,h=2;for(t[0]={s:-1,f:l.f+u.f,l,r:u};f!=i-1;)l=t[t[d].f<t[h].f?d++:h++],u=t[d!=f&&t[d].f<t[h].f?d++:h++],t[f++]={s:-1,f:l.f+u.f,l,r:u};for(var m=s[0].s,n=1;n<i;++n)s[n].s>m&&(m=s[n].s);var g=new ar(m+1),y=Dh(t[f-1],g,0);if(y>e){var n=0,b=0,C=y-e,L=1<<C;for(s.sort(function(k,P){return g[P.s]-g[k.s]||k.f-P.f});n<i;++n){var j=s[n].s;if(g[j]>e)b+=L-(1<<y-g[j]),g[j]=e;else break}for(b>>=C;b>0;){var O=s[n].s;g[O]<e?b-=1<<e-g[O]++-1:++n}for(;n>=0&&b;--n){var D=s[n].s;g[D]==e&&(--g[D],++b)}y=e}return{t:new Et(g),l:y}},Dh=function(r,e,t){return r.s==-1?Math.max(Dh(r.l,e,t+1),Dh(r.r,e,t+1)):e[r.s]=t},Gb=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new ar(++e),n=0,i=r[0],s=1,o=function(u){t[n++]=u},l=1;l<=e;++l)if(r[l]==i&&l!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=r[l]}return{c:t.subarray(0,n),n:e}},Ta=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},tv=function(r,e,t){var n=t.length,i=Lh(e+2);r[i]=n&255,r[i+1]=n>>8,r[i+2]=r[i]^255,r[i+3]=r[i+1]^255;for(var s=0;s<n;++s)r[i+s+4]=t[s];return(i+4+n)*8},Yb=function(r,e,t,n,i,s,o,l,u,d,f){Mn(e,f++,t),++i[256];for(var h=Rh(i,15),m=h.t,g=h.l,y=Rh(s,15),b=y.t,C=y.l,L=Gb(m),j=L.c,O=L.n,D=Gb(b),N=D.c,k=D.n,P=new ar(19),R=0;R<j.length;++R)++P[j[R]&31];for(var R=0;R<N.length;++R)++P[N[R]&31];for(var M=Rh(P,7),Q=M.t,te=M.l,he=19;he>4&&!Q[Ah[he-1]];--he);var pe=d+5<<3,S=Ta(i,Si)+Ta(s,Ra)+o,$=Ta(i,m)+Ta(s,b)+o+14+3*he+Ta(P,Q)+2*P[16]+3*P[17]+7*P[18];if(u>=0&&pe<=S&&pe<=$)return tv(e,f,r.subarray(u,u+d));var q,F,V,X;if(Mn(e,f,1+($<S)),f+=2,$<S){q=gn(m,g,0),F=m,V=gn(b,C,0),X=b;var me=gn(Q,te,0);Mn(e,f,O-257),Mn(e,f+5,k-1),Mn(e,f+10,he-4),f+=14;for(var R=0;R<he;++R)Mn(e,f+3*R,Q[Ah[R]]);f+=3*he;for(var oe=[j,N],z=0;z<2;++z)for(var ce=oe[z],R=0;R<ce.length;++R){var ue=ce[R]&31;Mn(e,f,me[ue]),f+=Q[ue],ue>15&&(Mn(e,f,ce[R]>>5&127),f+=ce[R]>>12)}}else q=XI,F=Si,V=eO,X=Ra;for(var R=0;R<l;++R){var J=n[R];if(J>255){var ue=J>>18&31;ka(e,f,q[ue+257]),f+=F[ue+257],ue>7&&(Mn(e,f,J>>23&31),f+=Wl[ue]);var Ue=J&31;ka(e,f,V[Ue]),f+=X[Ue],Ue>3&&(ka(e,f,J>>5&8191),f+=zl[Ue])}else ka(e,f,q[J]),f+=F[J]}return ka(e,f,q[256]),f+F[256]},iO=new Uh([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),rv=new Et(0),sO=function(r,e,t,n,i,s){var o=s.z||r.length,l=new Et(n+o+5*(1+Math.ceil(o/7e3))+i),u=l.subarray(n,l.length-i),d=s.l,f=(s.r||0)&7;if(e){f&&(u[0]=s.r>>3);for(var h=iO[e-1],m=h>>13,g=h&8191,y=(1<<t)-1,b=s.p||new ar(32768),C=s.h||new ar(y+1),L=Math.ceil(t/3),j=2*L,O=function(An){return(r[An]^r[An+1]<<L^r[An+2]<<j)&y},D=new Uh(25e3),N=new ar(288),k=new ar(32),P=0,R=0,M=s.i||0,Q=0,te=s.w||0,he=0;M+2<o;++M){var pe=O(M),S=M&32767,$=C[pe];if(b[S]=$,C[pe]=S,te<=M){var q=o-M;if((P>7e3||Q>24576)&&(q>423||!d)){f=Yb(r,u,0,D,N,k,R,Q,he,M-he,f),Q=P=R=0,he=M;for(var F=0;F<286;++F)N[F]=0;for(var F=0;F<30;++F)k[F]=0}var V=2,X=0,me=g,oe=S-$&32767;if(q>2&&pe==O(M-oe))for(var z=Math.min(m,q)-1,ce=Math.min(32767,M),ue=Math.min(258,q);oe<=ce&&--me&&S!=$;){if(r[M+V]==r[M+V-oe]){for(var J=0;J<ue&&r[M+J]==r[M+J-oe];++J);if(J>V){if(V=J,X=oe,J>z)break;for(var Ue=Math.min(oe,J-2),kt=0,F=0;F<Ue;++F){var nt=M-oe+F&32767,an=b[nt],lt=nt-an&32767;lt>kt&&(kt=lt,$=nt)}}}S=$,$=b[S],oe+=S-$&32767}if(X){D[Q++]=268435456|Ih[V]<<18|Hb[X];var Fr=Ih[V]&31,$t=Hb[X]&31;R+=Wl[Fr]+zl[$t],++N[257+Fr],++k[$t],te=M+V,++P}else D[Q++]=r[M],++N[r[M]]}}for(M=Math.max(M,te);M<o;++M)D[Q++]=r[M],++N[r[M]];f=Yb(r,u,d,D,N,k,R,Q,he,M-he,f),d||(s.r=f&7|u[f/8|0]<<3,f-=7,s.h=C,s.p=b,s.i=M,s.w=te)}else{for(var M=s.w||0;M<o+d;M+=65535){var tr=M+65535;tr>=o&&(u[f/8|0]=d,tr=o),f=tv(u,f+1,r.subarray(M,tr))}s.i=o}return ev(l,0,n+Lh(f)+i)},oO=function(){for(var r=new Int32Array(256),e=0;e<256;++e){for(var t=e,n=9;--n;)t=(t&1&&-306674912)^t>>>1;r[e]=t}return r}(),aO=function(){var r=-1;return{p:function(e){for(var t=r,n=0;n<e.length;++n)t=oO[t&255^e[n]]^t>>>8;r=t},d:function(){return~r}}};var cO=function(r,e,t,n,i){if(!i&&(i={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new Et(s.length+r.length);o.set(s),o.set(r,s.length),r=o,i.w=s.length}return sO(r,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,t,n,i)};var Ph=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8},lO=function(r,e){var t=e.filename;if(r[0]=31,r[1]=139,r[2]=8,r[8]=e.level<2?4:e.level==9?2:0,r[9]=3,e.mtime!=0&&Ph(r,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),t){r[3]=8;for(var n=0;n<=t.length;++n)r[n+10]=t.charCodeAt(n)}},uO=function(r){(r[0]!=31||r[1]!=139||r[2]!=8)&&Hr(6,"invalid gzip data");var e=r[3],t=10;e&4&&(t+=(r[10]|r[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!r[t++]);return t+(e&2)},fO=function(r){var e=r.length;return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0},dO=function(r){return 10+(r.filename?r.filename.length+1:0)};function nv(r,e){e||(e={});var t=aO(),n=r.length;t.p(r);var i=cO(r,e,dO(e),8),s=i.length;return lO(i,e),Ph(i,s-8,t.d()),Ph(i,s-4,n),i}function iv(r,e){var t=uO(r);return t+8>r.length&&Hr(6,"invalid gzip data"),nO(r.subarray(t,-8),{i:2},e&&e.out||new Et(fO(r)),e&&e.dictionary)}var hO=typeof TextDecoder<"u"&&new TextDecoder,pO=0;try{hO.decode(rv,{stream:!0}),pO=1}catch{}var uo;(function(r){function e(i){if(i.length===0)return"none";if(typeof i[0]=="string")return i[0];{let s=i,o=new Map,l=i[0];for(let f=0;f<l.length;f++){let h=l[f];h!=="none"&&o.set(h,f)}for(let f=1;f<s.length;f++){let h=s[f],m=new Set;for(let g=0;g<h.length;g++){let y=h[g];if(y!=="none"&&o.has(y)){let b=o.get(y)??0;o.set(y,b+g),m.add(y)}}for(let g of o.keys())m.has(g)||o.delete(g);if(o.size===0)break}let u="none",d=1/0;for(let[f,h]of o.entries())h<d&&(u=f,d=h);return u}}r.bestFit=e;async function t(i,s){if(s==="none"||s===void 0)return i;if(s==="gzip")return nv(i);throw new Error("Unsupported compression algorithm: "+s)}r.compress=t;async function n(i,s){if(s==="none"||s===void 0)return i;if(s==="gzip")return iv(i);throw new Error("Unsupported compression algorithm: "+s)}r.decompress=n})(uo||(uo={}));var Gl=de(av(),1);function wn(r){return typeof Buffer>"u"?(0,Gl.toByteArray)(r):Buffer.from(r,"base64")}function xi(r){return typeof Buffer>"u"?(0,Gl.fromByteArray)(r):Buffer.from(r).toString("base64")}var Nh,cv=r=>{Nh=r},cr=()=>{if(Nh===void 0)throw new Error("Crypto module is not available. Please call the initializeProtocol() function first.");let r=Nh.subtle;return{async generateKeyPair(){let e=await r.generateKey({name:"RSA-OAEP",modulusLength:4096,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,["encrypt","decrypt"]),t=await r.exportKey("spki",e.publicKey),n=await r.exportKey("pkcs8",e.privateKey);return{privateKey:xi(new Uint8Array(n)),publicKey:xi(new Uint8Array(t))}},async generateSymKey(){let e=await r.generateKey({name:"AES-CBC",length:256},!0,["encrypt","decrypt"]),t=await r.exportKey("raw",e);return xi(new Uint8Array(t))},async generateIV(){let e=crypto.getRandomValues(new Uint8Array(16));return xi(e)},async symEncrypt(e,t,n){let i=await r.importKey("raw",wn(t),"AES-CBC",!1,["encrypt"]),s=await r.encrypt({name:"AES-CBC",iv:wn(n)},i,e);return new Uint8Array(s)},async symDecrypt(e,t,n){let i=await r.importKey("raw",wn(t),"AES-CBC",!1,["decrypt"]),s=await r.decrypt({name:"AES-CBC",iv:wn(n)},i,e);return new Uint8Array(s)},async publicEncrypt(e,t){let n=await r.importKey("spki",wn(t),{name:"RSA-OAEP",hash:"SHA-256"},!1,["encrypt"]),i=await r.encrypt({name:"RSA-OAEP"},n,e);return new Uint8Array(i)},async privateDecrypt(e,t){let n=await r.importKey("pkcs8",wn(t),{name:"RSA-OAEP",hash:"SHA-256"},!0,["decrypt"]),i=await r.decrypt({name:"RSA-OAEP"},n,e);return new Uint8Array(i)}}};var Nt;(function(r){async function e(){return cr().generateKeyPair()}r.generateKeyPair=e;async function t(){return cr().generateSymKey()}r.generateSymKey=t;async function n(f,h,m){return cr().symEncrypt(f,h,m)}r.symEncrypt=n;async function i(f,h,m){return cr().symDecrypt(f,h,m)}r.symDecrypt=i;async function s(f,h){return cr().publicEncrypt(f,h)}r.publicEncrypt=s;async function o(f,h){return cr().privateDecrypt(f,h)}r.privateDecrypt=o;async function l(){return cr().generateIV()}r.generateIV=l;async function u(f,h,...m){let g=await h.symmetricKey,y=wn(g),b=f.content,C=_i.encode(b),L=uo.bestFit(m.map(k=>k.supportedCompression)),j=await uo.compress(C,L),O=await cr().generateIV(),D=await cr().symEncrypt(j,g,O),N=await Promise.all(m.map(async k=>{let P=h.cache?.[k.peerId];return P||(P=xi(await cr().publicEncrypt(y,k.publicKey)),h.cache&&(h.cache[k.peerId]=P)),{target:k.peerId,key:P,iv:O}}));return{...f,metadata:{...f.metadata,encryption:{keys:N},compression:{algorithm:L}},content:D}}r.encrypt=u;async function d(f,h){if(f.metadata.encryption.keys.length!==1)throw new Error("Expected exactly one key for decryption");let m=f.metadata.encryption.keys[0],g=h.cache?.[m.key];g||(g=xi(await cr().privateDecrypt(wn(m.key),h.privateKey)),h.cache&&(h.cache[m.key]=g));let y=await cr().symDecrypt(f.content,g,m.iv),b=await uo.decompress(y,f.metadata.compression.algorithm),C=_i.decode(b);return{...f,content:C}}r.decrypt=d})(Nt||(Nt={}));var Yl=class{options;messageHandlers=new Map;onErrorEmitter=new ir;onDisconnectEmitter=new ir;onConnectionErrorEmitter=new ir;onReconnectEmitter=new ir;onUnhandledRequestHandler;onUnhandledBroadcastHandler;onUnhandledNotificationHandler;get onError(){return this.onErrorEmitter.event}get onDisconnect(){return this.onDisconnectEmitter.event}get onReconnect(){return this.onReconnectEmitter.event}get onConnectionError(){return this.onConnectionErrorEmitter.event}requestMap=new Map;requestId=1;symKey=Nt.generateSymKey();encryptionKeyCache={};decryptionKeyCache={};maxCacheSize=50;_ready=new Vr;constructor(e){this.options=e,e.transport.read(t=>this.handleMessage(new Uint8Array(t))),e.transport.onDisconnect(()=>this.dispose()),e.transport.onError(t=>{this.onConnectionErrorEmitter.fire(t),this.dispose()}),e.transport.onReconnect(()=>this.onReconnectEmitter.fire())}dispose(){this.onDisconnectEmitter.fire(),this.onDisconnectEmitter.dispose(),this.onErrorEmitter.dispose(),this.messageHandlers.clear(),this.options.transport.dispose()}ready(){this._ready.resolve()}cleanupCaches(){let e=this.getPublicKeysLength()+this.maxCacheSize;Object.keys(this.encryptionKeyCache).length>e&&(this.encryptionKeyCache={}),Object.keys(this.decryptionKeyCache).length>e&&(this.decryptionKeyCache={})}async handleMessage(e){this.cleanupCaches();let t;try{t=_i.decode(e)}catch(n){console.error("Decoding message error",n);return}if(ss.isAny(t)){let n=this.requestMap.get(t.id);try{let i;if(ss.isEncrypted(t))i=await Nt.decrypt(t,{privateKey:this.options.privateKey,cache:this.decryptionKeyCache});else if(ss.is(t))i=t;else{console.error("Received invalid response message");return}n&&n.response.resolve(i.content.response)}catch(i){console.error("Failed to handle response message",i),n?.response.reject(i)}}else if(os.isAny(t)){let n=this.requestMap.get(t.id);try{let i;if(os.isEncrypted(t))i=await Nt.decrypt(t,{privateKey:this.options.privateKey,cache:this.decryptionKeyCache});else if(os.is(t))i=t;else{console.error("Received invalid response error message");return}n&&n.response.reject(new Error(i.content.message))}catch(i){console.error("Failed to handle response error message",i),n?.response.reject(i)}}else if(is.isAny(t))try{let n;if(is.isEncrypted(t))n=await Nt.decrypt(t,{privateKey:this.options.privateKey,cache:this.decryptionKeyCache});else if(is.is(t))n=t;else{console.error("Received invalid request message");return}let i=this.messageHandlers.get(n.content.method)??this.onUnhandledRequestHandler?.(n.content.method);if(!i){console.error(`No handler registered for ${n.kind} method ${n.content.method}.`);return}await this._ready.promise;let s;try{let o=await i(n.origin,...n.content.params??[]);s=ss.create(n.id,o)}catch(o){s=os.create(n.id,String(o))}if(n.origin==="")await this.write(s);else{let o=this.getPublicKey(n.origin),l=await Nt.encrypt(s,{symmetricKey:this.symKey,cache:this.encryptionKeyCache},o);await this.write(l)}}catch(n){console.error("Failed to handle request message",n)}else if(gi.isAny(t)||as.isAny(t))try{let n;if(as.isEncrypted(t)||gi.isEncrypted(t))n=await Nt.decrypt(t,{privateKey:this.options.privateKey,cache:this.decryptionKeyCache});else if(as.is(t)||gi.is(t))n=t;else{console.error(`Received invalid ${t.kind} message`);return}let i=this.messageHandlers.get(n.content.method)??(gi.is(n)?this.onUnhandledBroadcastHandler?.(n.content.method):this.onUnhandledNotificationHandler?.(n.content.method));if(!i){console.error(`No handler registered for ${t.kind} method ${n.content.method}.`);return}i(t.origin,...n.content.params??[])}catch(n){console.error(`Failed to handle ${t.kind} message`,n)}else if(io.isAny(t))try{let n;if(io.isBinary(t))n=await Nt.decrypt(t,{privateKey:this.options.privateKey,cache:this.decryptionKeyCache});else if(io.is(t))n=t;else{console.error("Received invalid error message");return}this.onErrorEmitter.fire(n.content.message)}catch(n){console.error("Failed to handle error message",n)}}async write(e){await this.options.transport.write(_i.encode(e))}onRequest(e,t){if(typeof e=="function")this.onUnhandledRequestHandler&&console.warn("Unhandled request handler already set. previous handler will be overwritten."),this.onUnhandledRequestHandler=n=>(i,...s)=>e(i,n,...s);else{let n=typeof e=="string"?e:e.method;this.messageHandlers.set(n,t)}}onNotification(e,t){if(typeof e=="function")this.onUnhandledNotificationHandler&&console.warn("Unhandled notification handler already set. previous handler will be overwritten."),this.onUnhandledNotificationHandler=n=>(i,...s)=>e(i,n,...s);else{let n=typeof e=="string"?e:e.method;this.messageHandlers.set(n,t)}}onBroadcast(e,t){if(typeof e=="function")this.onUnhandledNotificationHandler&&console.warn("Unhandled broadcast handler already set. previous handler will be overwritten."),this.onUnhandledBroadcastHandler=n=>(i,...s)=>e(i,n,...s);else{let n=typeof e=="string"?e:e.method;this.messageHandlers.set(n,t)}}async sendRequest(e,t,...n){await this._ready.promise;let i=this.requestId++,s=new Vr,o=()=>{this.requestMap.delete(i),clearTimeout(l),s.reject(new Error("Request timed out"))},l=setTimeout(o,6e4),u={id:i,response:s,dispose:o};this.requestMap.set(i,u);let d=is.create(e,i,"",t,n);if(t==="")await this.write(d);else{let f=await Nt.encrypt(d,{symmetricKey:this.symKey,cache:this.encryptionKeyCache},this.getPublicKey(t));await this.write(f)}return s.promise}async sendNotification(e,t,...n){await this._ready.promise;let i=as.create(e,"",t,n);if(t==="")await this.write(i);else{let s=await Nt.encrypt(i,{symmetricKey:this.symKey,cache:this.encryptionKeyCache},this.getPublicKey(t));await this.write(s)}}async sendBroadcast(e,...t){await this._ready.promise;let n=gi.create(e,"",t),i=this.getPublicKeys();if(i.length>0){let s=await Nt.encrypt(n,{symmetricKey:this.symKey,cache:this.encryptionKeyCache},...i);await this.write(s)}}};var Gh=de(fv(),1);var Gr=Object.create(null);Gr.open="0";Gr.close="1";Gr.ping="2";Gr.pong="3";Gr.message="4";Gr.upgrade="5";Gr.noop="6";var Aa=Object.create(null);Object.keys(Gr).forEach(r=>{Aa[Gr[r]]=r});var Ia={type:"error",data:"parser error"};var Oa=({type:r,data:e},t,n)=>e instanceof ArrayBuffer||ArrayBuffer.isView(e)?n(t?e:"b"+dv(e,!0).toString("base64")):n(Gr[r]+(e||"")),dv=(r,e)=>Buffer.isBuffer(r)||r instanceof Uint8Array&&!e?r:r instanceof ArrayBuffer?Buffer.from(r):Buffer.from(r.buffer,r.byteOffset,r.byteLength),Mh;function hv(r,e){if(r.data instanceof ArrayBuffer||ArrayBuffer.isView(r.data))return e(dv(r.data,!1));Oa(r,!0,t=>{Mh||(Mh=new TextEncoder),e(Mh.encode(t))})}var Da=(r,e)=>{if(typeof r!="string")return{type:"message",data:pv(r,e)};let t=r.charAt(0);if(t==="b"){let n=Buffer.from(r.substring(1),"base64");return{type:"message",data:pv(n,e)}}return Aa[t]?r.length>1?{type:Aa[t],data:r.substring(1)}:{type:Aa[t]}:Ia},pv=(r,e)=>{switch(e){case"arraybuffer":return r instanceof ArrayBuffer?r:Buffer.isBuffer(r)?r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength):r.buffer;case"nodebuffer":default:return Buffer.isBuffer(r)?r:Buffer.from(r)}};var mv="",gv=(r,e)=>{let t=r.length,n=new Array(t),i=0;r.forEach((s,o)=>{Oa(s,!1,l=>{n[o]=l,++i===t&&e(n.join(mv))})})},yv=(r,e)=>{let t=r.split(mv),n=[];for(let i=0;i<t.length;i++){let s=Da(t[i],e);if(n.push(s),s.type==="error")break}return n};function wv(){return new TransformStream({transform(r,e){hv(r,t=>{let n=t.length,i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);let s=new DataView(i.buffer);s.setUint8(0,126),s.setUint16(1,n)}else{i=new Uint8Array(9);let s=new DataView(i.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(n))}r.data&&typeof r.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(t)})}})}var qh;function Kl(r){return r.reduce((e,t)=>e+t.length,0)}function Jl(r,e){if(r[0].length===e)return r.shift();let t=new Uint8Array(e),n=0;for(let i=0;i<e;i++)t[i]=r[0][n++],n===r[0].length&&(r.shift(),n=0);return r.length&&n<r[0].length&&(r[0]=r[0].slice(n)),t}function bv(r,e){qh||(qh=new TextDecoder);let t=[],n=0,i=-1,s=!1;return new TransformStream({transform(o,l){for(t.push(o);;){if(n===0){if(Kl(t)<1)break;let u=Jl(t,1);s=(u[0]&128)===128,i=u[0]&127,i<126?n=3:i===126?n=1:n=2}else if(n===1){if(Kl(t)<2)break;let u=Jl(t,2);i=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),n=3}else if(n===2){if(Kl(t)<8)break;let u=Jl(t,8),d=new DataView(u.buffer,u.byteOffset,u.length),f=d.getUint32(0);if(f>Math.pow(2,21)-1){l.enqueue(Ia);break}i=f*Math.pow(2,32)+d.getUint32(4),n=3}else{if(Kl(t)<i)break;let u=Jl(t,i);l.enqueue(Da(s?u:qh.decode(u),e)),n=0}if(i===0||i>r){l.enqueue(Ia);break}}}})}var jh=4;var Lv=de(ms(),1);var qn=process.nextTick,Mt=global,_v="nodebuffer";function Sv(){return new $h}function CO(r){let e=r.split("; "),t=e[0].indexOf("=");if(t===-1)return;let n=e[0].substring(0,t).trim();if(!n.length)return;let i=e[0].substring(t+1).trim();i.charCodeAt(0)===34&&(i=i.slice(1,-1));let s={name:n,value:i};for(let o=1;o<e.length;o++){let l=e[o].split("=");if(l.length!==2)continue;let u=l[0].trim(),d=l[1].trim();switch(u){case"Expires":s.expires=new Date(d);break;case"Max-Age":let f=new Date;f.setUTCSeconds(f.getUTCSeconds()+parseInt(d,10)),s.expires=f;break;default:}}return s}var $h=class{constructor(){this._cookies=new Map}parseCookies(e){e&&e.forEach(t=>{let n=CO(t);n&&this._cookies.set(n.name,n)})}get cookies(){let e=Date.now();return this._cookies.forEach((t,n)=>{var i;((i=t.expires)===null||i===void 0?void 0:i.getTime())<e&&this._cookies.delete(n)}),this._cookies.entries()}addCookies(e){let t=[];for(let[n,i]of this.cookies)t.push(`${n}=${i.value}`);t.length&&(e.setDisableHeaderCheck(!0),e.setRequestHeader("cookie",t.join("; ")))}appendCookies(e){for(let[t,n]of this.cookies)e.append("cookie",`${t}=${n.value}`)}};function Ql(r,...e){return e.reduce((t,n)=>(r.hasOwnProperty(n)&&(t[n]=r[n]),t),{})}var kO=Mt.setTimeout,TO=Mt.clearTimeout;function jn(r,e){e.useNativeTimers?(r.setTimeoutFn=kO.bind(Mt),r.clearTimeoutFn=TO.bind(Mt)):(r.setTimeoutFn=Mt.setTimeout.bind(Mt),r.clearTimeoutFn=Mt.clearTimeout.bind(Mt))}var RO=1.33;function xv(r){return typeof r=="string"?AO(r):Math.ceil((r.byteLength||r.size)*RO)}function AO(r){let e=0,t=0;for(let n=0,i=r.length;n<i;n++)e=r.charCodeAt(n),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(n++,t+=4);return t}function Xl(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Ev(r){let e="";for(let t in r)r.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(r[t]));return e}function Cv(r){let e={},t=r.split("&");for(let n=0,i=t.length;n<i;n++){let s=t[n].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}var Fv=de(ys(),1),eD=(0,Fv.default)("engine.io-client:transport"),ou=class extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}},$n=class extends Lv.Emitter{constructor(e){super(),this.writable=!1,jn(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new ou(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"?this.write(e):eD("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let t=Da(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){let e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){let t=Ev(e);return t.length?"?"+t:""}};var Nv=de(ys(),1),Yr=(0,Nv.default)("engine.io-client:polling"),Pa=class extends $n{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";let t=()=>{Yr("paused"),this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(Yr("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){Yr("pre-pause polling complete"),--n||t()})),this.writable||(Yr("we are currently writing - waiting to pause"),n++,this.once("drain",function(){Yr("pre-pause writing complete"),--n||t()}))}else t()}_poll(){Yr("polling"),this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){Yr("polling got data %s",e);let t=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};yv(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"?this._poll():Yr('ignoring poll - transport state "%s"',this.readyState))}doClose(){let e=()=>{Yr("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(Yr("transport open - closing"),e()):(Yr("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,gv(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Xl()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}};var jv=de(ms(),1);var Bv=!1;try{Bv=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var Mv=Bv;var $v=de(ys(),1),Hh=(0,$v.default)("engine.io-client:polling");function tD(){}var au=class extends Pa{constructor(e){if(super(e),typeof location<"u"){let t=location.protocol==="https:",n=location.port;n||(n=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){let n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(i,s)=>{this.onError("xhr post error",i,s)})}doPoll(){Hh("xhr poll");let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,n)=>{this.onError("xhr poll error",t,n)}),this.pollXhr=e}},Vn=class r extends jv.Emitter{constructor(e,t,n){super(),this.createRequest=e,jn(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;let t=Ql(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;let n=this._xhr=this.createRequest(t);try{Hh("xhr open %s: %s",this._method,this._uri),n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var i;n.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},Hh("xhr data %s",this._data),n.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=r.requestsCount++,r.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=tD,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete r.requests[this._index],this._xhr=null}}_onLoad(){let e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Vn.requestsCount=0;Vn.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",qv);else if(typeof addEventListener=="function"){let r="onpagehide"in Mt?"pagehide":"unload";addEventListener(r,qv,!1)}}function qv(){for(let r in Vn.requests)Vn.requests.hasOwnProperty(r)&&Vn.requests[r].abort()}var W3=function(){let r=rD({xdomain:!1});return r&&r.responseType!==null}();function rD(r){let e=r.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Mv))return new XMLHttpRequest}catch{}if(!e)try{return new Mt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}var nD=Gh.default||Gh,go=class extends au{request(e={}){var t;return Object.assign(e,{xd:this.xd,cookieJar:(t=this.socket)===null||t===void 0?void 0:t._cookieJar},this.opts),new Vn(n=>new nD(n),this.uri(),e)}};var hP=de(Hv(),1),pP=de(ip(),1),mP=de(op(),1),mp=de(hp(),1),gP=de(V_(),1);var W_=de(ys(),1),wP=(0,W_.default)("engine.io-client:websocket"),bP=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",_u=class extends $n{get name(){return"websocket"}doOpen(){let e=this.uri(),t=this.opts.protocols,n=bP?{}:Ql(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let n=e[t],i=t===e.length-1;Oa(n,this.supportsBinary,s=>{try{this.doWrite(n,s)}catch{wP("websocket closed before onclose event")}i&&qn(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){let e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Xl()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}},mM=Mt.WebSocket||Mt.MozWebSocket;var _o=class extends _u{createSocket(e,t,n){var i;if(!((i=this.socket)===null||i===void 0)&&i._cookieJar){n.headers=n.headers||{},n.headers.cookie=typeof n.headers.cookie=="string"?[n.headers.cookie]:n.headers.cookie||[];for(let[s,o]of this.socket._cookieJar.cookies)n.headers.cookie.push(`${s}=${o.value}`)}return new mp.default(e,t,n)}doWrite(e,t){let n={};e.options&&(n.compress=e.options.compress),this.opts.perMessageDeflate&&(typeof t=="string"?Buffer.byteLength(t):t.length)<this.opts.perMessageDeflate.threshold&&(n.compress=!1),this.ws.send(t,n)}};var z_=de(ys(),1),Wa=(0,z_.default)("engine.io-client:webtransport"),So=class extends $n{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{Wa("transport closed gracefully"),this.onClose()}).catch(e=>{Wa("transport closed due to %s",e),this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{let t=bv(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),i=wv();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();let s=()=>{n.read().then(({done:l,value:u})=>{if(l){Wa("session is closed");return}Wa("received chunk: %o",u),this.onPacket(u),s()}).catch(l=>{Wa("an error occurred while reading: %s",l)})};s();let o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let n=e[t],i=t===e.length-1;this._writer.write(n).then(()=>{i&&qn(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}};var gp={websocket:_o,webtransport:So,polling:go};var vP=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,_P=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function xo(r){if(r.length>8e3)throw"URI too long";let e=r,t=r.indexOf("["),n=r.indexOf("]");t!=-1&&n!=-1&&(r=r.substring(0,t)+r.substring(t,n).replace(/:/g,";")+r.substring(n,r.length));let i=vP.exec(r||""),s={},o=14;for(;o--;)s[_P[o]]=i[o]||"";return t!=-1&&n!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=SP(s,s.path),s.queryKey=xP(s,s.query),s}function SP(r,e){let t=/\/{2,9}/g,n=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function xP(r,e){let t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,s){i&&(t[i]=s)}),t}var H_=de(ms(),1);var G_=de(ys(),1),Me=(0,G_.default)("engine.io-client:socket"),yp=typeof addEventListener=="function"&&typeof removeEventListener=="function",za=[];yp&&addEventListener("offline",()=>{Me("closing %d connection(s) because the network was lost",za.length),za.forEach(r=>r())},!1);var Ss=class r extends H_.Emitter{constructor(e,t){if(super(),this.binaryType=_v,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){let n=xo(e);t.hostname=n.host,t.secure=n.protocol==="https"||n.protocol==="wss",t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=xo(t.host).host);jn(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(n=>{let i=n.prototype.name;this.transports.push(i),this._transportsByName[i]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Cv(this.opts.query)),yp&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(Me("adding listener for the 'offline' event"),this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},za.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=Sv()),this._open()}createTransport(e){Me('creating transport "%s"',e);let t=Object.assign({},this.opts.query);t.EIO=jh,t.transport=e,this.id&&(t.sid=this.id);let n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return Me("options: %j",n),new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}let e=this.opts.rememberUpgrade&&r.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";let t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){Me("setting transport %s",e.name),this.transport&&(Me("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){Me("socket open"),this.readyState="open",r.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(Me('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}else Me('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this._getWritablePackets();Me("flushing %d packets in socket",e.length),this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){let i=this.writeBuffer[n].data;if(i&&(t+=xv(i)),n>0&&t>this._maxPayload)return Me("only send %d out of %d packets",n,this.writeBuffer.length),this.writeBuffer.slice(0,n);t+=2}return Me("payload size is %d (max: %d)",t,this._maxPayload),this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let e=Date.now()>this._pingTimeoutTime;return e&&(Me("throttled timer detected, scheduling connection close"),this._pingTimeoutTime=0,qn(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,i){if(typeof t=="function"&&(i=t,t=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;let s={type:e,data:t,options:n};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}close(){let e=()=>{this._onClose("forced close"),Me("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(Me("socket error %j",e),r.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return Me("trying next transport"),this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(Me('socket close with reason: "%s"',e),this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),yp&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){let n=za.indexOf(this._offlineEventListener);n!==-1&&(Me("removing listener for the 'offline' event"),za.splice(n,1))}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}};Ss.protocol=jh;var Su=class extends Ss{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade){Me("starting upgrade probes");for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}}_probe(e){Me('probing transport "%s"',e);let t=this.createTransport(e),n=!1;Ss.priorWebsocketSuccess=!1;let i=()=>{n||(Me('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",h=>{if(!n)if(h.type==="pong"&&h.data==="probe"){if(Me('probe transport "%s" pong',e),this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Ss.priorWebsocketSuccess=t.name==="websocket",Me('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{n||this.readyState!=="closed"&&(Me("changing transport and sending upgrade packet"),f(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{Me('probe transport "%s" failed',e);let m=new Error("probe error");m.transport=t.name,this.emitReserved("upgradeError",m)}}))};function s(){n||(n=!0,f(),t.close(),t=null)}let o=h=>{let m=new Error("probe error: "+h);m.transport=t.name,s(),Me('probe transport "%s" failed because of error: %s',e,h),this.emitReserved("upgradeError",m)};function l(){o("transport closed")}function u(){o("socket closed")}function d(h){t&&h.name!==t.name&&(Me('"%s" works - aborting "%s"',h.name,t.name),s())}let f=()=>{t.removeListener("open",i),t.removeListener("error",o),t.removeListener("close",l),this.off("close",u),this.off("upgrading",d)};t.once("open",i),t.once("error",o),t.once("close",l),this.once("close",u),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){let t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}},Eo=class extends Su{constructor(e,t={}){let n=typeof e=="object"?e:t;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(i=>gp[i]).filter(i=>!!i)),super(e,n)}};var BM=Eo.protocol;var Z_=de(Ha(),1),X_=(0,Z_.default)("socket.io-client:url");function eS(r,e="",t){let n=r;t=t||typeof location<"u"&&location,r==null&&(r=t.protocol+"//"+t.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=t.protocol+r:r=t.host+r),/^(https?|wss?):\/\//.test(r)||(X_("protocol-less url %s",r),typeof t<"u"?r=t.protocol+"//"+r:r="https://"+r),X_("parse %s",r),n=xo(r)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";let s=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+e,n.href=n.protocol+"://"+s+(t&&t.port===n.port?"":":"+n.port),n}var Rp={};Ad(Rp,{Decoder:()=>kp,Encoder:()=>Cp,PacketType:()=>Oe,protocol:()=>dS});var uS=de(ms(),1);var $P=typeof ArrayBuffer=="function",VP=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,tS=Object.prototype.toString,WP=typeof Blob=="function"||typeof Blob<"u"&&tS.call(Blob)==="[object BlobConstructor]",zP=typeof File=="function"||typeof File<"u"&&tS.call(File)==="[object FileConstructor]";function Ya(r){return $P&&(r instanceof ArrayBuffer||VP(r))||WP&&r instanceof Blob||zP&&r instanceof File}function Ga(r,e){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let t=0,n=r.length;t<n;t++)if(Ga(r[t]))return!0;return!1}if(Ya(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return Ga(r.toJSON(),!0);for(let t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&Ga(r[t]))return!0;return!1}function rS(r){let e=[],t=r.data,n=r;return n.data=vp(t,e),n.attachments=e.length,{packet:n,buffers:e}}function vp(r,e){if(!r)return r;if(Ya(r)){let t={_placeholder:!0,num:e.length};return e.push(r),t}else if(Array.isArray(r)){let t=new Array(r.length);for(let n=0;n<r.length;n++)t[n]=vp(r[n],e);return t}else if(typeof r=="object"&&!(r instanceof Date)){let t={};for(let n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=vp(r[n],e));return t}return r}function nS(r,e){return r.data=_p(r.data,e),delete r.attachments,r}function _p(r,e){if(!r)return r;if(r&&r._placeholder===!0){if(typeof r.num=="number"&&r.num>=0&&r.num<e.length)return e[r.num];throw new Error("illegal attachments")}else if(Array.isArray(r))for(let t=0;t<r.length;t++)r[t]=_p(r[t],e);else if(typeof r=="object")for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&(r[t]=_p(r[t],e));return r}var fS=de(cS(),1),Ep=(0,fS.default)("socket.io-parser"),aU=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],dS=5,Oe;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(Oe||(Oe={}));var Cp=class{constructor(e){this.replacer=e}encode(e){return Ep("encoding packet %j",e),(e.type===Oe.EVENT||e.type===Oe.ACK)&&Ga(e)?this.encodeAsBinary({type:e.type===Oe.EVENT?Oe.BINARY_EVENT:Oe.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===Oe.BINARY_EVENT||e.type===Oe.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),Ep("encoded %j as %s",e,t),t}encodeAsBinary(e){let t=rS(e),n=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(n),i}};function lS(r){return Object.prototype.toString.call(r)==="[object Object]"}var kp=class r extends uS.Emitter{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);let n=t.type===Oe.BINARY_EVENT;n||t.type===Oe.BINARY_ACK?(t.type=n?Oe.EVENT:Oe.ACK,this.reconstructor=new Tp(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Ya(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0,n={type:Number(e.charAt(0))};if(Oe[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===Oe.BINARY_EVENT||n.type===Oe.BINARY_ACK){let s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);let o=e.substring(s,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(e.charAt(t+1)==="/"){let s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););n.nsp=e.substring(s,t)}else n.nsp="/";let i=e.charAt(t+1);if(i!==""&&Number(i)==i){let s=t+1;for(;++t;){let o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}n.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){let s=this.tryParse(e.substr(t));if(r.isPayloadValid(n.type,s))n.data=s;else throw new Error("invalid payload")}return Ep("decoded %s as %j",e,n),n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case Oe.CONNECT:return lS(t);case Oe.DISCONNECT:return t===void 0;case Oe.CONNECT_ERROR:return typeof t=="string"||lS(t);case Oe.EVENT:case Oe.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&aU.indexOf(t[0])===-1);case Oe.ACK:case Oe.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}},Tp=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let t=nS(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function hr(r,e,t){return r.on(e,t),function(){r.off(e,t)}}var hS=de(ms(),1),pS=de(Ha(),1),ft=(0,pS.default)("socket.io-client:socket"),cU=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),Co=class extends hS.Emitter{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[hr(e,"open",this.onopen.bind(this)),hr(e,"packet",this.onpacket.bind(this)),hr(e,"error",this.onerror.bind(this)),hr(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var n,i,s;if(cU.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;let o={type:Oe.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){let f=this.ids++;ft("emitting packet with ack id %d",f);let h=t.pop();this._registerAckCallback(f,h),o.id=f}let l=(i=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||i===void 0?void 0:i.writable,u=this.connected&&!(!((s=this.io.engine)===null||s===void 0)&&s._hasPingExpired());return this.flags.volatile&&!l?ft("discard packet as the transport is not currently writable"):u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o),this.flags={},this}_registerAckCallback(e,t){var n;let i=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(i===void 0){this.acks[e]=t;return}let s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&(ft("removing packet with ack id %d from the buffer",e),this.sendBuffer.splice(l,1));ft("event with ack id %d has timed out after %d ms",e,i),t.call(this,new Error("operation has timed out"))},i),o=(...l)=>{this.io.clearTimeoutFn(s),t.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((n,i)=>{let s=(o,l)=>o?i(o):n(l);s.withError=!0,t.push(s),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());let n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...s)=>n!==this._queue[0]?void 0:(i!==null?n.tryCount>this._opts.retries&&(ft("packet [%d] is discarded after %d tries",n.id,n.tryCount),this._queue.shift(),t&&t(i)):(ft("packet [%d] was successfully sent",n.id),this._queue.shift(),t&&t(null,...s)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(ft("draining queue"),!this.connected||this._queue.length===0)return;let t=this._queue[0];if(t.pending&&!e){ft("packet [%d] has already been sent and is waiting for an ack",t.id);return}t.pending=!0,t.tryCount++,ft("sending packet [%d] (try n\xB0%d)",t.id,t.tryCount),this.flags=t.flags,this.emit.apply(this,t.args)}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){ft("transport is open - connecting"),typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Oe.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){ft("close (%s)",e),this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){let n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Oe.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Oe.EVENT:case Oe.BINARY_EVENT:this.onevent(e);break;case Oe.ACK:case Oe.BINARY_ACK:this.onack(e);break;case Oe.DISCONNECT:this.ondisconnect();break;case Oe.CONNECT_ERROR:this.destroy();let n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){let t=e.data||[];ft("emitting event %j",t),e.id!=null&&(ft("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let t=this._anyListeners.slice();for(let n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){let t=this,n=!1;return function(...i){n||(n=!0,ft("sending ack %j",i),t.packet({type:Oe.ACK,id:e,data:i}))}}onack(e){let t=this.acks[e.id];if(typeof t!="function"){ft("bad ack %s",e.id);return}delete this.acks[e.id],ft("calling ack %s with %j",e.id,e.data),t.withError&&e.data.unshift(null),t.apply(this,e.data)}onconnect(e,t){ft("socket connected with id %s",e),this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){ft("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(ft("performing disconnect (%s)",this.nsp),this.packet({type:Oe.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let t=this._anyOutgoingListeners.slice();for(let n of t)n.apply(this,e.data)}}};function xs(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}xs.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*r);r=(Math.floor(e*10)&1)==0?r-t:r+t}return Math.min(r,this.max)|0};xs.prototype.reset=function(){this.attempts=0};xs.prototype.setMin=function(r){this.ms=r};xs.prototype.setMax=function(r){this.max=r};xs.prototype.setJitter=function(r){this.jitter=r};var mS=de(ms(),1),gS=de(Ha(),1),Ct=(0,gS.default)("socket.io-client:manager"),ko=class extends mS.Emitter{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,jn(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((n=t.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new xs({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;let i=t.parser||Rp;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(Ct("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;Ct("opening %s",this.uri),this.engine=new Eo(this.uri,this.opts);let t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;let i=hr(t,"open",function(){n.onopen(),e&&e()}),s=l=>{Ct("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=hr(t,"error",s);if(this._timeout!==!1){let l=this._timeout;Ct("connect attempt will timeout after %d",l);let u=this.setTimeoutFn(()=>{Ct("connect attempt timed out after %d",l),i(),s(new Error("timeout")),t.close()},l);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){Ct("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(hr(e,"ping",this.onping.bind(this)),hr(e,"data",this.ondata.bind(this)),hr(e,"error",this.onerror.bind(this)),hr(e,"close",this.onclose.bind(this)),hr(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){qn(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){Ct("error",e),this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Co(this,e,t),this.nsps[e]=n),n}_destroy(e){let t=Object.keys(this.nsps);for(let n of t)if(this.nsps[n].active){Ct("socket %s is still active, skipping close",n);return}this._close()}_packet(e){Ct("writing packet %j",e);let t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){Ct("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){Ct("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;Ct("closed due to %s",e),this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)Ct("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();Ct("will wait %dms before reconnect attempt",t),this._reconnecting=!0;let n=this.setTimeoutFn(()=>{e.skipReconnect||(Ct("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(Ct("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):(Ct("reconnect success"),e.onreconnect())}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};var wS=de(Ha(),1),yS=(0,wS.default)("socket.io-client"),Ka={};function Ja(r,e){typeof r=="object"&&(e=r,r=void 0),e=e||{};let t=eS(r,e.path||"/socket.io"),n=t.source,i=t.id,s=t.path,o=Ka[i]&&s in Ka[i].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o,u;return l?(yS("ignoring socket cache for %s",n),u=new ko(n,e)):(Ka[i]||(yS("new io instance for %s",n),Ka[i]=new ko(n,e)),u=Ka[i]),t.query&&!e.query&&(e.query=t.queryKey),u.socket(t.path,e)}Object.assign(Ja,{Manager:ko,Socket:Co,io:Ja,connect:Ja});var bS={id:"socket.io",createTransport:(r,e)=>{let t=Ja(r,{extraHeaders:e});return new Ap(t)}},Ap=class{socket;id="socket.io";onReconnectEmitter=new ir;onDisconnectEmitter=new ir;onErrorEmitter=new ir;disconnectTimeout;ready=new Vr;get onDisconnect(){return this.onDisconnectEmitter.event}get onReconnect(){return this.onReconnectEmitter.event}get onError(){return this.onErrorEmitter.event}constructor(e){this.socket=e,this.socket.on("disconnect",(t,n)=>{this.ready=new Vr,this.disconnectTimeout=setTimeout(()=>{this.onDisconnectEmitter.fire(),this.disconnectTimeout=void 0},3e4)}),this.socket.io.on("reconnect",()=>{this.disconnectTimeout&&(clearTimeout(this.disconnectTimeout),this.disconnectTimeout=void 0,this.ready.resolve()),this.onReconnectEmitter.fire()}),this.socket.on("error",()=>this.onErrorEmitter.fire("Websocket connection closed unexpectedly.")),this.socket.on("connect",()=>this.ready.resolve())}async write(e){await this.ready.promise.then(()=>this.socket.send(e))}read(e){this.socket.on("message",t=>e(t))}dispose(){this.onDisconnectEmitter.dispose(),this.socket.close()}};var Fe;(function(r){function e(n){return Je(n)&&typeof n.code=="string"&&typeof n.message=="string"&&Array.isArray(n.params)&&n.params.every(i=>typeof i=="string")}r.is=e;let t;(function(n){n.PerformingLogin="PerformingLogin",n.InvalidServerVersion="InvalidServerVersion",n.IncompatibleProtocolVersions="IncompatibleProtocolVersions",n.AwaitingServerResponse="AwaitingServerResponse",n.AuthTimeout="AuthTimeout",n.AuthInternalError="AuthInternalError",n.RoomNotFound="RoomNotFound",n.JoinRequestNotFound="JoinRequestNotFound",n.JoinTimeout="JoinTimeout",n.JoinRejected="JoinRejected",n.WaitingForHost="WaitingForHost",n.UnverifiedLoginLabel="UnverifiedLoginLabel",n.UnverifiedLoginDetails="UnverifiedLoginDetails",n.BuiltinsGroup="BuiltinsGroup",n.UsernameLabel="UsernameLabel",n.UsernamePlaceholder="UsernamePlaceholder",n.EmailLabel="EmailLabel",n.EmailPlaceholder="EmailPlaceholder",n.ThirdParty="ThirdParty",n.GitHubLabel="GitHubLabel",n.GoogleLabel="GoogleLabel"})(t=r.Codes||(r.Codes={}))})(Fe||(Fe={}));var Ti=class extends Error{code;params;constructor(e){super(e.message),this.code=e.code,this.params=e.params}};function Ip(r,e){return r instanceof Ti||Fe.is(r)?e?e(r):r.message:r instanceof Error?r.message:String(r)}var vS=r=>{cv(r.cryptoModule)};var Ee;(function(r){let e;(function(o){o.Join=new $r("peer/join"),o.Info=new Ln("peer/info"),o.Init=new Ln("peer/init")})(e=r.Peer||(r.Peer={}));let t;(function(o){o.Joined=new kr("room/joined"),o.Left=new kr("room/left"),o.Leave=new Ln("room/leave"),o.PermissionsUpdated=new kr("room/permissionsUpdated"),o.Closed=new kr("room/closed")})(t=r.Room||(r.Room={}));let n;(function(o){o.Open=new Ln("editor/open"),o.Close=new kr("editor/close")})(n=r.Editor||(r.Editor={}));let i;(function(o){o.DataUpdate=new kr("sync/dataUpdate"),o.DataNotify=new Ln("sync/dataNotify"),o.AwarenessUpdate=new kr("sync/awarenessUpdate"),o.AwarenessQuery=new kr("sync/awarenessQuery"),o.AwarenessNotify=new Ln("sync/awarenessNotify")})(i=r.Sync||(r.Sync={}));let s;(function(o){o.Stat=new $r("fileSystem/stat"),o.Mkdir=new $r("fileSystem/mkdir"),o.ReadFile=new $r("fileSystem/readFile"),o.WriteFile=new $r("fileSystem/writeFile"),o.ReadDir=new $r("fileSystem/readDir"),o.Delete=new $r("fileSystem/delete"),o.Rename=new $r("fileSystem/rename"),o.Change=new kr("fileSystem/change")})(s=r.FileSystem||(r.FileSystem={}))})(Ee||(Ee={}));function _S(r){return new Op(r)}var Au=()=>{},Op=class extends Yl{room={onJoin:e=>this.onBroadcast(Ee.Room.Joined,(t,n)=>{this.onDidJoinRoom(n),e(t,n)}),leave:()=>this.sendNotification(Ee.Room.Leave,""),onLeave:e=>this.onBroadcast(Ee.Room.Left,(t,n)=>{this.onDidLeaveRoom(n),e(t,n)}),onClose:e=>this.onBroadcast(Ee.Room.Closed,t=>{this.onDidClose(),e(t)}),onPermissions:e=>this.onBroadcast(Ee.Room.PermissionsUpdated,e),updatePermissions:e=>this.sendBroadcast(Ee.Room.PermissionsUpdated,e)};peer={onJoinRequest:e=>this.onRequest(Ee.Peer.Join,e),onInfo:e=>this.onNotification(Ee.Peer.Info,e),onInit:e=>this.onNotification(Ee.Peer.Init,async(t,n)=>{this.onDidInit(n),e(t,n)}),init:(e,t)=>this.sendNotification(Ee.Peer.Init,e,t)};fs={onReadFile:e=>this.onRequest(Ee.FileSystem.ReadFile,e),readFile:(e,t)=>this.sendRequest(Ee.FileSystem.ReadFile,e,t),onWriteFile:e=>this.onRequest(Ee.FileSystem.WriteFile,e),writeFile:(e,t,n)=>this.sendRequest(Ee.FileSystem.WriteFile,e,t,n),onReaddir:e=>this.onRequest(Ee.FileSystem.ReadDir,e),readdir:(e,t)=>this.sendRequest(Ee.FileSystem.ReadDir,e,t),onStat:e=>this.onRequest(Ee.FileSystem.Stat,e),stat:(e,t)=>this.sendRequest(Ee.FileSystem.Stat,e,t),onMkdir:e=>this.onRequest(Ee.FileSystem.Mkdir,e),mkdir:(e,t)=>this.sendRequest(Ee.FileSystem.Mkdir,e,t),onDelete:e=>this.onRequest(Ee.FileSystem.Delete,e),delete:(e,t)=>this.sendRequest(Ee.FileSystem.Delete,e,t),onRename:e=>this.onRequest(Ee.FileSystem.Rename,e),rename:(e,t,n)=>this.sendRequest(Ee.FileSystem.Rename,e,t,n),onChange:e=>this.onBroadcast(Ee.FileSystem.Change,e),change:e=>this.sendBroadcast(Ee.FileSystem.Change,e)};editor={onOpen:e=>this.onNotification(Ee.Editor.Open,e),open:(e,t)=>this.sendNotification(Ee.Editor.Open,e,t),onClose:e=>this.onBroadcast(Ee.Editor.Close,e),close:e=>this.sendBroadcast(Ee.Editor.Close,e)};sync={onDataUpdate:e=>{this.onBroadcast(Ee.Sync.DataUpdate,e),this.onNotification(Ee.Sync.DataNotify,e)},dataUpdate:async(e,t)=>{typeof e=="object"?await this.sendBroadcast(Ee.Sync.DataUpdate,e):await this.sendNotification(Ee.Sync.DataNotify,e,t)},onAwarenessUpdate:e=>{this.onBroadcast(Ee.Sync.AwarenessUpdate,e),this.onNotification(Ee.Sync.AwarenessNotify,e)},awarenessUpdate:async(e,t)=>{typeof e=="object"?await this.sendBroadcast(Ee.Sync.AwarenessUpdate,e):await this.sendNotification(Ee.Sync.AwarenessNotify,e,t)},onAwarenessQuery:e=>this.onBroadcast(Ee.Sync.AwarenessQuery,e),awarenessQuery:()=>this.sendBroadcast(Ee.Sync.AwarenessQuery)};peers=new Map;constructor(e){super({privateKey:e.privateKey,transport:e.transport}),e.host?this.onDidJoinRoom(e.host):this.ready(),this.room.onJoin(Au),this.room.onLeave(Au),this.room.onClose(Au),this.peer.onInit(Au)}getPublicKey(e){let t=this.peers.get(e);if(t)return{peerId:t.id,publicKey:t.metadata.encryption.publicKey,supportedCompression:t.metadata.compression.supported};throw new Error("No public key found for origin "+e)}onDidJoinRoom(e){this.peers.set(e.id,e)}onDidLeaveRoom(e){this.peers.delete(e.id)}onDidClose(){this.peers.clear()}onDidInit(e){for(let t of[e.host,...e.guests])this.peers.set(t.id,t);this.ready()}getPublicKeys(){return Array.from(this.peers.values()).map(e=>({peerId:e.id,publicKey:e.metadata.encryption.publicKey,supportedCompression:e.metadata.compression.supported}))}getPublicKeysLength(){return this.peers.size}};var Pp=de(Kd(),1);var Qa;(function(r){function e(n){return Je(n)&&typeof n.roomId=="string"&&typeof n.roomToken=="string"}r.is=e;function t(n,i,s){return{roomId:n,roomToken:i,loginToken:s}}r.create=t})(Qa||(Qa={}));var Iu;(function(r){function e(n){return Je(n)&&typeof n.valid=="boolean"}r.is=e;function t(n){return{valid:n}}r.create=t})(Iu||(Iu={}));var Ou;(function(r){function e(n){return Je(n)&&typeof n.pollToken=="string"&&typeof n.auth=="object"}r.is=e;function t(n,i){return{pollToken:n,auth:i}}r.create=t})(Ou||(Ou={}));var Du;(function(r){function e(n){return Je(n)&&(typeof n.loginToken>"u"||typeof n.loginToken=="string")}r.is=e;function t(n){return{loginToken:n}}r.create=t})(Du||(Du={}));var Pu;(function(r){function e(n){return Je(n)&&typeof n.pollToken=="string"&&typeof n.roomId=="string"}r.is=e;function t(n,i){return{pollToken:n,roomId:i}}r.create=t})(Pu||(Pu={}));var Uu;(function(r){function e(n){return Je(n)&&typeof n.roomId=="string"&&typeof n.roomToken=="string"&&typeof n.workspace=="object"&&typeof n.host=="object"}r.is=e;function t(n,i,s,o){return{roomId:n,roomToken:i,workspace:s,host:o}}r.create=t})(Uu||(Uu={}));var Lu;(function(r){function e(n){return Dp.is(n)&&typeof n.failure=="boolean"}r.is=e;function t(n,i,s,o){return{code:n,params:i,message:s,failure:o}}r.create=t})(Lu||(Lu={}));var Dp;(function(r){function e(n){return Je(n)&&typeof n.code=="string"&&Array.isArray(n.params)&&n.params.every(i=>typeof i=="string")&&typeof n.message=="string"}r.is=e;function t(n,i,s){return{code:n,params:i,message:s}}r.create=t})(Dp||(Dp={}));var SS;(function(r){r[r.Readonly=1]="Readonly"})(SS||(SS={}));var Xa;(function(r){r[r.Unknown=0]="Unknown",r[r.File=1]="File",r[r.Directory=2]="Directory",r[r.SymbolicLink=64]="SymbolicLink"})(Xa||(Xa={}));var Gn;(function(r){r[r.Create=0]="Create",r[r.Update=1]="Update",r[r.Delete=2]="Delete"})(Gn||(Gn={}));var Za;(function(r){function e(t){if(!t)return!1;let n=t;return Array.isArray(n.textSelections)}r.is=e})(Za||(Za={}));var Ri;(function(r){r.LeftToRight=1,r.RightToLeft=2})(Ri||(Ri={}));var Fu;(function(r){function e(n){return n&&typeof n.line=="number"&&typeof n.character=="number"}r.is=e;function t(n,i){return{line:n,character:i}}r.create=t})(Fu||(Fu={}));var xS;(function(r){function e(n){return n&&Fu.is(n.start)&&Fu.is(n.end)}r.is=e;function t(n,i){return{start:n,end:i}}r.create=t})(xS||(xS={}));var Nu=class{options;fetch;protocolVersion;constructor(e){if(this.options=e,this.fetch=e.fetch,this.userAuthToken=e.userToken,e.protocolVersion){let t=Pp.parse(e.protocolVersion);if(!t)throw new Error("Invalid protocol version provided: "+e.protocolVersion);this.protocolVersion=t}else this.protocolVersion=Jd}userAuthToken;roomAuthToken;get authToken(){return this.userAuthToken}getUrl(e){let t=this.options.url;return t.endsWith("/")&&(t=t.slice(0,-1)),e.startsWith("/")&&(e=e.slice(1)),`${t}/${e}`}async login(e){e.reporter?.({code:"PerformingLogin",params:[],message:"Performing login"});let t=await this.fetch(this.getUrl("/api/login/initial"),{signal:e.abortSignal,method:"POST"});if(!t.ok)throw new Error("Failed to get login URL");let n=await t.json();if(!Ou.is(n))throw new Error("Invalid login response");let i=n.pollToken,s=n.auth.loginPageUrl,o=s?.startsWith("/")?this.getUrl(s):s,l=new AbortController,u=this.mergeAbortSignals(e.abortSignal,l.signal);this.options.authenticationHandler(i,{...n.auth,loginPageUrl:o}).then(f=>{f||l.abort()},()=>l.abort());let d=await this.pollLogin(i,{...e,abortSignal:u});return this.userAuthToken=d,d}async pollLogin(e,t){for(;;){let n=await this.fetch(this.getUrl(`/api/login/poll/${e}`),{signal:t.abortSignal,method:"POST"});if(n.ok)try{let i=await n.json();if(Du.is(i)&&i.loginToken)return i.loginToken}catch{}else throw await this.readError(n)}}async ensureCompatibility(){let e=await this.getMetaData(),t=Pp.parse(e.version);if(!t)throw new Ti({code:"InvalidServerVersion",message:"Invalid protocol version returned by server: "+e.version,params:[e.version]});if(!Sw(t,this.protocolVersion))throw new Ti({code:"IncompatibleProtocolVersions",message:`Incompatible protocol versions: client ${this.protocolVersion.format()}, server ${t.format()}`,params:[this.protocolVersion.format(),t.format()]})}async validate(){if(this.userAuthToken)try{let t=await(await this.fetch(this.getUrl("/api/login/validate"),{method:"POST",headers:{"x-oct-jwt":this.userAuthToken}})).json();if(Iu.is(t))return t.valid}catch{return!1}return!1}async createRoom(e){await this.ensureCompatibility();let t=await this.validate(),n;t||(n=await this.login({abortSignal:e.abortSignal,reporter:e.reporter})),e.reporter?.({code:"AwaitingServerResponse",params:[],message:"Awaiting server response"});let i=await this.fetch(this.getUrl("/api/session/create"),{method:"POST",signal:e.abortSignal,headers:{"x-oct-jwt":this.userAuthToken}});if(!i.ok)throw await this.readError(i);let s=await i.json();if(!Qa.is(s))throw new Error("Invalid create room response");return Qa.create(s.roomId,s.roomToken,n)}async joinRoom(e){await this.ensureCompatibility();let t=await this.validate(),n;t||(n=await this.login({abortSignal:e.abortSignal,reporter:e.reporter})),e.reporter?.({code:"AwaitingServerResponse",params:[],message:"Awaiting server response"});let i=await this.fetch(this.getUrl(`/api/session/join/${e.roomId}`),{method:"POST",signal:e.abortSignal,headers:{"x-oct-jwt":this.userAuthToken}});if(!i.ok)throw await this.readError(i);let s=await i.json();if(!Pu.is(s))throw new Error("Invalid join room response");let o=s.pollToken,l=await this.pollJoin(o,e);return{loginToken:n,roomId:l.roomId,roomToken:l.roomToken,workspace:l.workspace,host:l.host}}async pollJoin(e,t){for(;;){let n=await this.fetch(this.getUrl(`/api/session/poll/${e}`),{method:"POST",signal:t.abortSignal,headers:{"x-oct-jwt":this.userAuthToken}});if(n.ok){let i=await n.json();if(Lu.is(i)){if(i.failure)throw new Ti({code:i.code,params:i.params,message:i.message});t.reporter?.(i)}else{if(Uu.is(i))return i;throw new Error("Received invalid join room poll response")}}else throw await this.readError(n)}}async readError(e){try{let t=await e.text();try{let n=JSON.parse(t);return Fe.is(n)?new Ti(n):new Error(t)}catch{return new Error(t)}}catch{return new Error("Unknown error")}}async connect(e,t){let n=await this.getMetaData(),i=this.findFitting(n.transports,this.options.transports.map(d=>d.id)),s=this.options.transports[i],o=await Nt.generateKeyPair(),l=s.createTransport(this.options.url,{"x-oct-jwt":e,"x-oct-public-key":o.publicKey,"x-oct-client":this.options.client??"Unknown OCT JS Client","x-oct-compression":"gzip"});return _S({privateKey:o.privateKey,transport:l,host:t})}async getMetaData(){let e=await this.fetch(this.getUrl("/api/meta"));if(!e.ok)throw new Error("Failed to fetch metadata");return await e.json()}findFitting(e,t){let n=new Set(e);for(let i=0;i<t.length;i++)if(n.has(t[i]))return i;return-1}mergeAbortSignals(...e){let t=new AbortController;for(let n of e)if(n){if(n.aborted)return n;n.addEventListener("abort",()=>{t.abort()})}return t.signal}};var K=de(require("vscode"));var It=()=>new Map,Bu=r=>{let e=It();return r.forEach((t,n)=>{e.set(n,t)}),e},Jr=(r,e,t)=>{let n=r.get(e);return n===void 0&&r.set(e,n=t()),n};var ES=(r,e)=>{for(let[t,n]of r)if(e(n,t))return!0;return!1};var Ai=()=>new Set;var Mu=r=>r[r.length-1];var kS=(r,e)=>{for(let t=0;t<e.length;t++)r.push(e[t])},Qr=Array.from;var Lp=Array.isArray;var To=class{constructor(){this._observers=It()}on(e,t){return Jr(this._observers,e,Ai).add(t),t}once(e,t){let n=(...i)=>{this.off(e,n),t(...i)};this.on(e,n)}off(e,t){let n=this._observers.get(e);n!==void 0&&(n.delete(t),n.size===0&&this._observers.delete(e))}emit(e,t){return Qr((this._observers.get(e)||It()).values()).forEach(n=>n(...t))}destroy(){this._observers=It()}},qu=class{constructor(){this._observers=It()}on(e,t){Jr(this._observers,e,Ai).add(t)}once(e,t){let n=(...i)=>{this.off(e,n),t(...i)};this.on(e,n)}off(e,t){let n=this._observers.get(e);n!==void 0&&(n.delete(t),n.size===0&&this._observers.delete(e))}emit(e,t){return Qr((this._observers.get(e)||It()).values()).forEach(n=>n(...t))}destroy(){this._observers=It()}};var Yt=Math.floor;var Ro=Math.abs;var ju=(r,e)=>r<e?r:e,Yn=(r,e)=>r>e?r:e,mq=Number.isNaN;var $u=r=>r!==0?r<0:1/r<0;var Np=Number.MAX_SAFE_INTEGER,gq=Number.MIN_SAFE_INTEGER,yq=1<<31;var TS=Number.isInteger||(r=>typeof r=="number"&&isFinite(r)&&Yt(r)===r),wq=Number.isNaN,bq=Number.parseInt;var fU=String.fromCharCode,vq=String.fromCodePoint,_q=fU(65535),dU=r=>r.toLowerCase(),hU=/^\s*/g,pU=r=>r.replace(hU,""),mU=/([A-Z])/g,Bp=(r,e)=>pU(r.replace(mU,t=>`${e}${dU(t)}`));var gU=r=>{let e=unescape(encodeURIComponent(r)),t=e.length,n=new Uint8Array(t);for(let i=0;i<t;i++)n[i]=e.codePointAt(i);return n},Io=typeof TextEncoder<"u"?new TextEncoder:null,yU=r=>Io.encode(r),AS=Io?yU:gU;var Ao=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Ao&&Ao.decode(new Uint8Array).length===1&&(Ao=null);var Es=class{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}},Ot=()=>new Es;var wU=r=>{let e=r.cpos;for(let t=0;t<r.bufs.length;t++)e+=r.bufs[t].length;return e};var qt=r=>{let e=new Uint8Array(wU(r)),t=0;for(let n=0;n<r.bufs.length;n++){let i=r.bufs[n];e.set(i,t),t+=i.length}return e.set(new Uint8Array(r.cbuf.buffer,0,r.cpos),t),e},bU=(r,e)=>{let t=r.cbuf.length;t-r.cpos<e&&(r.bufs.push(new Uint8Array(r.cbuf.buffer,0,r.cpos)),r.cbuf=new Uint8Array(Yn(t,e)*2),r.cpos=0)},_t=(r,e)=>{let t=r.cbuf.length;r.cpos===t&&(r.bufs.push(r.cbuf),r.cbuf=new Uint8Array(t*2),r.cpos=0),r.cbuf[r.cpos++]=e};var Wu=_t;var be=(r,e)=>{for(;e>127;)_t(r,128|127&e),e=Yt(e/128);_t(r,127&e)},zu=(r,e)=>{let t=$u(e);for(t&&(e=-e),_t(r,(e>63?128:0)|(t?64:0)|63&e),e=Yt(e/64);e>0;)_t(r,(e>127?128:0)|127&e),e=Yt(e/128)},qp=new Uint8Array(3e4),vU=qp.length/3,_U=(r,e)=>{if(e.length<vU){let t=Io.encodeInto(e,qp).written||0;be(r,t);for(let n=0;n<t;n++)_t(r,qp[n])}else tt(r,AS(e))},SU=(r,e)=>{let t=unescape(encodeURIComponent(e)),n=t.length;be(r,n);for(let i=0;i<n;i++)_t(r,t.codePointAt(i))},Kn=Io&&Io.encodeInto?_U:SU;var rc=(r,e)=>{let t=r.cbuf.length,n=r.cpos,i=ju(t-n,e.length),s=e.length-i;r.cbuf.set(e.subarray(0,i),n),r.cpos+=i,s>0&&(r.bufs.push(r.cbuf),r.cbuf=new Uint8Array(Yn(t*2,s)),r.cbuf.set(e.subarray(i)),r.cpos=s)},tt=(r,e)=>{be(r,e.byteLength),rc(r,e)},jp=(r,e)=>{bU(r,e);let t=new DataView(r.cbuf.buffer,r.cpos,e);return r.cpos+=e,t},xU=(r,e)=>jp(r,4).setFloat32(0,e,!1),EU=(r,e)=>jp(r,8).setFloat64(0,e,!1),CU=(r,e)=>jp(r,8).setBigInt64(0,e,!1);var OS=new DataView(new ArrayBuffer(4)),kU=r=>(OS.setFloat32(0,r),OS.getFloat32(0)===r),Do=(r,e)=>{switch(typeof e){case"string":_t(r,119),Kn(r,e);break;case"number":TS(e)&&Ro(e)<=2147483647?(_t(r,125),zu(r,e)):kU(e)?(_t(r,124),xU(r,e)):(_t(r,123),EU(r,e));break;case"bigint":_t(r,122),CU(r,e);break;case"object":if(e===null)_t(r,126);else if(Lp(e)){_t(r,117),be(r,e.length);for(let t=0;t<e.length;t++)Do(r,e[t])}else if(e instanceof Uint8Array)_t(r,116),tt(r,e);else{_t(r,118);let t=Object.keys(e);be(r,t.length);for(let n=0;n<t.length;n++){let i=t[n];Kn(r,i),Do(r,e[i])}}break;case"boolean":_t(r,e?120:121);break;default:_t(r,127)}},tc=class extends Es{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&be(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}};var DS=r=>{r.count>0&&(zu(r.encoder,r.count===1?r.s:-r.s),r.count>1&&be(r.encoder,r.count-2))},Cs=class{constructor(){this.encoder=new Es,this.s=0,this.count=0}write(e){this.s===e?this.count++:(DS(this),this.count=1,this.s=e)}toUint8Array(){return DS(this),qt(this.encoder)}};var PS=r=>{if(r.count>0){let e=r.diff*2+(r.count===1?0:1);zu(r.encoder,e),r.count>1&&be(r.encoder,r.count-2)}},Po=class{constructor(){this.encoder=new Es,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(PS(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return PS(this),qt(this.encoder)}},Vu=class{constructor(){this.sarr=[],this.s="",this.lensE=new Cs}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){let e=new Es;return this.sarr.push(this.s),this.s="",Kn(e,this.sarr.join("")),rc(e,this.lensE.toUint8Array()),qt(e)}};var vn=r=>new Error(r),Xr=()=>{throw vn("Method unimplemented")},Dr=()=>{throw vn("Unexpected case")};var LS=vn("Unexpected end of array"),FS=vn("Integer out of Range"),Uo=class{constructor(e){this.arr=e,this.pos=0}},Zr=r=>new Uo(r),NS=r=>r.pos!==r.arr.length;var TU=(r,e)=>{let t=new Uint8Array(r.arr.buffer,r.pos+r.arr.byteOffset,e);return r.pos+=e,t},dt=r=>TU(r,ve(r));var ks=r=>r.arr[r.pos++];var ve=r=>{let e=0,t=1,n=r.arr.length;for(;r.pos<n;){let i=r.arr[r.pos++];if(e=e+(i&127)*t,t*=128,i<128)return e;if(e>Np)throw FS}throw LS},Yu=r=>{let e=r.arr[r.pos++],t=e&63,n=64,i=(e&64)>0?-1:1;if((e&128)===0)return i*t;let s=r.arr.length;for(;r.pos<s;){if(e=r.arr[r.pos++],t=t+(e&127)*n,n*=128,e<128)return i*t;if(t>Np)throw FS}throw LS};var RU=r=>{let e=ve(r);if(e===0)return"";{let t=String.fromCodePoint(ks(r));if(--e<100)for(;e--;)t+=String.fromCodePoint(ks(r));else for(;e>0;){let n=e<1e4?e:1e4,i=r.arr.subarray(r.pos,r.pos+n);r.pos+=n,t+=String.fromCodePoint.apply(null,i),e-=n}return decodeURIComponent(escape(t))}},AU=r=>Ao.decode(dt(r)),Jn=Ao?AU:RU;var $p=(r,e)=>{let t=new DataView(r.arr.buffer,r.arr.byteOffset+r.pos,e);return r.pos+=e,t},IU=r=>$p(r,4).getFloat32(0,!1),OU=r=>$p(r,8).getFloat64(0,!1),DU=r=>$p(r,8).getBigInt64(0,!1);var PU=[r=>{},r=>null,Yu,IU,OU,DU,r=>!1,r=>!0,Jn,r=>{let e=ve(r),t={};for(let n=0;n<e;n++){let i=Jn(r);t[i]=Lo(r)}return t},r=>{let e=ve(r),t=[];for(let n=0;n<e;n++)t.push(Lo(r));return t},dt],Lo=r=>PU[127-ks(r)](r),nc=class extends Uo{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),NS(this)?this.count=ve(this)+1:this.count=-1),this.count--,this.s}};var Ts=class extends Uo{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=Yu(this);let e=$u(this.s);this.count=1,e&&(this.s=-this.s,this.count=ve(this)+2)}return this.count--,this.s}};var Fo=class extends Uo{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){let e=Yu(this),t=e&1;this.diff=Yt(e/2),this.count=1,t&&(this.count=ve(this)+2)}return this.s+=this.diff,this.count--,this.s}},Gu=class{constructor(e){this.decoder=new Ts(e),this.str=Jn(this.decoder),this.spos=0}read(){let e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}};var Ju=require("node:crypto"),Eq=Ju.webcrypto.subtle,BS=Ju.webcrypto.getRandomValues.bind(Ju.webcrypto);var Vp=()=>BS(new Uint32Array(1))[0];var UU="10000000-1000-4000-8000"+-1e11,MS=()=>UU.replace(/[018]/g,r=>(r^Vp()&15>>r/4).toString(16));var Rs=Date.now;var Wp=r=>new Promise(r);var Tq=Promise.all.bind(Promise);var zp=r=>r===void 0?null:r;var Hp=class{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}},jS=new Hp,BU=!0;try{typeof localStorage<"u"&&localStorage&&(jS=localStorage,BU=!1)}catch{}var $S=jS;var WS=Object.assign,zS=Object.keys,HS=(r,e)=>{for(let t in r)e(r[t],t)};var Gp=r=>zS(r).length,VS=r=>zS(r).length;var GS=r=>{for(let e in r)return!1;return!0},qU=(r,e)=>{for(let t in r)if(!e(r[t],t))return!1;return!0},Yp=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),Kp=(r,e)=>r===e||VS(r)===VS(e)&&qU(r,(t,n)=>(t!==void 0||Yp(e,n))&&e[n]===t),jU=Object.freeze,Jp=r=>{for(let e in r){let t=r[e];(typeof t=="object"||typeof t=="function")&&Jp(r[e])}return jU(r)};var ic=(r,e,t=0)=>{try{for(;t<r.length;t++)r[t](...e)}finally{t<r.length&&ic(r,e,t+1)}};var KS=r=>r,$U=(r,e)=>r===e;var No=(r,e)=>{if(r==null||e==null)return $U(r,e);if(r.constructor!==e.constructor)return!1;if(r===e)return!0;switch(r.constructor){case ArrayBuffer:r=new Uint8Array(r),e=new Uint8Array(e);case Uint8Array:{if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;break}case Set:{if(r.size!==e.size)return!1;for(let t of r)if(!e.has(t))return!1;break}case Map:{if(r.size!==e.size)return!1;for(let t of r.keys())if(!e.has(t)||!No(r.get(t),e.get(t)))return!1;break}case Object:if(Gp(r)!==Gp(e))return!1;for(let t in r)if(!Yp(r,t)||!No(r[t],e[t]))return!1;break;case Array:if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(!No(r[t],e[t]))return!1;break;default:return!1}return!0},JS=(r,e)=>e.includes(r);var sc=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";var Rq=typeof navigator<"u"?/Mac/.test(navigator.platform):!1,_n,VU=[],WU=()=>{if(_n===void 0)if(sc){_n=It();let r=process.argv,e=null;for(let t=0;t<r.length;t++){let n=r[t];n[0]==="-"?(e!==null&&_n.set(e,""),e=n):e!==null?(_n.set(e,n),e=null):VU.push(n)}e!==null&&_n.set(e,"")}else typeof location=="object"?(_n=It(),(location.search||"?").slice(1).split("&").forEach(r=>{if(r.length!==0){let[e,t]=r.split("=");_n.set(`--${Bp(e,"-")}`,t),_n.set(`-${Bp(e,"-")}`,t)}})):_n=It();return _n},Xp=r=>WU().has(r);var oc=r=>sc?zp(process.env[r.toUpperCase().replaceAll("-","_")]):zp($S.getItem(r));var QS=r=>Xp("--"+r)||oc(r)!==null,Aq=QS("production"),zU=sc&&JS(process.env.FORCE_COLOR,["true","1","2"]),XS=zU||!Xp("--no-colors")&&!QS("no-color")&&(!sc||process.stdout.isTTY)&&(!sc||Xp("--color")||oc("COLORTERM")!==null||(oc("TERM")||"").includes("color"));var HU=r=>new Uint8Array(r);var ex=r=>{let e=HU(r.byteLength);return e.set(r),e};var Sn=Symbol;var ac=Sn(),cc=Sn(),Zp=Sn(),em=Sn(),tm=Sn(),lc=Sn(),rm=Sn(),uc=Sn(),nm=Sn(),tx=r=>{r.length===1&&r[0]?.constructor===Function&&(r=r[0]());let e=[],t=[],n=0;for(;n<r.length;n++){let i=r[n];if(i===void 0)break;if(i.constructor===String||i.constructor===Number)e.push(i);else if(i.constructor===Object)break}for(n>0&&t.push(e.join(""));n<r.length;n++){let i=r[n];i instanceof Symbol||t.push(i)}return t};var Iq=Rs();var JU={[ac]:"\x1B[1m",[cc]:"\x1B[2m",[Zp]:"\x1B[34m",[tm]:"\x1B[32m",[em]:"\x1B[37m",[lc]:"\x1B[31m",[rm]:"\x1B[35m",[uc]:"\x1B[38;5;208m",[nm]:"\x1B[0m"},QU=r=>{r.length===1&&r[0]?.constructor===Function&&(r=r[0]());let e=[],t=[],n=0;for(;n<r.length;n++){let i=r[n],s=JU[i];if(s!==void 0)e.push(s);else{if(i===void 0)break;if(i.constructor===String||i.constructor===Number)e.push(i);else break}}for(n>0&&(e.push("\x1B[0m"),t.push(e.join("")));n<r.length;n++){let i=r[n];i instanceof Symbol||t.push(i)}return t},rx=XS?QU:tx,nx=(...r)=>{console.log(...rx(r))},ix=(...r)=>{console.warn(...rx(r))};var sx=r=>({[Symbol.iterator](){return this},next:r}),ox=(r,e)=>sx(()=>{let t;do t=r.next();while(!t.done&&!e(t.value));return t}),Qu=(r,e)=>sx(()=>{let{done:t,value:n}=r.next();return{done:t,value:t?void 0:e(n)}});var dc=class{constructor(e,t){this.clock=e,this.len=t}},As=class{constructor(){this.clients=new Map}},_x=(r,e,t)=>e.clients.forEach((n,i)=>{let s=r.doc.store.clients.get(i);for(let o=0;o<n.length;o++){let l=n[o];Ux(r,s,l.clock,l.len,t)}}),rL=(r,e)=>{let t=0,n=r.length-1;for(;t<=n;){let i=Yt((t+n)/2),s=r[i],o=s.clock;if(o<=e){if(e<o+s.len)return i;t=i+1}else n=i-1}return null},Sx=(r,e)=>{let t=r.clients.get(e.client);return t!==void 0&&rL(t,e.clock)!==null},Sm=r=>{r.clients.forEach(e=>{e.sort((i,s)=>i.clock-s.clock);let t,n;for(t=1,n=1;t<e.length;t++){let i=e[n-1],s=e[t];i.clock+i.len>=s.clock?i.len=Yn(i.len,s.clock+s.len-i.clock):(n<t&&(e[n]=s),n++)}e.length=n})},nL=r=>{let e=new As;for(let t=0;t<r.length;t++)r[t].clients.forEach((n,i)=>{if(!e.clients.has(i)){let s=n.slice();for(let o=t+1;o<r.length;o++)kS(s,r[o].clients.get(i)||[]);e.clients.set(i,s)}});return Sm(e),e},sf=(r,e,t,n)=>{Jr(r.clients,e,()=>[]).push(new dc(t,n))},xx=()=>new As,iL=r=>{let e=xx();return r.clients.forEach((t,n)=>{let i=[];for(let s=0;s<t.length;s++){let o=t[s];if(o.deleted){let l=o.id.clock,u=o.length;if(s+1<t.length)for(let d=t[s+1];s+1<t.length&&d.deleted;d=t[++s+1])u+=d.length;i.push(new dc(l,u))}}i.length>0&&e.clients.set(n,i)}),e},Vo=(r,e)=>{be(r.restEncoder,e.clients.size),Qr(e.clients.entries()).sort((t,n)=>n[0]-t[0]).forEach(([t,n])=>{r.resetDsCurVal(),be(r.restEncoder,t);let i=n.length;be(r.restEncoder,i);for(let s=0;s<i;s++){let o=n[s];r.writeDsClock(o.clock),r.writeDsLen(o.len)}})},xm=r=>{let e=new As,t=ve(r.restDecoder);for(let n=0;n<t;n++){r.resetDsCurVal();let i=ve(r.restDecoder),s=ve(r.restDecoder);if(s>0){let o=Jr(e.clients,i,()=>[]);for(let l=0;l<s;l++)o.push(new dc(r.readDsClock(),r.readDsLen()))}}return e},lx=(r,e,t)=>{let n=new As,i=ve(r.restDecoder);for(let s=0;s<i;s++){r.resetDsCurVal();let o=ve(r.restDecoder),l=ve(r.restDecoder),u=t.clients.get(o)||[],d=ct(t,o);for(let f=0;f<l;f++){let h=r.readDsClock(),m=h+r.readDsLen();if(h<d){d<m&&sf(n,o,d,m-d);let g=xn(u,h),y=u[g];for(!y.deleted&&y.id.clock<h&&(u.splice(g+1,0,gf(e,y,h-y.id.clock)),g++);g<u.length&&(y=u[g++],y.id.clock<m);)y.deleted||(m<y.id.clock+y.length&&u.splice(g,0,gf(e,y,m-y.id.clock)),y.delete(e))}else sf(n,o,h,m-h)}}if(n.clients.size>0){let s=new Qn;return be(s.restEncoder,0),Vo(s,n),s.toUint8Array()}return null};var Ex=Vp,Is=class r extends To{constructor({guid:e=MS(),collectionid:t=null,gc:n=!0,gcFilter:i=()=>!0,meta:s=null,autoLoad:o=!1,shouldLoad:l=!0}={}){super(),this.gc=n,this.gcFilter=i,this.clientID=Ex(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new uf,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=l,this.autoLoad=o,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=Wp(d=>{this.on("load",()=>{this.isLoaded=!0,d(this)})});let u=()=>Wp(d=>{let f=h=>{(h===void 0||h===!0)&&(this.off("sync",f),d())};this.on("sync",f)});this.on("sync",d=>{d===!1&&this.isSynced&&(this.whenSynced=u()),this.isSynced=d===void 0||d===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=u()}load(){let e=this._item;e!==null&&!this.shouldLoad&&ze(e.parent.doc,t=>{t.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Qr(this.subdocs).map(e=>e.guid))}transact(e,t=null){return ze(this,e,t)}get(e,t=ht){let n=Jr(this.share,e,()=>{let s=new t;return s._integrate(this,null),s}),i=n.constructor;if(t!==ht&&i!==t)if(i===ht){let s=new t;s._map=n._map,n._map.forEach(o=>{for(;o!==null;o=o.left)o.parent=s}),s._start=n._start;for(let o=s._start;o!==null;o=o.right)o.parent=s;return s._length=n._length,this.share.set(e,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return n}getArray(e=""){return this.get(e,pf)}getText(e=""){return this.get(e,bc)}getMap(e=""){return this.get(e,yc)}getXmlElement(e=""){return this.get(e,vc)}getXmlFragment(e=""){return this.get(e,jo)}toJSON(){let e={};return this.share.forEach((t,n)=>{e[n]=t.toJSON()}),e}destroy(){this.isDestroyed=!0,Qr(this.subdocs).forEach(t=>t.destroy());let e=this._item;if(e!==null){this._item=null;let t=e.content;t.doc=new r({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,ze(e.parent.doc,n=>{let i=t.doc;e.deleted||n.subdocsAdded.add(i),n.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}},of=class{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return ve(this.restDecoder)}readDsLen(){return ve(this.restDecoder)}},af=class extends of{readLeftID(){return Re(ve(this.restDecoder),ve(this.restDecoder))}readRightID(){return Re(ve(this.restDecoder),ve(this.restDecoder))}readClient(){return ve(this.restDecoder)}readInfo(){return ks(this.restDecoder)}readString(){return Jn(this.restDecoder)}readParentInfo(){return ve(this.restDecoder)===1}readTypeRef(){return ve(this.restDecoder)}readLen(){return ve(this.restDecoder)}readAny(){return Lo(this.restDecoder)}readBuf(){return ex(dt(this.restDecoder))}readJSON(){return JSON.parse(Jn(this.restDecoder))}readKey(){return Jn(this.restDecoder)}},sm=class{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=ve(this.restDecoder),this.dsCurrVal}readDsLen(){let e=ve(this.restDecoder)+1;return this.dsCurrVal+=e,e}},Ui=class extends sm{constructor(e){super(e),this.keys=[],ve(e),this.keyClockDecoder=new Fo(dt(e)),this.clientDecoder=new Ts(dt(e)),this.leftClockDecoder=new Fo(dt(e)),this.rightClockDecoder=new Fo(dt(e)),this.infoDecoder=new nc(dt(e),ks),this.stringDecoder=new Gu(dt(e)),this.parentInfoDecoder=new nc(dt(e),ks),this.typeRefDecoder=new Ts(dt(e)),this.lenDecoder=new Ts(dt(e))}readLeftID(){return new Pi(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Pi(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return Lo(this.restDecoder)}readBuf(){return dt(this.restDecoder)}readJSON(){return Lo(this.restDecoder)}readKey(){let e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{let t=this.stringDecoder.read();return this.keys.push(t),t}}},cf=class{constructor(){this.restEncoder=Ot()}toUint8Array(){return qt(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){be(this.restEncoder,e)}writeDsLen(e){be(this.restEncoder,e)}},Os=class extends cf{writeLeftID(e){be(this.restEncoder,e.client),be(this.restEncoder,e.clock)}writeRightID(e){be(this.restEncoder,e.client),be(this.restEncoder,e.clock)}writeClient(e){be(this.restEncoder,e)}writeInfo(e){Wu(this.restEncoder,e)}writeString(e){Kn(this.restEncoder,e)}writeParentInfo(e){be(this.restEncoder,e?1:0)}writeTypeRef(e){be(this.restEncoder,e)}writeLen(e){be(this.restEncoder,e)}writeAny(e){Do(this.restEncoder,e)}writeBuf(e){tt(this.restEncoder,e)}writeJSON(e){Kn(this.restEncoder,JSON.stringify(e))}writeKey(e){Kn(this.restEncoder,e)}},lf=class{constructor(){this.restEncoder=Ot(),this.dsCurrVal=0}toUint8Array(){return qt(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){let t=e-this.dsCurrVal;this.dsCurrVal=e,be(this.restEncoder,t)}writeDsLen(e){e===0&&Dr(),be(this.restEncoder,e-1),this.dsCurrVal+=e}},Qn=class extends lf{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Po,this.clientEncoder=new Cs,this.leftClockEncoder=new Po,this.rightClockEncoder=new Po,this.infoEncoder=new tc(Wu),this.stringEncoder=new Vu,this.parentInfoEncoder=new tc(Wu),this.typeRefEncoder=new Cs,this.lenEncoder=new Cs}toUint8Array(){let e=Ot();return be(e,0),tt(e,this.keyClockEncoder.toUint8Array()),tt(e,this.clientEncoder.toUint8Array()),tt(e,this.leftClockEncoder.toUint8Array()),tt(e,this.rightClockEncoder.toUint8Array()),tt(e,qt(this.infoEncoder)),tt(e,this.stringEncoder.toUint8Array()),tt(e,qt(this.parentInfoEncoder)),tt(e,this.typeRefEncoder.toUint8Array()),tt(e,this.lenEncoder.toUint8Array()),rc(e,qt(this.restEncoder)),qt(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){Do(this.restEncoder,e)}writeBuf(e){tt(this.restEncoder,e)}writeJSON(e){Do(this.restEncoder,e)}writeKey(e){let t=this.keyMap.get(e);t===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}},sL=(r,e,t,n)=>{n=Yn(n,e[0].id.clock);let i=xn(e,n);be(r.restEncoder,e.length-i),r.writeClient(t),be(r.restEncoder,n);let s=e[i];s.write(r,n-s.id.clock);for(let o=i+1;o<e.length;o++)e[o].write(r,0)},Em=(r,e,t)=>{let n=new Map;t.forEach((i,s)=>{ct(e,s)>i&&n.set(s,i)}),yf(e).forEach((i,s)=>{t.has(s)||n.set(s,0)}),be(r.restEncoder,n.size),Qr(n.entries()).sort((i,s)=>s[0]-i[0]).forEach(([i,s])=>{sL(r,e.clients.get(i),i,s)})},oL=(r,e)=>{let t=It(),n=ve(r.restDecoder);for(let i=0;i<n;i++){let s=ve(r.restDecoder),o=new Array(s),l=r.readClient(),u=ve(r.restDecoder);t.set(l,{i:0,refs:o});for(let d=0;d<s;d++){let f=r.readInfo();switch(31&f){case 0:{let h=r.readLen();o[d]=new Kt(Re(l,u),h),u+=h;break}case 10:{let h=ve(r.restDecoder);o[d]=new Jt(Re(l,u),h),u+=h;break}default:{let h=(f&192)===0,m=new ot(Re(l,u),null,(f&128)===128?r.readLeftID():null,null,(f&64)===64?r.readRightID():null,h?r.readParentInfo()?e.get(r.readString()):r.readLeftID():null,h&&(f&32)===32?r.readString():null,Zx(r,f));o[d]=m,u+=m.length}}}}return t},aL=(r,e,t)=>{let n=[],i=Qr(t.keys()).sort((g,y)=>g-y);if(i.length===0)return null;let s=()=>{if(i.length===0)return null;let g=t.get(i[i.length-1]);for(;g.refs.length===g.i;)if(i.pop(),i.length>0)g=t.get(i[i.length-1]);else return null;return g},o=s();if(o===null)return null;let l=new uf,u=new Map,d=(g,y)=>{let b=u.get(g);(b==null||b>y)&&u.set(g,y)},f=o.refs[o.i++],h=new Map,m=()=>{for(let g of n){let y=g.id.client,b=t.get(y);b?(b.i--,l.clients.set(y,b.refs.slice(b.i)),t.delete(y),b.i=0,b.refs=[]):l.clients.set(y,[g]),i=i.filter(C=>C!==y)}n.length=0};for(;;){if(f.constructor!==Jt){let y=Jr(h,f.id.client,()=>ct(e,f.id.client))-f.id.clock;if(y<0)n.push(f),d(f.id.client,f.id.clock-1),m();else{let b=f.getMissing(r,e);if(b!==null){n.push(f);let C=t.get(b)||{refs:[],i:0};if(C.refs.length===C.i)d(b,ct(e,b)),m();else{f=C.refs[C.i++];continue}}else(y===0||y<f.length)&&(f.integrate(r,y),h.set(f.id.client,f.id.clock+f.length))}}if(n.length>0)f=n.pop();else if(o!==null&&o.i<o.refs.length)f=o.refs[o.i++];else{if(o=s(),o===null)break;f=o.refs[o.i++]}}if(l.clients.size>0){let g=new Qn;return Em(g,l,new Map),be(g.restEncoder,0),{missing:u,update:g.toUint8Array()}}return null},cL=(r,e)=>Em(r,e.doc.store,e.beforeState),lL=(r,e,t,n=new Ui(r))=>ze(e,i=>{i.local=!1;let s=!1,o=i.doc,l=o.store,u=oL(n,o),d=aL(i,l,u),f=l.pendingStructs;if(f){for(let[m,g]of f.missing)if(g<ct(l,m)){s=!0;break}if(d){for(let[m,g]of d.missing){let y=f.missing.get(m);(y==null||y>g)&&f.missing.set(m,g)}f.update=ff([f.update,d.update])}}else l.pendingStructs=d;let h=lx(n,i,l);if(l.pendingDs){let m=new Ui(Zr(l.pendingDs));ve(m.restDecoder);let g=lx(m,i,l);h&&g?l.pendingDs=ff([h,g]):l.pendingDs=h||g}else l.pendingDs=h;if(s){let m=l.pendingStructs.update;l.pendingStructs=null,Cx(i.doc,m)}},t,!1);var Cx=(r,e,t,n=Ui)=>{let i=Zr(e);lL(i,r,t,new n(i))},kx=(r,e,t)=>Cx(r,e,t,af),uL=(r,e,t=new Map)=>{Em(r,e.store,t),Vo(r,iL(e.store))},fL=(r,e=new Uint8Array([0]),t=new Qn)=>{let n=Rx(e);uL(t,r,n);let i=[t.toUint8Array()];if(r.store.pendingDs&&i.push(r.store.pendingDs),r.store.pendingStructs&&i.push(CL(r.store.pendingStructs.update,e)),i.length>1){if(t.constructor===Os)return xL(i.map((s,o)=>o===0?s:TL(s)));if(t.constructor===Qn)return ff(i)}return i[0]},Tx=(r,e)=>fL(r,e,new Os),dL=r=>{let e=new Map,t=ve(r.restDecoder);for(let n=0;n<t;n++){let i=ve(r.restDecoder),s=ve(r.restDecoder);e.set(i,s)}return e},Rx=r=>dL(new of(Zr(r))),Ax=(r,e)=>(be(r.restEncoder,e.size),Qr(e.entries()).sort((t,n)=>n[0]-t[0]).forEach(([t,n])=>{be(r.restEncoder,t),be(r.restEncoder,n)}),r),hL=(r,e)=>Ax(r,yf(e.store)),pL=(r,e=new lf)=>(r instanceof Map?Ax(e,r):hL(e,r),e.toUint8Array()),Ix=r=>pL(r,new cf),om=class{constructor(){this.l=[]}},ux=()=>new om,fx=(r,e)=>r.l.push(e),dx=(r,e)=>{let t=r.l,n=t.length;r.l=t.filter(i=>e!==i),n===r.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Ox=(r,e,t)=>ic(r.l,[e,t]),Pi=class{constructor(e,t){this.client=e,this.clock=t}},Xu=(r,e)=>r===e||r!==null&&e!==null&&r.client===e.client&&r.clock===e.clock,Re=(r,e)=>new Pi(r,e);var Dx=r=>{for(let[e,t]of r.doc.share.entries())if(t===r)return e;throw Dr()};var am=class{constructor(e,t,n,i=0){this.type=e,this.tname=t,this.item=n,this.assoc=i}};var cm=class{constructor(e,t,n=0){this.type=e,this.index=t,this.assoc=n}},mL=(r,e,t=0)=>new cm(r,e,t),Zu=(r,e,t)=>{let n=null,i=null;return r._item===null?i=Dx(r):n=Re(r._item.id.client,r._item.id.clock),new am(n,i,e,t)},Ec=(r,e,t=0)=>{let n=r._start;if(t<0){if(e===0)return Zu(r,null,t);e--}for(;n!==null;){if(!n.deleted&&n.countable){if(n.length>e)return Zu(r,Re(n.id.client,n.id.clock+e),t);e-=n.length}if(n.right===null&&t<0)return Zu(r,n.lastId,t);n=n.right}return Zu(r,null,t)};var gL=(r,e)=>{let t=Mo(r,e),n=e.clock-t.id.clock;return{item:t,diff:n}},Cc=(r,e,t=!0)=>{let n=e.store,i=r.item,s=r.type,o=r.tname,l=r.assoc,u=null,d=0;if(i!==null){if(ct(n,i.client)<=i.clock)return null;let f=t?vx(n,i):gL(n,i),h=f.item;if(!(h instanceof ot))return null;if(u=h.parent,u._item===null||!u._item.deleted){d=h.deleted||!h.countable?0:f.diff+(l>=0?0:1);let m=h.left;for(;m!==null;)!m.deleted&&m.countable&&(d+=m.length),m=m.left}}else{if(o!==null)u=e.get(o);else if(s!==null){if(ct(n,s.client)<=s.clock)return null;let{item:f}=t?vx(n,s):{item:Mo(n,s)};if(f instanceof ot&&f.content instanceof En)u=f.content.type;else return null}else throw Dr();l>=0?d=u._length:d=0}return mL(u,d,r.assoc)};var lm=class{constructor(e,t){this.ds=e,this.sv=t}};var yL=(r,e)=>new lm(r,e),Nq=yL(xx(),new Map);var Bo=(r,e)=>e===void 0?!r.deleted:e.sv.has(r.id.client)&&(e.sv.get(r.id.client)||0)>r.id.clock&&!Sx(e.ds,r.id),um=(r,e)=>{let t=Jr(r.meta,um,Ai),n=r.doc.store;t.has(e)||(e.sv.forEach((i,s)=>{i<ct(n,s)&&Li(r,Re(s,i))}),_x(r,e.ds,i=>{}),t.add(e))};var uf=class{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}},yf=r=>{let e=new Map;return r.clients.forEach((t,n)=>{let i=t[t.length-1];e.set(n,i.id.clock+i.length)}),e},ct=(r,e)=>{let t=r.clients.get(e);if(t===void 0)return 0;let n=t[t.length-1];return n.id.clock+n.length},Px=(r,e)=>{let t=r.clients.get(e.id.client);if(t===void 0)t=[],r.clients.set(e.id.client,t);else{let n=t[t.length-1];if(n.id.clock+n.length!==e.id.clock)throw Dr()}t.push(e)},xn=(r,e)=>{let t=0,n=r.length-1,i=r[n],s=i.id.clock;if(s===e)return n;let o=Yt(e/(s+i.length-1)*n);for(;t<=n;){if(i=r[o],s=i.id.clock,s<=e){if(e<s+i.length)return o;t=o+1}else n=o-1;o=Yt((t+n)/2)}throw Dr()},wL=(r,e)=>{let t=r.clients.get(e.client);return t[xn(t,e.clock)]},Mo=wL,fm=(r,e,t)=>{let n=xn(e,t),i=e[n];return i.id.clock<t&&i instanceof ot?(e.splice(n+1,0,gf(r,i,t-i.id.clock)),n+1):n},Li=(r,e)=>{let t=r.doc.store.clients.get(e.client);return t[fm(r,t,e.clock)]},hx=(r,e,t)=>{let n=e.clients.get(t.client),i=xn(n,t.clock),s=n[i];return t.clock!==s.id.clock+s.length-1&&s.constructor!==Kt&&n.splice(i+1,0,gf(r,s,t.clock-s.id.clock+1)),s},bL=(r,e,t)=>{let n=r.clients.get(e.id.client);n[xn(n,e.id.clock)]=t},Ux=(r,e,t,n,i)=>{if(n===0)return;let s=t+n,o=fm(r,e,t),l;do l=e[o++],s<l.id.clock+l.length&&fm(r,e,s),i(l);while(o<e.length&&e[o].id.clock<s)},dm=class{constructor(e,t,n){this.doc=e,this.deleteSet=new As,this.beforeState=yf(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=n,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}},px=(r,e)=>e.deleteSet.clients.size===0&&!ES(e.afterState,(t,n)=>e.beforeState.get(n)!==t)?!1:(Sm(e.deleteSet),cL(r,e),Vo(r,e.deleteSet),!0),mx=(r,e,t)=>{let n=e._item;(n===null||n.id.clock<(r.beforeState.get(n.id.client)||0)&&!n.deleted)&&Jr(r.changed,e,Ai).add(t)},rf=(r,e)=>{let t=r[e],n=r[e-1],i=e;for(;i>0;t=n,n=r[--i-1]){if(n.deleted===t.deleted&&n.constructor===t.constructor&&n.mergeWith(t)){t instanceof ot&&t.parentSub!==null&&t.parent._map.get(t.parentSub)===t&&t.parent._map.set(t.parentSub,n);continue}break}let s=e-i;return s&&r.splice(e+1-s,s),s},vL=(r,e,t)=>{for(let[n,i]of r.clients.entries()){let s=e.clients.get(n);for(let o=i.length-1;o>=0;o--){let l=i[o],u=l.clock+l.len;for(let d=xn(s,l.clock),f=s[d];d<s.length&&f.id.clock<u;f=s[++d]){let h=s[d];if(l.clock+l.len<=h.id.clock)break;h instanceof ot&&h.deleted&&!h.keep&&t(h)&&h.gc(e,!1)}}}},_L=(r,e)=>{r.clients.forEach((t,n)=>{let i=e.clients.get(n);for(let s=t.length-1;s>=0;s--){let o=t[s],l=ju(i.length-1,1+xn(i,o.clock+o.len-1));for(let u=l,d=i[u];u>0&&d.id.clock>=o.clock;d=i[u])u-=1+rf(i,u)}})};var Lx=(r,e)=>{if(e<r.length){let t=r[e],n=t.doc,i=n.store,s=t.deleteSet,o=t._mergeStructs;try{Sm(s),t.afterState=yf(t.doc.store),n.emit("beforeObserverCalls",[t,n]);let l=[];t.changed.forEach((u,d)=>l.push(()=>{(d._item===null||!d._item.deleted)&&d._callObserver(t,u)})),l.push(()=>{t.changedParentTypes.forEach((u,d)=>{d._dEH.l.length>0&&(d._item===null||!d._item.deleted)&&(u=u.filter(f=>f.target._item===null||!f.target._item.deleted),u.forEach(f=>{f.currentTarget=d,f._path=null}),u.sort((f,h)=>f.path.length-h.path.length),Ox(d._dEH,u,t))})}),l.push(()=>n.emit("afterTransaction",[t,n])),ic(l,[]),t._needFormattingCleanup&&BL(t)}finally{n.gc&&vL(s,i,n.gcFilter),_L(s,i),t.afterState.forEach((f,h)=>{let m=t.beforeState.get(h)||0;if(m!==f){let g=i.clients.get(h),y=Yn(xn(g,m),1);for(let b=g.length-1;b>=y;)b-=1+rf(g,b)}});for(let f=o.length-1;f>=0;f--){let{client:h,clock:m}=o[f].id,g=i.clients.get(h),y=xn(g,m);y+1<g.length&&rf(g,y+1)>1||y>0&&rf(g,y)}if(!t.local&&t.afterState.get(n.clientID)!==t.beforeState.get(n.clientID)&&(nx(uc,ac,"[yjs] ",cc,lc,"Changed the client-id because another client seems to be using it."),n.clientID=Ex()),n.emit("afterTransactionCleanup",[t,n]),n._observers.has("update")){let f=new Os;px(f,t)&&n.emit("update",[f.toUint8Array(),t.origin,n,t])}if(n._observers.has("updateV2")){let f=new Qn;px(f,t)&&n.emit("updateV2",[f.toUint8Array(),t.origin,n,t])}let{subdocsAdded:l,subdocsLoaded:u,subdocsRemoved:d}=t;(l.size>0||d.size>0||u.size>0)&&(l.forEach(f=>{f.clientID=n.clientID,f.collectionid==null&&(f.collectionid=n.collectionid),n.subdocs.add(f)}),d.forEach(f=>n.subdocs.delete(f)),n.emit("subdocs",[{loaded:u,added:l,removed:d},n,t]),d.forEach(f=>f.destroy())),r.length<=e+1?(n._transactionCleanups=[],n.emit("afterAllTransactions",[n,r])):Lx(r,e+1)}}},ze=(r,e,t=null,n=!0)=>{let i=r._transactionCleanups,s=!1,o=null;r._transaction===null&&(s=!0,r._transaction=new dm(r,t,n),i.push(r._transaction),i.length===1&&r.emit("beforeAllTransactions",[r]),r.emit("beforeTransaction",[r._transaction,r]));try{o=e(r._transaction)}finally{if(s){let l=r._transaction===i[0];r._transaction=null,l&&Lx(i,0)}}return o};function*SL(r){let e=ve(r.restDecoder);for(let t=0;t<e;t++){let n=ve(r.restDecoder),i=r.readClient(),s=ve(r.restDecoder);for(let o=0;o<n;o++){let l=r.readInfo();if(l===10){let u=ve(r.restDecoder);yield new Jt(Re(i,s),u),s+=u}else if((31&l)!==0){let u=(l&192)===0,d=new ot(Re(i,s),null,(l&128)===128?r.readLeftID():null,null,(l&64)===64?r.readRightID():null,u?r.readParentInfo()?r.readString():r.readLeftID():null,u&&(l&32)===32?r.readString():null,Zx(r,l));yield d,s+=d.length}else{let u=r.readLen();yield new Kt(Re(i,s),u),s+=u}}}}var hc=class{constructor(e,t){this.gen=SL(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Jt);return this.curr}};var pc=class{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}},xL=r=>ff(r,af,Os);var EL=(r,e)=>{if(r.constructor===Kt){let{client:t,clock:n}=r.id;return new Kt(Re(t,n+e),r.length-e)}else if(r.constructor===Jt){let{client:t,clock:n}=r.id;return new Jt(Re(t,n+e),r.length-e)}else{let t=r,{client:n,clock:i}=t.id;return new ot(Re(n,i+e),null,Re(n,i+e-1),null,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e))}},ff=(r,e=Ui,t=Qn)=>{if(r.length===1)return r[0];let n=r.map(f=>new e(Zr(f))),i=n.map(f=>new hc(f,!0)),s=null,o=new t,l=new pc(o);for(;i=i.filter(m=>m.curr!==null),i.sort((m,g)=>{if(m.curr.id.client===g.curr.id.client){let y=m.curr.id.clock-g.curr.id.clock;return y===0?m.curr.constructor===g.curr.constructor?0:m.curr.constructor===Jt?1:-1:y}else return g.curr.id.client-m.curr.id.client}),i.length!==0;){let f=i[0],h=f.curr.id.client;if(s!==null){let m=f.curr,g=!1;for(;m!==null&&m.id.clock+m.length<=s.struct.id.clock+s.struct.length&&m.id.client>=s.struct.id.client;)m=f.next(),g=!0;if(m===null||m.id.client!==h||g&&m.id.clock>s.struct.id.clock+s.struct.length)continue;if(h!==s.struct.id.client)Oi(l,s.struct,s.offset),s={struct:m,offset:0},f.next();else if(s.struct.id.clock+s.struct.length<m.id.clock)if(s.struct.constructor===Jt)s.struct.length=m.id.clock+m.length-s.struct.id.clock;else{Oi(l,s.struct,s.offset);let y=m.id.clock-s.struct.id.clock-s.struct.length;s={struct:new Jt(Re(h,s.struct.id.clock+s.struct.length),y),offset:0}}else{let y=s.struct.id.clock+s.struct.length-m.id.clock;y>0&&(s.struct.constructor===Jt?s.struct.length-=y:m=EL(m,y)),s.struct.mergeWith(m)||(Oi(l,s.struct,s.offset),s={struct:m,offset:0},f.next())}}else s={struct:f.curr,offset:0},f.next();for(let m=f.curr;m!==null&&m.id.client===h&&m.id.clock===s.struct.id.clock+s.struct.length&&m.constructor!==Jt;m=f.next())Oi(l,s.struct,s.offset),s={struct:m,offset:0}}s!==null&&(Oi(l,s.struct,s.offset),s=null),Cm(l);let u=n.map(f=>xm(f)),d=nL(u);return Vo(o,d),o.toUint8Array()},CL=(r,e,t=Ui,n=Qn)=>{let i=Rx(e),s=new n,o=new pc(s),l=new t(Zr(r)),u=new hc(l,!1);for(;u.curr;){let f=u.curr,h=f.id.client,m=i.get(h)||0;if(u.curr.constructor===Jt){u.next();continue}if(f.id.clock+f.length>m)for(Oi(o,f,Yn(m-f.id.clock,0)),u.next();u.curr&&u.curr.id.client===h;)Oi(o,u.curr,0),u.next();else for(;u.curr&&u.curr.id.client===h&&u.curr.id.clock+u.curr.length<=m;)u.next()}Cm(o);let d=xm(l);return Vo(s,d),s.toUint8Array()};var Fx=r=>{r.written>0&&(r.clientStructs.push({written:r.written,restEncoder:qt(r.encoder.restEncoder)}),r.encoder.restEncoder=Ot(),r.written=0)},Oi=(r,e,t)=>{r.written>0&&r.currClient!==e.id.client&&Fx(r),r.written===0&&(r.currClient=e.id.client,r.encoder.writeClient(e.id.client),be(r.encoder.restEncoder,e.id.clock+t)),e.write(r.encoder,t),r.written++},Cm=r=>{Fx(r);let e=r.encoder.restEncoder;be(e,r.clientStructs.length);for(let t=0;t<r.clientStructs.length;t++){let n=r.clientStructs[t];be(e,n.written),rc(e,n.restEncoder)}},kL=(r,e,t,n)=>{let i=new t(Zr(r)),s=new hc(i,!1),o=new n,l=new pc(o);for(let d=s.curr;d!==null;d=s.next())Oi(l,e(d),0);Cm(l);let u=xm(i);return Vo(o,u),o.toUint8Array()};var TL=r=>kL(r,KS,Ui,Os),gx="You must not compute changes after the event-handler fired.",qo=class{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=RL(this.currentTarget,this.target))}deletes(e){return Sx(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw vn(gx);let e=new Map,t=this.target;this.transaction.changed.get(t).forEach(i=>{if(i!==null){let s=t._map.get(i),o,l;if(this.adds(s)){let u=s.left;for(;u!==null&&this.adds(u);)u=u.left;if(this.deletes(s))if(u!==null&&this.deletes(u))o="delete",l=Mu(u.content.getContent());else return;else u!==null&&this.deletes(u)?(o="update",l=Mu(u.content.getContent())):(o="add",l=void 0)}else if(this.deletes(s))o="delete",l=Mu(s.content.getContent());else return;e.set(i,{action:o,oldValue:l})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw vn(gx);let t=this.target,n=Ai(),i=Ai(),s=[];if(e={added:n,deleted:i,delta:s,keys:this.keys},this.transaction.changed.get(t).has(null)){let l=null,u=()=>{l&&s.push(l)};for(let d=t._start;d!==null;d=d.right)d.deleted?this.deletes(d)&&!this.adds(d)&&((l===null||l.delete===void 0)&&(u(),l={delete:0}),l.delete+=d.length,i.add(d)):this.adds(d)?((l===null||l.insert===void 0)&&(u(),l={insert:[]}),l.insert=l.insert.concat(d.content.getContent()),n.add(d)):((l===null||l.retain===void 0)&&(u(),l={retain:0}),l.retain+=d.length);l!==null&&l.retain===void 0&&u()}this._changes=e}return e}},RL=(r,e)=>{let t=[];for(;e._item!==null&&e!==r;){if(e._item.parentSub!==null)t.unshift(e._item.parentSub);else{let n=0,i=e._item.parent._start;for(;i!==e._item&&i!==null;)!i.deleted&&i.countable&&(n+=i.length),i=i.right;t.unshift(n)}e=e._item.parent}return t},Dt=()=>{ix("Invalid access: Add Yjs type to a document before reading data.")},Nx=80,km=0,hm=class{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=km++}},AL=r=>{r.timestamp=km++},Bx=(r,e,t)=>{r.p.marker=!1,r.p=e,e.marker=!0,r.index=t,r.timestamp=km++},IL=(r,e,t)=>{if(r.length>=Nx){let n=r.reduce((i,s)=>i.timestamp<s.timestamp?i:s);return Bx(n,e,t),n}else{let n=new hm(e,t);return r.push(n),n}},wf=(r,e)=>{if(r._start===null||e===0||r._searchMarker===null)return null;let t=r._searchMarker.length===0?null:r._searchMarker.reduce((s,o)=>Ro(e-s.index)<Ro(e-o.index)?s:o),n=r._start,i=0;for(t!==null&&(n=t.p,i=t.index,AL(t));n.right!==null&&i<e;){if(!n.deleted&&n.countable){if(e<i+n.length)break;i+=n.length}n=n.right}for(;n.left!==null&&i>e;)n=n.left,!n.deleted&&n.countable&&(i-=n.length);for(;n.left!==null&&n.left.id.client===n.id.client&&n.left.id.clock+n.left.length===n.id.clock;)n=n.left,!n.deleted&&n.countable&&(i-=n.length);return t!==null&&Ro(t.index-i)<n.parent.length/Nx?(Bx(t,n,i),t):IL(r._searchMarker,n,i)},mc=(r,e,t)=>{for(let n=r.length-1;n>=0;n--){let i=r[n];if(t>0){let s=i.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(i.index-=s.length);if(s===null||s.marker===!0){r.splice(n,1);continue}i.p=s,s.marker=!0}(e<i.index||t>0&&e===i.index)&&(i.index=Yn(e,i.index+t))}};var bf=(r,e,t)=>{let n=r,i=e.changedParentTypes;for(;Jr(i,r,()=>[]).push(t),r._item!==null;)r=r._item.parent;Ox(n._eH,t,e)},ht=class{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=ux(),this._dEH=ux(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw Xr()}clone(){throw Xr()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){fx(this._eH,e)}observeDeep(e){fx(this._dEH,e)}unobserve(e){dx(this._eH,e)}unobserveDeep(e){dx(this._dEH,e)}toJSON(){}},Mx=(r,e,t)=>{r.doc??Dt(),e<0&&(e=r._length+e),t<0&&(t=r._length+t);let n=t-e,i=[],s=r._start;for(;s!==null&&n>0;){if(s.countable&&!s.deleted){let o=s.content.getContent();if(o.length<=e)e-=o.length;else{for(let l=e;l<o.length&&n>0;l++)i.push(o[l]),n--;e=0}}s=s.right}return i},qx=r=>{r.doc??Dt();let e=[],t=r._start;for(;t!==null;){if(t.countable&&!t.deleted){let n=t.content.getContent();for(let i=0;i<n.length;i++)e.push(n[i])}t=t.right}return e};var gc=(r,e)=>{let t=0,n=r._start;for(r.doc??Dt();n!==null;){if(n.countable&&!n.deleted){let i=n.content.getContent();for(let s=0;s<i.length;s++)e(i[s],t++,r)}n=n.right}},jx=(r,e)=>{let t=[];return gc(r,(n,i)=>{t.push(e(n,i,r))}),t},OL=r=>{let e=r._start,t=null,n=0;return{[Symbol.iterator](){return this},next:()=>{if(t===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};t=e.content.getContent(),n=0,e=e.right}let i=t[n++];return t.length<=n&&(t=null),{done:!1,value:i}}}},$x=(r,e)=>{r.doc??Dt();let t=wf(r,e),n=r._start;for(t!==null&&(n=t.p,e-=t.index);n!==null;n=n.right)if(!n.deleted&&n.countable){if(e<n.length)return n.content.getContent()[e];e-=n.length}},df=(r,e,t,n)=>{let i=t,s=r.doc,o=s.clientID,l=s.store,u=t===null?e._start:t.right,d=[],f=()=>{d.length>0&&(i=new ot(Re(o,ct(l,o)),i,i&&i.lastId,u,u&&u.id,e,null,new $o(d)),i.integrate(r,0),d=[])};n.forEach(h=>{if(h===null)d.push(h);else switch(h.constructor){case Number:case Object:case Boolean:case Array:case String:d.push(h);break;default:switch(f(),h.constructor){case Uint8Array:case ArrayBuffer:i=new ot(Re(o,ct(l,o)),i,i&&i.lastId,u,u&&u.id,e,null,new Sc(new Uint8Array(h))),i.integrate(r,0);break;case Is:i=new ot(Re(o,ct(l,o)),i,i&&i.lastId,u,u&&u.id,e,null,new xc(h)),i.integrate(r,0);break;default:if(h instanceof ht)i=new ot(Re(o,ct(l,o)),i,i&&i.lastId,u,u&&u.id,e,null,new En(h)),i.integrate(r,0);else throw new Error("Unexpected content type in insert operation")}}}),f()},Vx=()=>vn("Length exceeded!"),Wx=(r,e,t,n)=>{if(t>e._length)throw Vx();if(t===0)return e._searchMarker&&mc(e._searchMarker,t,n.length),df(r,e,null,n);let i=t,s=wf(e,t),o=e._start;for(s!==null&&(o=s.p,t-=s.index,t===0&&(o=o.prev,t+=o&&o.countable&&!o.deleted?o.length:0));o!==null;o=o.right)if(!o.deleted&&o.countable){if(t<=o.length){t<o.length&&Li(r,Re(o.id.client,o.id.clock+t));break}t-=o.length}return e._searchMarker&&mc(e._searchMarker,i,n.length),df(r,e,o,n)},DL=(r,e,t)=>{let i=(e._searchMarker||[]).reduce((s,o)=>o.index>s.index?o:s,{index:0,p:e._start}).p;if(i)for(;i.right;)i=i.right;return df(r,e,i,t)},zx=(r,e,t,n)=>{if(n===0)return;let i=t,s=n,o=wf(e,t),l=e._start;for(o!==null&&(l=o.p,t-=o.index);l!==null&&t>0;l=l.right)!l.deleted&&l.countable&&(t<l.length&&Li(r,Re(l.id.client,l.id.clock+t)),t-=l.length);for(;n>0&&l!==null;)l.deleted||(n<l.length&&Li(r,Re(l.id.client,l.id.clock+n)),l.delete(r),n-=l.length),l=l.right;if(n>0)throw Vx();e._searchMarker&&mc(e._searchMarker,i,-s+n)},hf=(r,e,t)=>{let n=e._map.get(t);n!==void 0&&n.delete(r)},Tm=(r,e,t,n)=>{let i=e._map.get(t)||null,s=r.doc,o=s.clientID,l;if(n==null)l=new $o([n]);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:l=new $o([n]);break;case Uint8Array:l=new Sc(n);break;case Is:l=new xc(n);break;default:if(n instanceof ht)l=new En(n);else throw new Error("Unexpected content type")}new ot(Re(o,ct(s.store,o)),i,i&&i.lastId,null,null,e,t,l).integrate(r,0)},Rm=(r,e)=>{r.doc??Dt();let t=r._map.get(e);return t!==void 0&&!t.deleted?t.content.getContent()[t.length-1]:void 0},Hx=r=>{let e={};return r.doc??Dt(),r._map.forEach((t,n)=>{t.deleted||(e[n]=t.content.getContent()[t.length-1])}),e},Gx=(r,e)=>{r.doc??Dt();let t=r._map.get(e);return t!==void 0&&!t.deleted};var PL=(r,e)=>{let t={};return r._map.forEach((n,i)=>{let s=n;for(;s!==null&&(!e.sv.has(s.id.client)||s.id.clock>=(e.sv.get(s.id.client)||0));)s=s.left;s!==null&&Bo(s,e)&&(t[i]=s.content.getContent()[s.length-1])}),t},ef=r=>(r.doc??Dt(),ox(r._map.entries(),e=>!e[1].deleted)),pm=class extends qo{},pf=class r extends ht{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){let t=new r;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new r}clone(){let e=new r;return e.insert(0,this.toArray().map(t=>t instanceof ht?t.clone():t)),e}get length(){return this.doc??Dt(),this._length}_callObserver(e,t){super._callObserver(e,t),bf(this,e,new pm(this,e))}insert(e,t){this.doc!==null?ze(this.doc,n=>{Wx(n,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){this.doc!==null?ze(this.doc,t=>{DL(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){this.doc!==null?ze(this.doc,n=>{zx(n,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return $x(this,e)}toArray(){return qx(this)}slice(e=0,t=this.length){return Mx(this,e,t)}toJSON(){return this.map(e=>e instanceof ht?e.toJSON():e)}map(e){return jx(this,e)}forEach(e){gc(this,e)}[Symbol.iterator](){return OL(this)}_write(e){e.writeTypeRef(tF)}},UL=r=>new pf,mm=class extends qo{constructor(e,t,n){super(e,t),this.keysChanged=n}},yc=class r extends ht{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((n,i)=>{this.set(i,n)}),this._prelimContent=null}_copy(){return new r}clone(){let e=new r;return this.forEach((t,n)=>{e.set(n,t instanceof ht?t.clone():t)}),e}_callObserver(e,t){bf(this,e,new mm(this,e,t))}toJSON(){this.doc??Dt();let e={};return this._map.forEach((t,n)=>{if(!t.deleted){let i=t.content.getContent()[t.length-1];e[n]=i instanceof ht?i.toJSON():i}}),e}get size(){return[...ef(this)].length}keys(){return Qu(ef(this),e=>e[0])}values(){return Qu(ef(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return Qu(ef(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??Dt(),this._map.forEach((t,n)=>{t.deleted||e(t.content.getContent()[t.length-1],n,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?ze(this.doc,t=>{hf(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return this.doc!==null?ze(this.doc,n=>{Tm(n,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return Rm(this,e)}has(e){return Gx(this,e)}clear(){this.doc!==null?ze(this.doc,e=>{this.forEach(function(t,n,i){hf(e,i,n)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(rF)}},LL=r=>new yc,Di=(r,e)=>r===e||typeof r=="object"&&typeof e=="object"&&r&&e&&Kp(r,e),wc=class{constructor(e,t,n,i){this.left=e,this.right=t,this.index=n,this.currentAttributes=i}forward(){switch(this.right===null&&Dr(),this.right.content.constructor){case pt:this.right.deleted||Wo(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}},yx=(r,e,t)=>{for(;e.right!==null&&t>0;){switch(e.right.content.constructor){case pt:e.right.deleted||Wo(e.currentAttributes,e.right.content);break;default:e.right.deleted||(t<e.right.length&&Li(r,Re(e.right.id.client,e.right.id.clock+t)),e.index+=e.right.length,t-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},tf=(r,e,t,n)=>{let i=new Map,s=n?wf(e,t):null;if(s){let o=new wc(s.p.left,s.p,s.index,i);return yx(r,o,t-s.index)}else{let o=new wc(null,e._start,0,i);return yx(r,o,t)}},Yx=(r,e,t,n)=>{for(;t.right!==null&&(t.right.deleted===!0||t.right.content.constructor===pt&&Di(n.get(t.right.content.key),t.right.content.value));)t.right.deleted||n.delete(t.right.content.key),t.forward();let i=r.doc,s=i.clientID;n.forEach((o,l)=>{let u=t.left,d=t.right,f=new ot(Re(s,ct(i.store,s)),u,u&&u.lastId,d,d&&d.id,e,null,new pt(l,o));f.integrate(r,0),t.right=f,t.forward()})},Wo=(r,e)=>{let{key:t,value:n}=e;n===null?r.delete(t):r.set(t,n)},Kx=(r,e)=>{for(;r.right!==null;){if(!(r.right.deleted||r.right.content.constructor===pt&&Di(e[r.right.content.key]??null,r.right.content.value)))break;r.forward()}},Jx=(r,e,t,n)=>{let i=r.doc,s=i.clientID,o=new Map;for(let l in n){let u=n[l],d=t.currentAttributes.get(l)??null;if(!Di(d,u)){o.set(l,d);let{left:f,right:h}=t;t.right=new ot(Re(s,ct(i.store,s)),f,f&&f.lastId,h,h&&h.id,e,null,new pt(l,u)),t.right.integrate(r,0),t.forward()}}return o},im=(r,e,t,n,i)=>{t.currentAttributes.forEach((m,g)=>{i[g]===void 0&&(i[g]=null)});let s=r.doc,o=s.clientID;Kx(t,i);let l=Jx(r,e,t,i),u=n.constructor===String?new Xn(n):n instanceof ht?new En(n):new Ds(n),{left:d,right:f,index:h}=t;e._searchMarker&&mc(e._searchMarker,t.index,u.getLength()),f=new ot(Re(o,ct(s.store,o)),d,d&&d.lastId,f,f&&f.id,e,null,u),f.integrate(r,0),t.right=f,t.index=h,t.forward(),Yx(r,e,t,l)},wx=(r,e,t,n,i)=>{let s=r.doc,o=s.clientID;Kx(t,i);let l=Jx(r,e,t,i);e:for(;t.right!==null&&(n>0||l.size>0&&(t.right.deleted||t.right.content.constructor===pt));){if(!t.right.deleted)switch(t.right.content.constructor){case pt:{let{key:u,value:d}=t.right.content,f=i[u];if(f!==void 0){if(Di(f,d))l.delete(u);else{if(n===0)break e;l.set(u,d)}t.right.delete(r)}else t.currentAttributes.set(u,d);break}default:n<t.right.length&&Li(r,Re(t.right.id.client,t.right.id.clock+n)),n-=t.right.length;break}t.forward()}if(n>0){let u="";for(;n>0;n--)u+=`
`;t.right=new ot(Re(o,ct(s.store,o)),t.left,t.left&&t.left.lastId,t.right,t.right&&t.right.id,e,null,new Xn(u)),t.right.integrate(r,0),t.forward()}Yx(r,e,t,l)},Qx=(r,e,t,n,i)=>{let s=e,o=It();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===pt){let d=s.content;o.set(d.key,d)}s=s.right}let l=0,u=!1;for(;e!==s;){if(t===e&&(u=!0),!e.deleted){let d=e.content;switch(d.constructor){case pt:{let{key:f,value:h}=d,m=n.get(f)??null;(o.get(f)!==d||m===h)&&(e.delete(r),l++,!u&&(i.get(f)??null)===h&&m!==h&&(m===null?i.delete(f):i.set(f,m))),!u&&!e.deleted&&Wo(i,d);break}}}e=e.right}return l},FL=(r,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;let t=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===pt){let n=e.content.key;t.has(n)?e.delete(r):t.add(n)}e=e.left}},NL=r=>{let e=0;return ze(r.doc,t=>{let n=r._start,i=r._start,s=It(),o=Bu(s);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case pt:Wo(o,i.content);break;default:e+=Qx(t,n,i,s,o),s=Bu(o),n=i;break}i=i.right}}),e},BL=r=>{let e=new Set,t=r.doc;for(let[n,i]of r.afterState.entries()){let s=r.beforeState.get(n)||0;i!==s&&Ux(r,t.store.clients.get(n),s,i,o=>{!o.deleted&&o.content.constructor===pt&&o.constructor!==Kt&&e.add(o.parent)})}ze(t,n=>{_x(r,r.deleteSet,i=>{if(i instanceof Kt||!i.parent._hasFormatting||e.has(i.parent))return;let s=i.parent;i.content.constructor===pt?e.add(s):FL(n,i)});for(let i of e)NL(i)})},bx=(r,e,t)=>{let n=t,i=Bu(e.currentAttributes),s=e.right;for(;t>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case En:case Ds:case Xn:t<e.right.length&&Li(r,Re(e.right.id.client,e.right.id.clock+t)),t-=e.right.length,e.right.delete(r);break}e.forward()}s&&Qx(r,s,e.right,i,e.currentAttributes);let o=(e.left||e.right).parent;return o._searchMarker&&mc(o._searchMarker,e.index,-n+t),e},gm=class extends qo{constructor(e,t,n){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,n.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){let e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){let e=this.target.doc,t=[];ze(e,n=>{let i=new Map,s=new Map,o=this.target._start,l=null,u={},d="",f=0,h=0,m=()=>{if(l!==null){let g=null;switch(l){case"delete":h>0&&(g={delete:h}),h=0;break;case"insert":(typeof d=="object"||d.length>0)&&(g={insert:d},i.size>0&&(g.attributes={},i.forEach((y,b)=>{y!==null&&(g.attributes[b]=y)}))),d="";break;case"retain":f>0&&(g={retain:f},GS(u)||(g.attributes=WS({},u))),f=0;break}g&&t.push(g),l=null}};for(;o!==null;){switch(o.content.constructor){case En:case Ds:this.adds(o)?this.deletes(o)||(m(),l="insert",d=o.content.getContent()[0],m()):this.deletes(o)?(l!=="delete"&&(m(),l="delete"),h+=1):o.deleted||(l!=="retain"&&(m(),l="retain"),f+=1);break;case Xn:this.adds(o)?this.deletes(o)||(l!=="insert"&&(m(),l="insert"),d+=o.content.str):this.deletes(o)?(l!=="delete"&&(m(),l="delete"),h+=o.length):o.deleted||(l!=="retain"&&(m(),l="retain"),f+=o.length);break;case pt:{let{key:g,value:y}=o.content;if(this.adds(o)){if(!this.deletes(o)){let b=i.get(g)??null;Di(b,y)?y!==null&&o.delete(n):(l==="retain"&&m(),Di(y,s.get(g)??null)?delete u[g]:u[g]=y)}}else if(this.deletes(o)){s.set(g,y);let b=i.get(g)??null;Di(b,y)||(l==="retain"&&m(),u[g]=b)}else if(!o.deleted){s.set(g,y);let b=u[g];b!==void 0&&(Di(b,y)?b!==null&&o.delete(n):(l==="retain"&&m(),y===null?delete u[g]:u[g]=y))}o.deleted||(l==="insert"&&m(),Wo(i,o.content));break}}o=o.right}for(m();t.length>0;){let g=t[t.length-1];if(g.retain!==void 0&&g.attributes===void 0)t.pop();else break}}),this._delta=t}return this._delta}},bc=class r extends ht{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??Dt(),this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(n=>n())}catch(n){console.error(n)}this._pending=null}_copy(){return new r}clone(){let e=new r;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);let n=new gm(this,e,t);bf(this,e,n),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??Dt();let e="",t=this._start;for(;t!==null;)!t.deleted&&t.countable&&t.content.constructor===Xn&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){this.doc!==null?ze(this.doc,n=>{let i=new wc(null,this._start,0,new Map);for(let s=0;s<e.length;s++){let o=e[s];if(o.insert!==void 0){let l=!t&&typeof o.insert=="string"&&s===e.length-1&&i.right===null&&o.insert.slice(-1)===`
`?o.insert.slice(0,-1):o.insert;(typeof l!="string"||l.length>0)&&im(n,this,i,l,o.attributes||{})}else o.retain!==void 0?wx(n,this,i,o.retain,o.attributes||{}):o.delete!==void 0&&bx(n,i,o.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,n){this.doc??Dt();let i=[],s=new Map,o=this.doc,l="",u=this._start;function d(){if(l.length>0){let h={},m=!1;s.forEach((y,b)=>{m=!0,h[b]=y});let g={insert:l};m&&(g.attributes=h),i.push(g),l=""}}let f=()=>{for(;u!==null;){if(Bo(u,e)||t!==void 0&&Bo(u,t))switch(u.content.constructor){case Xn:{let h=s.get("ychange");e!==void 0&&!Bo(u,e)?(h===void 0||h.user!==u.id.client||h.type!=="removed")&&(d(),s.set("ychange",n?n("removed",u.id):{type:"removed"})):t!==void 0&&!Bo(u,t)?(h===void 0||h.user!==u.id.client||h.type!=="added")&&(d(),s.set("ychange",n?n("added",u.id):{type:"added"})):h!==void 0&&(d(),s.delete("ychange")),l+=u.content.str;break}case En:case Ds:{d();let h={insert:u.content.getContent()[0]};if(s.size>0){let m={};h.attributes=m,s.forEach((g,y)=>{m[y]=g})}i.push(h);break}case pt:Bo(u,e)&&(d(),Wo(s,u.content));break}u=u.right}d()};return e||t?ze(o,h=>{e&&um(h,e),t&&um(h,t),f()},"cleanup"):f(),i}insert(e,t,n){if(t.length<=0)return;let i=this.doc;i!==null?ze(i,s=>{let o=tf(s,this,e,!n);n||(n={},o.currentAttributes.forEach((l,u)=>{n[u]=l})),im(s,this,o,t,n)}):this._pending.push(()=>this.insert(e,t,n))}insertEmbed(e,t,n){let i=this.doc;i!==null?ze(i,s=>{let o=tf(s,this,e,!n);im(s,this,o,t,n||{})}):this._pending.push(()=>this.insertEmbed(e,t,n||{}))}delete(e,t){if(t===0)return;let n=this.doc;n!==null?ze(n,i=>{bx(i,tf(i,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,n){if(t===0)return;let i=this.doc;i!==null?ze(i,s=>{let o=tf(s,this,e,!1);o.right!==null&&wx(s,this,o,t,n)}):this._pending.push(()=>this.format(e,t,n))}removeAttribute(e){this.doc!==null?ze(this.doc,t=>{hf(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){this.doc!==null?ze(this.doc,n=>{Tm(n,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return Rm(this,e)}getAttributes(){return Hx(this)}_write(e){e.writeTypeRef(nF)}},ML=r=>new bc,fc=class{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??Dt()}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,!e.deleted&&(t.constructor===vc||t.constructor===jo)&&t._start!==null)e=t._start;else for(;e!==null;){let n=e.next;if(n!==null){e=n;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}},jo=class r extends ht{constructor(){super(),this._prelimContent=[]}get firstChild(){let e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new r}clone(){let e=new r;return e.insert(0,this.toArray().map(t=>t instanceof ht?t.clone():t)),e}get length(){return this.doc??Dt(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new fc(this,e)}querySelector(e){e=e.toUpperCase();let n=new fc(this,i=>i.nodeName&&i.nodeName.toUpperCase()===e).next();return n.done?null:n.value}querySelectorAll(e){return e=e.toUpperCase(),Qr(new fc(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){bf(this,e,new ym(this,t,e))}toString(){return jx(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},n){let i=e.createDocumentFragment();return n!==void 0&&n._createAssociation(i,this),gc(this,s=>{i.insertBefore(s.toDOM(e,t,n),null)}),i}insert(e,t){this.doc!==null?ze(this.doc,n=>{Wx(n,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(this.doc!==null)ze(this.doc,n=>{let i=e&&e instanceof ht?e._item:e;df(n,this,i,t)});else{let n=this._prelimContent,i=e===null?0:n.findIndex(s=>s===e)+1;if(i===0&&e!==null)throw vn("Reference item not found");n.splice(i,0,...t)}}delete(e,t=1){this.doc!==null?ze(this.doc,n=>{zx(n,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return qx(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return $x(this,e)}slice(e=0,t=this.length){return Mx(this,e,t)}forEach(e){gc(this,e)}_write(e){e.writeTypeRef(sF)}},qL=r=>new jo,vc=class r extends jo{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){let e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){let e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((n,i)=>{this.setAttribute(i,n)}),this._prelimAttrs=null}_copy(){return new r(this.nodeName)}clone(){let e=new r(this.nodeName),t=this.getAttributes();return HS(t,(n,i)=>{typeof n=="string"&&e.setAttribute(i,n)}),e.insert(0,this.toArray().map(n=>n instanceof ht?n.clone():n)),e}toString(){let e=this.getAttributes(),t=[],n=[];for(let l in e)n.push(l);n.sort();let i=n.length;for(let l=0;l<i;l++){let u=n[l];t.push(u+'="'+e[u]+'"')}let s=this.nodeName.toLocaleLowerCase(),o=t.length>0?" "+t.join(" "):"";return`<${s}${o}>${super.toString()}</${s}>`}removeAttribute(e){this.doc!==null?ze(this.doc,t=>{hf(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){this.doc!==null?ze(this.doc,n=>{Tm(n,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return Rm(this,e)}hasAttribute(e){return Gx(this,e)}getAttributes(e){return e?PL(this,e):Hx(this)}toDOM(e=document,t={},n){let i=e.createElement(this.nodeName),s=this.getAttributes();for(let o in s){let l=s[o];typeof l=="string"&&i.setAttribute(o,l)}return gc(this,o=>{i.appendChild(o.toDOM(e,t,n))}),n!==void 0&&n._createAssociation(i,this),i}_write(e){e.writeTypeRef(iF),e.writeKey(this.nodeName)}},jL=r=>new vc(r.readKey()),ym=class extends qo{constructor(e,t,n){super(e,n),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}},wm=class r extends yc{constructor(e){super(),this.hookName=e}_copy(){return new r(this.hookName)}clone(){let e=new r(this.hookName);return this.forEach((t,n)=>{e.set(n,t)}),e}toDOM(e=document,t={},n){let i=t[this.hookName],s;return i!==void 0?s=i.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),n!==void 0&&n._createAssociation(s,this),s}_write(e){e.writeTypeRef(oF),e.writeKey(this.hookName)}},$L=r=>new wm(r.readKey()),bm=class r extends bc{get nextSibling(){let e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){let e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new r}clone(){let e=new r;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,n){let i=e.createTextNode(this.toString());return n!==void 0&&n._createAssociation(i,this),i}toString(){return this.toDelta().map(e=>{let t=[];for(let i in e.attributes){let s=[];for(let o in e.attributes[i])s.push({key:o,value:e.attributes[i][o]});s.sort((o,l)=>o.key<l.key?-1:1),t.push({nodeName:i,attrs:s})}t.sort((i,s)=>i.nodeName<s.nodeName?-1:1);let n="";for(let i=0;i<t.length;i++){let s=t[i];n+=`<${s.nodeName}`;for(let o=0;o<s.attrs.length;o++){let l=s.attrs[o];n+=` ${l.key}="${l.value}"`}n+=">"}n+=e.insert;for(let i=t.length-1;i>=0;i--)n+=`</${t[i].nodeName}>`;return n}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(aF)}},VL=r=>new bm,_c=class{constructor(e,t){this.id=e,this.length=t}get deleted(){throw Xr()}mergeWith(e){return!1}write(e,t,n){throw Xr()}integrate(e,t){throw Xr()}},WL=0,Kt=class extends _c{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),Px(e.doc.store,this)}write(e,t){e.writeInfo(WL),e.writeLen(this.length-t)}getMissing(e,t){return null}},Sc=class r{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new r(this.content)}splice(e){throw Xr()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}},zL=r=>new Sc(r.readBuf()),mf=class r{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new r(this.len)}splice(e){let t=new r(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){sf(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}},HL=r=>new mf(r.readLen()),Xx=(r,e)=>new Is({guid:r,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1}),xc=class r{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;let t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),e.meta!==null&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new r(Xx(this.doc.guid,this.opts))}splice(e){throw Xr()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}},GL=r=>new xc(Xx(r.readString(),r.readAny())),Ds=class r{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new r(this.embed)}splice(e){throw Xr()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}},YL=r=>new Ds(r.readJSON()),pt=class r{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new r(this.key,this.value)}splice(e){throw Xr()}mergeWith(e){return!1}integrate(e,t){let n=t.parent;n._searchMarker=null,n._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}},KL=r=>new pt(r.readKey(),r.readJSON()),vm=class r{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new r(this.arr)}splice(e){let t=new r(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){let n=this.arr.length;e.writeLen(n-t);for(let i=t;i<n;i++){let s=this.arr[i];e.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}},JL=r=>{let e=r.readLen(),t=[];for(let n=0;n<e;n++){let i=r.readString();i==="undefined"?t.push(void 0):t.push(JSON.parse(i))}return new vm(t)},QL=oc("node_env")==="development",$o=class r{constructor(e){this.arr=e,QL&&Jp(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new r(this.arr)}splice(e){let t=new r(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){let n=this.arr.length;e.writeLen(n-t);for(let i=t;i<n;i++){let s=this.arr[i];e.writeAny(s)}}getRef(){return 8}},XL=r=>{let e=r.readLen(),t=[];for(let n=0;n<e;n++)t.push(r.readAny());return new $o(t)},Xn=class r{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new r(this.str)}splice(e){let t=new r(this.str.slice(e));this.str=this.str.slice(0,e);let n=this.str.charCodeAt(e-1);return n>=55296&&n<=56319&&(this.str=this.str.slice(0,e-1)+"\uFFFD",t.str="\uFFFD"+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(t===0?this.str:this.str.slice(t))}getRef(){return 4}},ZL=r=>new Xn(r.readString()),eF=[UL,LL,ML,jL,qL,$L,VL],tF=0,rF=1,nF=2,iF=3,sF=4,oF=5,aF=6,En=class r{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new r(this.type._copy())}splice(e){throw Xr()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;t!==null;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(n=>{n.deleted?n.id.clock<(e.beforeState.get(n.id.client)||0)&&e._mergeStructs.push(n):n.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;t!==null;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(n=>{for(;n!==null;)n.gc(e,!0),n=n.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}},cF=r=>new En(eF[r.readTypeRef()](r)),vx=(r,e)=>{let t=e,n=0,i;do n>0&&(t=Re(t.client,t.clock+n)),i=Mo(r,t),n=t.clock-i.id.clock,t=i.redone;while(t!==null&&i instanceof ot);return{item:i,diff:n}};var gf=(r,e,t)=>{let{client:n,clock:i}=e.id,s=new ot(Re(n,i+t),e,Re(n,i+t-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t));return e.deleted&&s.markDeleted(),e.keep&&(s.keep=!0),e.redone!==null&&(s.redone=Re(e.redone.client,e.redone.clock+t)),e.right=s,s.right!==null&&(s.right.left=s),r._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),e.length=t,s};var ot=class r extends _c{constructor(e,t,n,i,s,o,l,u){super(e,u.getLength()),this.origin=n,this.left=t,this.right=i,this.rightOrigin=s,this.parent=o,this.parentSub=l,this.redone=null,this.content=u,this.info=this.content.isCountable()?2:0}set marker(e){(this.info&8)>0!==e&&(this.info^=8)}get marker(){return(this.info&8)>0}get keep(){return(this.info&1)>0}set keep(e){this.keep!==e&&(this.info^=1)}get countable(){return(this.info&2)>0}get deleted(){return(this.info&4)>0}set deleted(e){this.deleted!==e&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=ct(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=ct(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Pi&&this.id.client!==this.parent.client&&this.parent.clock>=ct(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=hx(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Li(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Kt||this.right&&this.right.constructor===Kt)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===r?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===r&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===Pi){let n=Mo(t,this.parent);n.constructor===Kt?this.parent=null:this.parent=n.content.type}return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=hx(e,e.doc.store,Re(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let n=this.left,i;if(n!==null)i=n.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;let s=new Set,o=new Set;for(;i!==null&&i!==this.right;){if(o.add(i),s.add(i),Xu(this.origin,i.origin)){if(i.id.client<this.id.client)n=i,s.clear();else if(Xu(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&o.has(Mo(e.doc.store,i.origin)))s.has(Mo(e.doc.store,i.origin))||(n=i,s.clear());else break;i=i.right}this.left=n}if(this.left!==null){let n=this.left.right;this.right=n,this.left.right=this}else{let n;if(this.parentSub!==null)for(n=this.parent._map.get(this.parentSub)||null;n!==null&&n.left!==null;)n=n.left;else n=this.parent._start,this.parent._start=this;this.right=n}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Px(e.doc.store,this),this.content.integrate(e,this),mx(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new Kt(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Re(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&Xu(e.origin,this.lastId)&&this.right===e&&Xu(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){let t=this.parent._searchMarker;return t&&t.forEach(n=>{n.p===e&&(n.p=this,!this.deleted&&this.countable&&(n.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){let t=this.parent;this.countable&&this.parentSub===null&&(t._length-=this.length),this.markDeleted(),sf(e.deleteSet,this.id.client,this.id.clock,this.length),mx(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw Dr();this.content.gc(e),t?bL(e,this,new Kt(this.id,this.length)):this.content=new mf(this.length)}write(e,t){let n=t>0?Re(this.id.client,this.id.clock+t-1):this.origin,i=this.rightOrigin,s=this.parentSub,o=this.content.getRef()&31|(n===null?0:128)|(i===null?0:64)|(s===null?0:32);if(e.writeInfo(o),n!==null&&e.writeLeftID(n),i!==null&&e.writeRightID(i),n===null&&i===null){let l=this.parent;if(l._item!==void 0){let u=l._item;if(u===null){let d=Dx(l);e.writeParentInfo(!0),e.writeString(d)}else e.writeParentInfo(!1),e.writeLeftID(u.id)}else l.constructor===String?(e.writeParentInfo(!0),e.writeString(l)):l.constructor===Pi?(e.writeParentInfo(!1),e.writeLeftID(l)):Dr();s!==null&&e.writeString(s)}this.content.write(e,t)}},Zx=(r,e)=>lF[e&31](r),lF=[()=>{Dr()},HL,JL,zL,ZL,YL,KL,cF,XL,GL,()=>{Dr()}],uF=10,Jt=class extends _c{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){Dr()}write(e,t){e.writeInfo(uF),be(e.restEncoder,this.length-t)}getMissing(e,t){return null}},eE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},tE="__ $YJS$ __";eE[tE]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");eE[tE]=!0;var Am=3e4,vf=class extends qu{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{let t=Rs();this.getLocalState()!==null&&Am/2<=t-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());let n=[];this.meta.forEach((i,s)=>{s!==this.clientID&&Am<=t-i.lastUpdated&&this.states.has(s)&&n.push(s)}),n.length>0&&Im(this,n,"timeout")},Yt(Am/10)),e.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){let t=this.clientID,n=this.meta.get(t),i=n===void 0?0:n.clock+1,s=this.states.get(t);e===null?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:i,lastUpdated:Rs()});let o=[],l=[],u=[],d=[];e===null?d.push(t):s==null?e!=null&&o.push(t):(l.push(t),No(s,e)||u.push(t)),(o.length>0||u.length>0||d.length>0)&&this.emit("change",[{added:o,updated:u,removed:d},"local"]),this.emit("update",[{added:o,updated:l,removed:d},"local"])}setLocalStateField(e,t){let n=this.getLocalState();n!==null&&this.setLocalState({...n,[e]:t})}getStates(){return this.states}},Im=(r,e,t)=>{let n=[];for(let i=0;i<e.length;i++){let s=e[i];if(r.states.has(s)){if(r.states.delete(s),s===r.clientID){let o=r.meta.get(s);r.meta.set(s,{clock:o.clock+1,lastUpdated:Rs()})}n.push(s)}}n.length>0&&(r.emit("change",[{added:[],updated:[],removed:n},t]),r.emit("update",[{added:[],updated:[],removed:n},t]))},_f=(r,e,t=r.states)=>{let n=e.length,i=Ot();be(i,n);for(let s=0;s<n;s++){let o=e[s],l=t.get(o)||null,u=r.meta.get(o).clock;be(i,o),be(i,u),Kn(i,JSON.stringify(l))}return qt(i)};var nE=(r,e,t)=>{let n=Zr(e),i=Rs(),s=[],o=[],l=[],u=[],d=ve(n);for(let f=0;f<d;f++){let h=ve(n),m=ve(n),g=JSON.parse(Jn(n)),y=r.meta.get(h),b=r.states.get(h),C=y===void 0?0:y.clock;(C<m||C===m&&g===null&&r.states.has(h))&&(g===null?h===r.clientID&&r.getLocalState()!=null?m++:r.states.delete(h):r.states.set(h,g),r.meta.set(h,{clock:m,lastUpdated:i}),y===void 0&&g!==null?s.push(h):y!==void 0&&g===null?u.push(h):g!==null&&(No(g,b)||l.push(h),o.push(h)))}(s.length>0||l.length>0||u.length>0)&&r.emit("change",[{added:s,updated:l,removed:u},t]),(s.length>0||o.length>0||u.length>0)&&r.emit("update",[{added:s,updated:o,removed:u},t])};var zo=de(require("vscode"));var Fi=de(require("vscode")),qe;(s=>{s.SCHEME="oct";function e(o,l){return Fi.Uri.parse(`${s.SCHEME}:///${o}${l?"/"+l:""}`)}s.create=e;function t(o){if(!o)return;let l=o.toString(!0),u=Fi.workspace.workspaceFolders??[];for(let d of u){let f=d.uri.toString(!0)+"/";if(l.startsWith(f))return d.name+"/"+l.substring(f.length)}}s.getProtocolPath=t;function n(o){if(!o)return;let l=o.split("/"),u=l[0],d=l.slice(1),f=(Fi.workspace.workspaceFolders??[]).find(h=>h.name===u);if(f){let h=i(f.uri.path,...d);return f.uri.with({path:h})}else return}s.getResourceUri=n;function i(...o){if(o.length===0)return".";let l;for(let u of o)u.length>0&&(l===void 0?l=u:l+="/"+u);return l===void 0?".":l}})(qe||={});var Zn;(i=>{function r(s){return Fi.Uri.parse(s.serverUrl).with({fragment:s.roomId}).toString(!0)}i.create=r;let e=/^[a-zA-Z0-9]+$/;function t(s){if(e.test(s))return{serverUrl:void 0,roomId:s};{let o=Fi.Uri.parse(s,!0);if(!e.test(o.fragment))throw new Error(`Invalid room id: ${o.fragment}`);return{serverUrl:o.with({fragment:""}).toString(!0),roomId:o.fragment}}}i.parse=t;function n(s){return Fi.Uri.parse(s).toString(!0)}i.normalizeServerUri=n})(Zn||={});var Sf=class{providerRegistration;fileSystemProvider;readOnly=!1;constructor(e,t,n){this.fileSystemProvider=new Om(e,t,n)}registerFileSystemProvider(e){if(this.providerRegistration){if(this.readOnly===e)return;this.providerRegistration.dispose()}this.readOnly=e,this.providerRegistration=zo.workspace.registerFileSystemProvider(qe.SCHEME,this.fileSystemProvider,{isReadonly:e})}triggerChangeEvent(e){this.fileSystemProvider.triggerChangeEvent(e)}dispose(){this.providerRegistration?.dispose()}},Om=class{connection;yjs;hostId;encoder=new TextEncoder;onDidChangeFileEmitter=new zo.EventEmitter;constructor(e,t,n){this.connection=e,this.yjs=t,this.hostId=n}onDidChangeFile=this.onDidChangeFileEmitter.event;watch(){return zo.Disposable.from()}async stat(e){let t=this.getHostPath(e);return await this.connection.fs.stat(this.hostId,t)}async readDirectory(e){let t=this.getHostPath(e),n=await this.connection.fs.readdir(this.hostId,t);return Object.entries(n)}createDirectory(e){let t=this.getHostPath(e);return this.connection.fs.mkdir(this.hostId,t)}async readFile(e){let t=this.getHostPath(e);if(this.yjs.share.has(t)){let n=this.yjs.getText(t);return this.encoder.encode(n.toString())}else return(await this.connection.fs.readFile(this.hostId,t)).content}writeFile(e,t,n){let i=this.getHostPath(e);this.connection.fs.writeFile(this.hostId,i,{content:t})}delete(e,t){return this.connection.fs.delete(this.hostId,this.getHostPath(e))}rename(e,t,n){return this.connection.fs.rename(this.hostId,this.getHostPath(e),this.getHostPath(t))}triggerChangeEvent(e){this.onDidChangeFileEmitter.fire(e)}getHostPath(e){return e.path.substring(1).split("/").slice(1).join("/")}};var xf=0,sE=1,oE=2,Dm=(r,e)=>{be(r,xf);let t=Ix(e);tt(r,t)},Pm=(r,e,t)=>{be(r,sE),tt(r,Tx(e,t))},fF=(r,e,t)=>Pm(e,t,dt(r)),aE=(r,e,t)=>{try{kx(e,dt(r),t)}catch(n){console.error("Caught error while handling a Yjs update",n)}},cE=(r,e)=>{be(r,oE),tt(r,e)},dF=aE,lE=(r,e,t,n)=>{let i=ve(r);switch(i){case xf:fF(r,e,t);break;case sE:aE(r,t,n);break;case oE:dF(r,t,n);break;default:throw new Error("Unknown message type")}return i};var uE="local",Ef=class extends To{connection;doc;awareness;constructor(e,t,n,i){super(),this.connection=e,this.doc=t,this.awareness=n,this.doc.on("update",this.yjsUpdateHandler.bind(this)),this.awareness.on("update",this.yjsAwarenessUpdateHandler.bind(this)),e.sync.onDataUpdate(this.ocpDataUpdateHandler.bind(this)),e.sync.onAwarenessUpdate(this.ocpAwarenessUpdateHandler.bind(this)),e.sync.onAwarenessQuery(this.ocpAwarenessQueryHandler.bind(this)),i?.resyncTimer&&i.resyncTimer>0&&this.setResyncInterval(i.resyncTimer)}setResyncInterval(e){let t=setInterval(()=>{let n=Ot();Dm(n,this.doc),this.connection.sync.dataUpdate(this.encode(n))},e);this.doc.on("destroy",()=>{clearInterval(t)})}ocpDataUpdateHandler(e,t){let n=this.decode(t),i=Ot();lE(n,i,this.doc,e)===xf&&this.connection.sync.dataUpdate(e,this.encode(i))}ocpAwarenessUpdateHandler(e,t){let n=this.decode(t);nE(this.awareness,dt(n),e)}ocpAwarenessQueryHandler(e){let t=Ot();tt(t,_f(this.awareness,Array.from(this.awareness.getStates().keys()))),this.connection.sync.awarenessUpdate(e,this.encode(t))}yjsUpdateHandler(e,t){if(t!==this){let n=Ot();cE(n,e),this.connection.sync.dataUpdate(this.encode(n))}}yjsAwarenessUpdateHandler(e){let t=e.added.concat(e.updated).concat(e.removed),n=Ot();tt(n,_f(this.awareness,t)),this.connection.sync.awarenessUpdate(this.encode(n))}connect(){let e=Ot();Dm(e,this.doc),this.connection.sync.dataUpdate(this.encode(e));let t=Ot();Pm(t,this.doc),this.connection.sync.dataUpdate(this.encode(t)),this.connection.sync.awarenessQuery();let n=Ot();tt(n,_f(this.awareness,[this.doc.clientID])),this.connection.sync.awarenessUpdate(this.encode(n))}dispose(){Im(this.awareness,[this.doc.clientID],"client disconnected")}encode(e){return qt(e)}decode(e){return Zr(e)}};var Cf;(function(r){function e(t){return[...t].sort((n,i)=>n.start-i.start)}r.sort=e})(Cf||(Cf={}));var Um;(function(r){function e(s){return typeof s.insert=="string"}r.isInsert=e;function t(s){return typeof s.delete=="number"}r.isDelete=t;function n(s){return typeof s.retain=="number"}r.isRetain=n;function i(s){let o=[],l=0;for(let u of s)n(u)?l+=u.retain:e(u)?o.push({start:l,end:l,text:u.insert}):t(u)&&(o.push({start:l,end:l+u.delete,text:""}),l+=u.delete);return o}r.toChanges=i})(Um||(Um={}));var kf=class{_yjsText;_text;_textLength;_normalizedLength;_changeSets=[];_offsets;observer;constructor(e,t){this._yjsText=e,this._text=e.toString(),this.observer=n=>{this.observe(n,t)},e.observe(this.observer)}async observe(e,t){if(e.transaction.local)return;let n=this._text.includes("\r"),i=Um.toChanges(e.delta),s=[];for(let f of i)s.push({start:this.originalOffset(f.start),end:this.originalOffset(f.end),text:this.normalize(f.text,n)});let o=this._text;this.doUpdate({changes:s},!1);let l=this._text,u={before:o,after:l};this._changeSets.push(u),await t(s);let d=this._changeSets.indexOf(u);d!==-1&&this._changeSets.splice(d,1)}dispose(){this._yjsText.unobserve(this.observer)}originalOffset(e){let t=this.findLineOffset(e,"normalized").offsets,n=e-t.normalized;return t.offset+n}originalOffsetAt(e){return this.offsetAt(e,"offset",this._textLength)}offsetAt(e,t,n){let i=this.getLineOffsets();if(e.line>=i.length)return n;if(e.line<0)return 0;let s=i[e.line][t];return e.character<=0?s:Math.min(s+e.character,n)}positionAtNormalized(e){return this.positionAt(this.originalOffset(e))}positionAt(e){let t=this.getLineOffsets(),n=0,i=t.length;if(i===0)return{line:0,character:e};for(;n<i;){let o=Math.floor((n+i)/2);t[o].offset>e?i=o:n=o+1}let s=n-1;return e=this.ensureBeforeEOL(e,t[s].offset),{line:s,character:e-t[s].offset}}normalizedOffset(e){let t=this.findLineOffset(e,"offset").offsets,n=e-t.offset;return t.normalized+n}normalizedOffsetAt(e){return this.offsetAt(e,"normalized",this._normalizedLength)}update(e){let t=()=>{typeof e.changes=="string"?this.doUpdate(e,!0):this.shouldApply(e.changes)&&this.doUpdate(e,!0)};this._yjsText.doc?this._yjsText.doc.transact(()=>t()):t()}shouldApply(e){e=Cf.sort(e);for(let t of this._changeSets){let n=t.before,i=0;for(let s of e){let{start:o,end:l,text:u}=s;n=n.substring(0,o+i)+u+n.substring(l+i),i+=s.text.length-(l-o)}if(n===t.after)return!1}return!0}doUpdate(e,t){if(this._offsets=void 0,typeof e.changes=="string"){if(this._text=e.changes,t){let n=this._yjsText.toString();this._yjsText.delete(0,n.length),this._yjsText.insert(0,this.normalize(this._text,!1))}}else{let n=0;for(let i of Cf.sort(e.changes)){let s=i.start+n,o=i.end+n,[l,u]=this.countNormalizedOffsets(s,o);this._text=this._text.substring(0,s)+i.text+this._text.substring(o),n+=i.text.length-(o-s),t&&(this._yjsText.delete(l,u-l),this._yjsText.insert(l,this.normalize(i.text,!1)))}}}countNormalizedOffsets(e,t){let n=0,i=0,s=0;for(;s<t;s++)this._text.charCodeAt(s)!==13&&(s<e&&n++,i++);return[n,i]}normalize(e,t){let n=t?`\r
`:`
`;return e.replace(/\r?\n/g,n)}ensureBeforeEOL(e,t){for(;e>t&&fE(this._text.charCodeAt(e-1));)e--;return e}findLineOffset(e,t){let n=this.getLineOffsets(),i=0,s=n.length;for(;i<s;){let l=(i+s)/2|0;n[l][t]>e?s=l:i=l+1}let o=i-1;return{offsets:n[o],index:o}}getLineOffsets(){if(this._offsets===void 0){let e=pF(this._text);this._offsets=e.offsets,this._textLength=e.length,this._normalizedLength=e.normalizedLength}return this._offsets}};function pF(r){let e=[{normalized:0,offset:0}],t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);if(fE(i)){i===13&&n+1<r.length&&r.charCodeAt(n+1)===10&&(n++,t++);let s=n+1,o=s-t;e.push({normalized:o,offset:s})}}return{offsets:e,length:r.length,normalizedLength:r.length+e.length-t}}function fE(r){return r===13||r===10}var pg=de(Bm()),UC=de(WE());var pj=de(Id(),1);var Mm=Symbol.for("@inversifyjs/common/islazyServiceIdentifier"),Ho=class{[Mm];#e;constructor(e){this.#e=e,this[Mm]=!0}static is(e){return typeof e=="object"&&e!==null&&e[Mm]===!0}unwrap(){return this.#e()}};function Cn(r,e){return Reflect.getMetadata(e,r)}function qm(r,e,t,n){let i=n(Cn(r,e)??t);Reflect.defineMetadata(e,i,r)}var Rf="named",Wm="name",zm="unmanaged",Hm="optional",Gm="inject",Ym="multi_inject",HE="post_construct",GE="pre_destroy",aN=[Gm,Ym,Wm,zm,Rf,Hm],jm=Symbol.for("@inversifyjs/core/InversifyCoreError"),ei=class r extends Error{[jm];kind;constructor(e,t,n){super(t,n),this[jm]=!0,this.kind=e}static is(e){return typeof e=="object"&&e!==null&&e[jm]===!0}static isErrorOfKind(e,t){return r.is(e)&&e.kind===t}},ti,jt;function YE(r,e){let t=[];for(let n=0;n<e.length;++n)e[n]===void 0&&t.push(n);if(t.length>0)throw new ei(ti.missingInjectionDecorator,`Found unexpected missing metadata on type "${r.name}" at constructor indexes "${t.join('", "')}".

Are you using @inject, @multiInject or @unmanaged decorators at those indexes?

If you're using typescript and want to rely on auto injection, set "emitDecoratorMetadata" compiler option to true`)}function KE(r){return{kind:jt.singleInjection,name:void 0,optional:!1,tags:new Map,targetName:void 0,value:r}}function Tc(r){let e=r.find(o=>o.key===Gm),t=r.find(o=>o.key===Ym);if(r.find(o=>o.key===zm)!==void 0)return function(o,l){if(l!==void 0||o!==void 0)throw new ei(ti.missingInjectionDecorator,"Expected a single @inject, @multiInject or @unmanaged metadata");return{kind:jt.unmanaged}}(e,t);if(t===void 0&&e===void 0)throw new ei(ti.missingInjectionDecorator,"Expected @inject, @multiInject or @unmanaged metadata");let n=r.find(o=>o.key===Rf),i=r.find(o=>o.key===Hm),s=r.find(o=>o.key===Wm);return{kind:e===void 0?jt.multipleInjection:jt.singleInjection,name:n?.value,optional:i!==void 0,tags:new Map(r.filter(o=>aN.every(l=>o.key!==l)).map(o=>[o.key,o.value])),targetName:s?.value,value:e===void 0?t?.value:e.value}}function JE(r,e,t){try{return Tc(t)}catch(n){throw ei.isErrorOfKind(n,ti.missingInjectionDecorator)?new ei(ti.missingInjectionDecorator,`Expected a single @inject, @multiInject or @unmanaged decorator at type "${r.name}" at constructor arguments at index "${e.toString()}"`,{cause:n}):n}}function cN(r){let e=Cn(r,"design:paramtypes"),t=Cn(r,"inversify:tagged"),n=[];if(t!==void 0)for(let[i,s]of Object.entries(t)){let o=parseInt(i);n[o]=JE(r,o,s)}if(e!==void 0){for(let i=0;i<e.length;++i)if(n[i]===void 0){let s=e[i];n[i]=KE(s)}}return YE(r,n),n}function QE(r,e,t){try{return Tc(t)}catch(n){throw ei.isErrorOfKind(n,ti.missingInjectionDecorator)?new ei(ti.missingInjectionDecorator,`Expected a single @inject, @multiInject or @unmanaged decorator at type "${r.name}" at property "${e.toString()}"`,{cause:n}):n}}function XE(r){let e=Cn(r,"inversify:tagged_props"),t=new Map;if(e!==void 0)for(let n of Reflect.ownKeys(e)){let i=e[n];t.set(n,QE(r,n,i))}return t}function lN(r){let e=Cn(r,HE),t=Cn(r,GE);return{constructorArguments:cN(r),lifecycle:{postConstructMethodName:e?.value,preDestroyMethodName:t?.value},properties:XE(r)}}function uN(r,e){let t=e.getConstructorMetadata(r),n=[];for(let[i,s]of Object.entries(t.userGeneratedMetadata)){let o=parseInt(i);n[o]=JE(r,o,s)}if(t.compilerGeneratedMetadata!==void 0){for(let i=0;i<t.compilerGeneratedMetadata.length;++i)if(n[i]===void 0){let s=t.compilerGeneratedMetadata[i];n[i]=KE(s)}}return YE(r,n),n}function ZE(r,e){let t=e.getPropertiesMetadata(r),n=new Map;for(let i of Reflect.ownKeys(t)){let s=t[i];n.set(i,QE(r,i,s))}return n}function fN(r,e){let t=Cn(r,HE),n=Cn(r,GE);return{constructorArguments:uN(r,e),lifecycle:{postConstructMethodName:t?.value,preDestroyMethodName:n?.value},properties:ZE(r,e)}}function zE(r){return Object.getPrototypeOf(r.prototype)?.constructor}function dN(r){return r.kind===jt.unmanaged?[{key:zm,value:!0}]:function(e){let t=[hN(e)];e.name!==void 0&&t.push({key:Rf,value:e.name}),e.optional&&t.push({key:Hm,value:!0});for(let[n,i]of e.tags)t.push({key:n,value:i});return e.targetName!==void 0&&t.push({key:Wm,value:e.targetName}),t}(r)}function hN(r){let e;switch(r.kind){case jt.multipleInjection:e={key:Ym,value:r.value};break;case jt.singleInjection:e={key:Gm,value:r.value}}return e}(function(r){r[r.injectionDecoratorConflict=0]="injectionDecoratorConflict",r[r.missingInjectionDecorator=1]="missingInjectionDecorator",r[r.planning=2]="planning",r[r.unknown=3]="unknown"})(ti||(ti={})),function(r){r[r.multipleInjection=0]="multipleInjection",r[r.singleInjection=1]="singleInjection",r[r.unmanaged=2]="unmanaged"}(jt||(jt={}));var Vm=class{#e;constructor(e){this.#e=e}startsWith(e){return this.#e.startsWith(e)}endsWith(e){return this.#e.endsWith(e)}contains(e){return this.#e.includes(e)}equals(e){return this.#e===e}value(){return this.#e}},$m="@inversifyjs/core/targetId",Ps=class{#e;#t;#r;#n;#i;#s;constructor(e,t,n){this.#t=function(){let i=Cn(Object,$m)??0;return i===Number.MAX_SAFE_INTEGER?qm(Object,$m,i,()=>Number.MIN_SAFE_INTEGER):qm(Object,$m,i,s=>s+1),i}(),this.#r=e,this.#n=void 0,this.#e=t,this.#i=new Vm(typeof e=="string"?e:e.toString().slice(7,-1)),this.#s=n}get id(){return this.#t}get identifier(){return this.#r}get metadata(){return this.#n===void 0&&(this.#n=dN(this.#e)),this.#n}get name(){return this.#i}get type(){return this.#s}get serviceIdentifier(){return Ho.is(this.#e.value)?this.#e.value.unwrap():this.#e.value}getCustomTags(){return[...this.#e.tags.entries()].map(([e,t])=>({key:e,value:t}))}getNamedTag(){return this.#e.name===void 0?null:{key:Rf,value:this.#e.name}}hasTag(e){return this.metadata.some(t=>t.key===e)}isArray(){return this.#e.kind===jt.multipleInjection}isNamed(){return this.#e.name!==void 0}isOptional(){return this.#e.optional}isTagged(){return this.#e.tags.size>0}matchesArray(e){return this.isArray()&&this.#e.value===e}matchesNamedTag(e){return this.#e.name===e}matchesTag(e){return t=>this.metadata.some(n=>n.key===e&&n.value===t)}},Km=r=>function(e,t){return function(n){let i=e(n),s=zE(n);for(;s!==void 0&&s!==Object;){let l=t(s);for(let[u,d]of l)i.properties.has(u)||i.properties.set(u,d);s=zE(s)}let o=[];for(let l of i.constructorArguments)if(l.kind!==jt.unmanaged){let u=l.targetName??"";o.push(new Ps(u,l,"ConstructorArgument"))}for(let[l,u]of i.properties)if(u.kind!==jt.unmanaged){let d=u.targetName??l;o.push(new Ps(d,u,"ClassProperty"))}return o}}(r===void 0?lN:e=>fN(e,r),r===void 0?XE:e=>ZE(e,r));var pr="named",lC="name",og="unmanaged",ag="optional",Lf="inject",Ff="multi_inject",cg="inversify:tagged",lg="inversify:tagged_props",Qm="inversify:paramtypes",ug="design:paramtypes",If="post_construct",Oc="pre_destroy",pN=[Lf,Ff,lC,og,pr,ag],yj=Object.freeze({__proto__:null,DESIGN_PARAM_TYPES:ug,INJECT_TAG:Lf,MULTI_INJECT_TAG:Ff,NAMED_TAG:pr,NAME_TAG:lC,NON_CUSTOM_TAG_KEYS:pN,OPTIONAL_TAG:ag,PARAM_TYPES:Qm,POST_CONSTRUCT:If,PRE_DESTROY:Oc,TAGGED:cg,TAGGED_PROP:lg,UNMANAGED_TAG:og}),at={Request:"Request",Singleton:"Singleton",Transient:"Transient"},He={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},uC={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},mN=0;function Nf(){return mN++}var Xm=class r{id;moduleId;activated;serviceIdentifier;implementationType;cache;dynamicValue;scope;type;factory;provider;constraint;onActivation;onDeactivation;constructor(e,t){this.id=Nf(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=He.Invalid,this.constraint=n=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}clone(){let e=new r(this.serviceIdentifier,this.scope);return e.activated=e.scope===at.Singleton&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e}},fC="Metadata key was used more than once in a parameter:",eC="NULL argument",tC="Key Not Found",gN="Ambiguous match found for serviceIdentifier:",yN="No matching bindings found for serviceIdentifier:",dC="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",Zm=(r,e)=>`onDeactivation() error in class ${r}: ${e}`,eg=class{getConstructorMetadata(e){return{compilerGeneratedMetadata:Reflect.getMetadata(ug,e)??[],userGeneratedMetadata:Reflect.getMetadata(cg,e)??{}}}getPropertiesMetadata(e){return Reflect.getMetadata(lg,e)??{}}},Go;function hC(r){return r instanceof RangeError||r.message==="Maximum call stack size exceeded"}(function(r){r[r.MultipleBindingsAvailable=2]="MultipleBindingsAvailable",r[r.NoBindingsAvailable=0]="NoBindingsAvailable",r[r.OnlyOneBindingAvailable=1]="OnlyOneBindingAvailable"})(Go||(Go={}));function Ni(r){return typeof r=="function"?r.name:typeof r=="symbol"?r.toString():r}function rC(r,e,t){let n="",i=t(r,e);return i.length!==0&&(n=`
Registered bindings:`,i.forEach(s=>{let o="Object";s.implementationType!==null&&(o=gC(s.implementationType)),n=`${n}
 ${o}`,s.constraint.metaData&&(n=`${n} - ${s.constraint.metaData}`)})),n}function pC(r,e){return r.parentRequest!==null&&(r.parentRequest.serviceIdentifier===e||pC(r.parentRequest,e))}function mC(r){r.childRequests.forEach(e=>{if(pC(r,e.serviceIdentifier)){let t=function(n){return function s(o,l=[]){let u=Ni(o.serviceIdentifier);return l.push(u),o.parentRequest!==null?s(o.parentRequest,l):l}(n).reverse().join(" --> ")}(e);throw new Error(`Circular dependency found: ${t}`)}mC(e)})}function gC(r){if(r.name!=null&&r.name!=="")return r.name;{let e=r.toString(),t=e.match(/^function\s*([^\s(]+)/);return t===null?`Anonymous function: ${e}`:t[1]}}function nC(r){return`{"key":"${r.key.toString()}","value":"${r.value.toString()}"}`}var Of=class{id;container;plan;currentRequest;constructor(e){this.id=Nf(),this.container=e}addPlan(e){this.plan=e}setCurrentRequest(e){this.currentRequest=e}},Bi=class{key;value;constructor(e,t){this.key=e,this.value=t}toString(){return this.key===pr?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}},tg=class{parentContext;rootRequest;constructor(e,t){this.parentContext=e,this.rootRequest=t}};function yC(r,e){let t=function(l){return Object.getPrototypeOf(l.prototype)?.constructor}(e);if(t===void 0||t===Object)return 0;let n=Km(r)(t),i=n.map(l=>l.metadata.filter(u=>u.key===og)),s=[].concat.apply([],i).length,o=n.length-s;return o>0?o:yC(r,t)}var Dc=class r{id;serviceIdentifier;parentContext;parentRequest;bindings;childRequests;target;requestScope;constructor(e,t,n,i,s){this.id=Nf(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=s,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=n===null?new Map:null}addChildRequest(e,t,n){let i=new r(e,this.parentContext,this,t,n);return this.childRequests.push(i),i}};function Df(r){return r._bindingDictionary}function iC(r,e,t,n,i){let s=Rc(t.container,i.serviceIdentifier),o=[];return s.length===Go.NoBindingsAvailable&&t.container.options.autoBindInjectable===!0&&typeof i.serviceIdentifier=="function"&&r.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(t.container.bind(i.serviceIdentifier).toSelf(),s=Rc(t.container,i.serviceIdentifier)),o=e?s:s.filter(l=>{let u=new Dc(l.serviceIdentifier,t,n,l,i);return l.constraint(u)}),function(l,u,d,f,h){switch(u.length){case Go.NoBindingsAvailable:if(f.isOptional())return u;{let m=Ni(l),g=yN;throw g+=function(y,b){if(b.isTagged()||b.isNamed()){let C="",L=b.getNamedTag(),j=b.getCustomTags();return L!==null&&(C+=nC(L)+`
`),j!==null&&j.forEach(O=>{C+=nC(O)+`
`}),` ${y}
 ${y} - ${C}`}return` ${y}`}(m,f),g+=rC(h,m,Rc),d!==null&&(g+=`
Trying to resolve bindings for "${Ni(d.serviceIdentifier)}"`),new Error(g)}case Go.OnlyOneBindingAvailable:return u;case Go.MultipleBindingsAvailable:default:if(f.isArray())return u;{let m=Ni(l),g=`${gN} ${m}`;throw g+=rC(h,m,Rc),new Error(g)}}}(i.serviceIdentifier,o,n,i,t.container),o}function wC(r,e){let t=e.isMultiInject?Ff:Lf,n=[new Bi(t,r)];return e.customTag!==void 0&&n.push(new Bi(e.customTag.key,e.customTag.value)),e.isOptional===!0&&n.push(new Bi(ag,!0)),n}function bC(r,e,t,n,i,s){let o,l;if(i===null){o=iC(r,e,n,null,s),l=new Dc(t,n,null,o,s);let u=new tg(n,l);n.addPlan(u)}else o=iC(r,e,n,i,s),l=i.addChildRequest(s.serviceIdentifier,o,s);o.forEach(u=>{let d=null;if(s.isArray())d=l.addChildRequest(u.serviceIdentifier,u,s);else{if(u.cache!==null)return;d=l}if(u.type===He.Instance&&u.implementationType!==null){let f=function(h,m){return Km(h)(m)}(r,u.implementationType);if(n.container.options.skipBaseClassChecks!==!0){let h=yC(r,u.implementationType);if(f.length<h){let m=`The number of constructor arguments in the derived class ${gC(u.implementationType)} must be >= than the number of constructor arguments of its base class.`;throw new Error(m)}}f.forEach(h=>{bC(r,!1,h.serviceIdentifier,n,d,h)})}})}function Rc(r,e){let t=[],n=Df(r);return n.hasKey(e)?t=n.get(e):r.parent!==null&&(t=Rc(r.parent,e)),t}function wN(r,e,t,n,i,s=!1){let o=new Of(e),l=function(u,d,f){let h=wC(d,f),m=Tc(h);if(m.kind===jt.unmanaged)throw new Error("Unexpected metadata when creating target");return new Ps("",m,u)}(t,n,i);try{return bC(r,s,n,o,null,l),o}catch(u){throw hC(u)&&mC(o.plan.rootRequest),u}}function Qt(r){return(typeof r=="object"&&r!==null||typeof r=="function")&&typeof r.then=="function"}function vC(r){return!!Qt(r)||Array.isArray(r)&&r.some(Qt)}var bN=(r,e,t)=>{r.has(e.id)||r.set(e.id,t)},vN=(r,e)=>{r.cache=e,r.activated=!0,Qt(e)&&_N(r,e)},_N=async(r,e)=>{try{let t=await e;r.cache=t}catch(t){throw r.cache=null,r.activated=!1,t}},Ic;(function(r){r.DynamicValue="toDynamicValue",r.Factory="toFactory",r.Provider="toProvider"})(Ic||(Ic={}));function SN(r,e,t){let n;if(e.length>0){let i=function(o,l){return o.reduce((u,d)=>{let f=l(d);return d.target.type===uC.ConstructorArgument?u.constructorInjections.push(f):(u.propertyRequests.push(d),u.propertyInjections.push(f)),u.isAsync||(u.isAsync=vC(f)),u},{constructorInjections:[],isAsync:!1,propertyInjections:[],propertyRequests:[]})}(e,t),s={...i,constr:r};n=i.isAsync?async function(o){let l=await oC(o.constructorInjections),u=await oC(o.propertyInjections);return sC({...o,constructorInjections:l,propertyInjections:u})}(s):sC(s)}else n=new r;return n}function sC(r){let e=new r.constr(...r.constructorInjections);return r.propertyRequests.forEach((t,n)=>{let i=t.target.identifier,s=r.propertyInjections[n];t.target.isOptional()&&s===void 0||(e[i]=s)}),e}async function oC(r){let e=[];for(let t of r)Array.isArray(t)?e.push(Promise.all(t)):e.push(t);return Promise.all(e)}function aC(r,e){let t=function(n,i){if(Reflect.hasMetadata(If,n)){let l=Reflect.getMetadata(If,n);try{return i[l.value]?.()}catch(u){if(u instanceof Error)throw new Error((s=n.name,o=u.message,`@postConstruct error in class ${s}: ${o}`))}}var s,o}(r,e);return Qt(t)?t.then(()=>e):e}function xN(r,e){r.scope!==at.Singleton&&function(t,n){let i=`Class cannot be instantiated in ${t.scope===at.Request?"request":"transient"} scope.`;if(typeof t.onDeactivation=="function")throw new Error(Zm(n.name,i));if(Reflect.hasMetadata(Oc,n))throw new Error(`@preDestroy error in class ${n.name}: ${i}`)}(r,e)}var fg=r=>e=>{e.parentContext.setCurrentRequest(e);let t=e.bindings,n=e.childRequests,i=e.target&&e.target.isArray(),s=!(e.parentRequest&&e.parentRequest.target&&e.target&&e.parentRequest.target.matchesArray(e.target.serviceIdentifier));if(i&&s)return n.map(o=>fg(r)(o));{if(e.target.isOptional()&&t.length===0)return;let o=t[0];return TN(r,e,o)}},EN=(r,e)=>{let t=(n=>{switch(n.type){case He.Factory:return{factory:n.factory,factoryType:Ic.Factory};case He.Provider:return{factory:n.provider,factoryType:Ic.Provider};case He.DynamicValue:return{factory:n.dynamicValue,factoryType:Ic.DynamicValue};default:throw new Error(`Unexpected factory type ${n.type}`)}})(r);return((n,i)=>{try{return n()}catch(s){throw hC(s)?i():s}})(()=>t.factory.bind(r)(e),()=>{return new Error((n=t.factoryType,i=e.currentRequest.serviceIdentifier.toString(),`It looks like there is a circular dependency in one of the '${n}' bindings. Please investigate bindings with service identifier '${i}'.`));var n,i})},CN=(r,e,t)=>{let n,i=e.childRequests;switch((s=>{let o=null;switch(s.type){case He.ConstantValue:case He.Function:o=s.cache;break;case He.Constructor:case He.Instance:o=s.implementationType;break;case He.DynamicValue:o=s.dynamicValue;break;case He.Provider:o=s.provider;break;case He.Factory:o=s.factory}if(o===null){let l=Ni(s.serviceIdentifier);throw new Error(`Invalid binding type: ${l}`)}})(t),t.type){case He.ConstantValue:case He.Function:n=t.cache;break;case He.Constructor:n=t.implementationType;break;case He.Instance:n=function(s,o,l,u){xN(s,o);let d=SN(o,l,u);return Qt(d)?d.then(f=>aC(o,f)):aC(o,d)}(t,t.implementationType,i,fg(r));break;default:n=EN(t,e.parentContext)}return n},kN=(r,e,t)=>{let n=((i,s)=>s.scope===at.Singleton&&s.activated?s.cache:s.scope===at.Request&&i.has(s.id)?i.get(s.id):null)(r,e);return n!==null||(n=t(),((i,s,o)=>{s.scope===at.Singleton&&vN(s,o),s.scope===at.Request&&bN(i,s,o)})(r,e,n)),n},TN=(r,e,t)=>kN(r,t,()=>{let n=CN(r,e,t);return n=Qt(n)?n.then(i=>cC(e,t,i)):cC(e,t,n),n});function cC(r,e,t){let n=RN(r.parentContext,e,t),i=ON(r.parentContext.container),s,o=i.next();do{s=o.value;let l=r.parentContext,u=r.serviceIdentifier,d=IN(s,u);n=Qt(n)?_C(d,l,n):AN(d,l,n),o=i.next()}while(o.done!==!0&&!Df(s).hasKey(r.serviceIdentifier));return n}var RN=(r,e,t)=>{let n;return n=typeof e.onActivation=="function"?e.onActivation(r,t):t,n},AN=(r,e,t)=>{let n=r.next();for(;n.done!==!0;){if(Qt(t=n.value(e,t)))return _C(r,e,t);n=r.next()}return t},_C=async(r,e,t)=>{let n=await t,i=r.next();for(;i.done!==!0;)n=await i.value(e,n),i=r.next();return n},IN=(r,e)=>{let t=r._activations;return t.hasKey(e)?t.get(e).values():[].values()},ON=r=>{let e=[r],t=r.parent;for(;t!==null;)e.push(t),t=t.parent;return{next:()=>{let n=e.pop();return n!==void 0?{done:!1,value:n}:{done:!0,value:void 0}}}},ri=(r,e)=>{let t=r.parentRequest;return t!==null&&(!!e(t)||ri(t,e))},Ac=r=>e=>{let t=n=>n!==null&&n.target!==null&&n.target.matchesTag(r)(e);return t.metaData=new Bi(r,e),t},Af=Ac(pr),Jm=r=>e=>{let t=null;if(e!==null){if(t=e.bindings[0],typeof r=="string")return t.serviceIdentifier===r;{let n=e.bindings[0].implementationType;return r===n}}return!1},Yo=class{_binding;constructor(e){this._binding=e}when(e){return this._binding.constraint=e,new mt(this._binding)}whenTargetNamed(e){return this._binding.constraint=Af(e),new mt(this._binding)}whenTargetIsDefault(){return this._binding.constraint=e=>e===null?!1:e.target!==null&&!e.target.isNamed()&&!e.target.isTagged(),new mt(this._binding)}whenTargetTagged(e,t){return this._binding.constraint=Ac(e)(t),new mt(this._binding)}whenInjectedInto(e){return this._binding.constraint=t=>t!==null&&Jm(e)(t.parentRequest),new mt(this._binding)}whenParentNamed(e){return this._binding.constraint=t=>t!==null&&Af(e)(t.parentRequest),new mt(this._binding)}whenParentTagged(e,t){return this._binding.constraint=n=>n!==null&&Ac(e)(t)(n.parentRequest),new mt(this._binding)}whenAnyAncestorIs(e){return this._binding.constraint=t=>t!==null&&ri(t,Jm(e)),new mt(this._binding)}whenNoAncestorIs(e){return this._binding.constraint=t=>t!==null&&!ri(t,Jm(e)),new mt(this._binding)}whenAnyAncestorNamed(e){return this._binding.constraint=t=>t!==null&&ri(t,Af(e)),new mt(this._binding)}whenNoAncestorNamed(e){return this._binding.constraint=t=>t!==null&&!ri(t,Af(e)),new mt(this._binding)}whenAnyAncestorTagged(e,t){return this._binding.constraint=n=>n!==null&&ri(n,Ac(e)(t)),new mt(this._binding)}whenNoAncestorTagged(e,t){return this._binding.constraint=n=>n!==null&&!ri(n,Ac(e)(t)),new mt(this._binding)}whenAnyAncestorMatches(e){return this._binding.constraint=t=>t!==null&&ri(t,e),new mt(this._binding)}whenNoAncestorMatches(e){return this._binding.constraint=t=>t!==null&&!ri(t,e),new mt(this._binding)}},mt=class{_binding;constructor(e){this._binding=e}onActivation(e){return this._binding.onActivation=e,new Yo(this._binding)}onDeactivation(e){return this._binding.onDeactivation=e,new Yo(this._binding)}},en=class{_bindingWhenSyntax;_bindingOnSyntax;_binding;constructor(e){this._binding=e,this._bindingWhenSyntax=new Yo(this._binding),this._bindingOnSyntax=new mt(this._binding)}when(e){return this._bindingWhenSyntax.when(e)}whenTargetNamed(e){return this._bindingWhenSyntax.whenTargetNamed(e)}whenTargetIsDefault(){return this._bindingWhenSyntax.whenTargetIsDefault()}whenTargetTagged(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)}whenInjectedInto(e){return this._bindingWhenSyntax.whenInjectedInto(e)}whenParentNamed(e){return this._bindingWhenSyntax.whenParentNamed(e)}whenParentTagged(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)}whenAnyAncestorIs(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)}whenNoAncestorIs(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)}whenAnyAncestorNamed(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)}whenAnyAncestorTagged(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)}whenNoAncestorNamed(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)}whenNoAncestorTagged(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)}whenAnyAncestorMatches(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)}whenNoAncestorMatches(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)}onActivation(e){return this._bindingOnSyntax.onActivation(e)}onDeactivation(e){return this._bindingOnSyntax.onDeactivation(e)}},rg=class{_binding;constructor(e){this._binding=e}inRequestScope(){return this._binding.scope=at.Request,new en(this._binding)}inSingletonScope(){return this._binding.scope=at.Singleton,new en(this._binding)}inTransientScope(){return this._binding.scope=at.Transient,new en(this._binding)}},Pf=class{_bindingInSyntax;_bindingWhenSyntax;_bindingOnSyntax;_binding;constructor(e){this._binding=e,this._bindingWhenSyntax=new Yo(this._binding),this._bindingOnSyntax=new mt(this._binding),this._bindingInSyntax=new rg(e)}inRequestScope(){return this._bindingInSyntax.inRequestScope()}inSingletonScope(){return this._bindingInSyntax.inSingletonScope()}inTransientScope(){return this._bindingInSyntax.inTransientScope()}when(e){return this._bindingWhenSyntax.when(e)}whenTargetNamed(e){return this._bindingWhenSyntax.whenTargetNamed(e)}whenTargetIsDefault(){return this._bindingWhenSyntax.whenTargetIsDefault()}whenTargetTagged(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)}whenInjectedInto(e){return this._bindingWhenSyntax.whenInjectedInto(e)}whenParentNamed(e){return this._bindingWhenSyntax.whenParentNamed(e)}whenParentTagged(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)}whenAnyAncestorIs(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)}whenNoAncestorIs(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)}whenAnyAncestorNamed(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)}whenAnyAncestorTagged(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)}whenNoAncestorNamed(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)}whenNoAncestorTagged(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)}whenAnyAncestorMatches(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)}whenNoAncestorMatches(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)}onActivation(e){return this._bindingOnSyntax.onActivation(e)}onDeactivation(e){return this._bindingOnSyntax.onDeactivation(e)}},ng=class{_binding;constructor(e){this._binding=e}to(e){return this._binding.type=He.Instance,this._binding.implementationType=e,new Pf(this._binding)}toSelf(){if(typeof this._binding.serviceIdentifier!="function")throw new Error("The toSelf function can only be applied when a constructor is used as service identifier");let e=this._binding.serviceIdentifier;return this.to(e)}toConstantValue(e){return this._binding.type=He.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=at.Singleton,new en(this._binding)}toDynamicValue(e){return this._binding.type=He.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new Pf(this._binding)}toConstructor(e){return this._binding.type=He.Constructor,this._binding.implementationType=e,this._binding.scope=at.Singleton,new en(this._binding)}toFactory(e){return this._binding.type=He.Factory,this._binding.factory=e,this._binding.scope=at.Singleton,new en(this._binding)}toFunction(e){if(typeof e!="function")throw new Error("Value provided to function binding must be a function!");let t=this.toConstantValue(e);return this._binding.type=He.Function,this._binding.scope=at.Singleton,t}toAutoFactory(e){return this._binding.type=He.Factory,this._binding.factory=t=>()=>t.container.get(e),this._binding.scope=at.Singleton,new en(this._binding)}toAutoNamedFactory(e){return this._binding.type=He.Factory,this._binding.factory=t=>n=>t.container.getNamed(e,n),new en(this._binding)}toProvider(e){return this._binding.type=He.Provider,this._binding.provider=e,this._binding.scope=at.Singleton,new en(this._binding)}toService(e){this._binding.type=He.DynamicValue,Object.defineProperty(this._binding,"cache",{configurable:!0,enumerable:!0,get:()=>null,set(t){}}),this._binding.dynamicValue=t=>{try{return t.container.get(e)}catch{return t.container.getAsync(e)}},this._binding.implementationType=null}},ig=class r{bindings;activations;deactivations;middleware;moduleActivationStore;static of(e,t,n,i,s){let o=new r;return o.bindings=e,o.middleware=t,o.deactivations=i,o.activations=n,o.moduleActivationStore=s,o}},ni=class r{_map;constructor(){this._map=new Map}getMap(){return this._map}add(e,t){if(this._checkNonNulish(e),t==null)throw new Error(eC);let n=this._map.get(e);n!==void 0?n.push(t):this._map.set(e,[t])}get(e){this._checkNonNulish(e);let t=this._map.get(e);if(t!==void 0)return t;throw new Error(tC)}remove(e){if(this._checkNonNulish(e),!this._map.delete(e))throw new Error(tC)}removeIntersection(e){this.traverse((t,n)=>{let i=e.hasKey(t)?e.get(t):void 0;if(i!==void 0){let s=n.filter(o=>!i.some(l=>o===l));this._setValue(t,s)}})}removeByCondition(e){let t=[];return this._map.forEach((n,i)=>{let s=[];for(let o of n)e(o)?t.push(o):s.push(o);this._setValue(i,s)}),t}hasKey(e){return this._checkNonNulish(e),this._map.has(e)}clone(){let e=new r;return this._map.forEach((t,n)=>{t.forEach(i=>{var s;e.add(n,typeof(s=i)=="object"&&s!==null&&"clone"in s&&typeof s.clone=="function"?i.clone():i)})}),e}traverse(e){this._map.forEach((t,n)=>{e(n,t)})}_checkNonNulish(e){if(e==null)throw new Error(eC)}_setValue(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)}},sg=class r{_map=new Map;remove(e){let t=this._map.get(e);return t===void 0?this._getEmptyHandlersStore():(this._map.delete(e),t)}addDeactivation(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)}addActivation(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)}clone(){let e=new r;return this._map.forEach((t,n)=>{e._map.set(n,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()})}),e}_getModuleActivationHandlers(e){let t=this._map.get(e);return t===void 0&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t}_getEmptyHandlersStore(){return{onActivations:new ni,onDeactivations:new ni}}},Uf=class r{id;parent;options;_middleware;_bindingDictionary;_activations;_deactivations;_snapshots;_metadataReader;_moduleActivationStore;constructor(e){let t=e||{};if(typeof t!="object")throw new Error("Invalid Container constructor argument. Container options must be an object.");if(t.defaultScope===void 0)t.defaultScope=at.Transient;else if(t.defaultScope!==at.Singleton&&t.defaultScope!==at.Transient&&t.defaultScope!==at.Request)throw new Error('Invalid Container option. Default scope must be a string ("singleton" or "transient").');if(t.autoBindInjectable===void 0)t.autoBindInjectable=!1;else if(typeof t.autoBindInjectable!="boolean")throw new Error("Invalid Container option. Auto bind injectable must be a boolean");if(t.skipBaseClassChecks===void 0)t.skipBaseClassChecks=!1;else if(typeof t.skipBaseClassChecks!="boolean")throw new Error("Invalid Container option. Skip base check must be a boolean");this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=Nf(),this._bindingDictionary=new ni,this._snapshots=[],this._middleware=null,this._activations=new ni,this._deactivations=new ni,this.parent=null,this._metadataReader=new eg,this._moduleActivationStore=new sg}static merge(e,t,...n){let i=new r,s=[e,t,...n].map(l=>Df(l)),o=Df(i);return s.forEach(l=>{var u;u=o,l.traverse((d,f)=>{f.forEach(h=>{u.add(h.serviceIdentifier,h.clone())})})}),i}load(...e){let t=this._getContainerModuleHelpersFactory();for(let n of e){let i=t(n.id);n.registry(i.bindFunction,i.unbindFunction,i.isboundFunction,i.rebindFunction,i.unbindAsyncFunction,i.onActivationFunction,i.onDeactivationFunction)}}async loadAsync(...e){let t=this._getContainerModuleHelpersFactory();for(let n of e){let i=t(n.id);await n.registry(i.bindFunction,i.unbindFunction,i.isboundFunction,i.rebindFunction,i.unbindAsyncFunction,i.onActivationFunction,i.onDeactivationFunction)}}unload(...e){e.forEach(t=>{let n=this._removeModuleBindings(t.id);this._deactivateSingletons(n),this._removeModuleHandlers(t.id)})}async unloadAsync(...e){for(let t of e){let n=this._removeModuleBindings(t.id);await this._deactivateSingletonsAsync(n),this._removeModuleHandlers(t.id)}}bind(e){return this._bind(this._buildBinding(e))}rebind(e){return this.unbind(e),this.bind(e)}async rebindAsync(e){return await this.unbindAsync(e),this.bind(e)}unbind(e){if(this._bindingDictionary.hasKey(e)){let t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)}async unbindAsync(e){if(this._bindingDictionary.hasKey(e)){let t=this._bindingDictionary.get(e);await this._deactivateSingletonsAsync(t)}this._removeServiceFromDictionary(e)}unbindAll(){this._bindingDictionary.traverse((e,t)=>{this._deactivateSingletons(t)}),this._bindingDictionary=new ni}async unbindAllAsync(){let e=[];this._bindingDictionary.traverse((t,n)=>{e.push(this._deactivateSingletonsAsync(n))}),await Promise.all(e),this._bindingDictionary=new ni}onActivation(e,t){this._activations.add(e,t)}onDeactivation(e,t){this._deactivations.add(e,t)}isBound(e){let t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t}isCurrentBound(e){return this._bindingDictionary.hasKey(e)}isBoundNamed(e,t){return this.isBoundTagged(e,pr,t)}isBoundTagged(e,t,n){let i=!1;if(this._bindingDictionary.hasKey(e)){let s=this._bindingDictionary.get(e),o=function(l,u,d){let f=wC(u,d),h=Tc(f);if(h.kind===jt.unmanaged)throw new Error("Unexpected metadata when creating target");let m=new Ps("",h,"Variable"),g=new Of(l);return new Dc(u,g,null,[],m)}(this,e,{customTag:{key:t,value:n},isMultiInject:!1});i=s.some(l=>l.constraint(o))}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i}snapshot(){this._snapshots.push(ig.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))}restore(){let e=this._snapshots.pop();if(e===void 0)throw new Error("No snapshot available to restore.");this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore}createChild(e){let t=new r(e||this.options);return t.parent=this,t}applyMiddleware(...e){let t=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((n,i)=>i(n),t)}applyCustomMetadataReader(e){this._metadataReader=e}get(e){let t=this._getNotAllArgs(e,!1,!1);return this._getButThrowIfAsync(t)}async getAsync(e){let t=this._getNotAllArgs(e,!1,!1);return this._get(t)}getTagged(e,t,n){let i=this._getNotAllArgs(e,!1,!1,t,n);return this._getButThrowIfAsync(i)}async getTaggedAsync(e,t,n){let i=this._getNotAllArgs(e,!1,!1,t,n);return this._get(i)}getNamed(e,t){return this.getTagged(e,pr,t)}async getNamedAsync(e,t){return this.getTaggedAsync(e,pr,t)}getAll(e,t){let n=this._getAllArgs(e,t,!1);return this._getButThrowIfAsync(n)}async getAllAsync(e,t){let n=this._getAllArgs(e,t,!1);return this._getAll(n)}getAllTagged(e,t,n){let i=this._getNotAllArgs(e,!0,!1,t,n);return this._getButThrowIfAsync(i)}async getAllTaggedAsync(e,t,n){let i=this._getNotAllArgs(e,!0,!1,t,n);return this._getAll(i)}getAllNamed(e,t){return this.getAllTagged(e,pr,t)}async getAllNamedAsync(e,t){return this.getAllTaggedAsync(e,pr,t)}resolve(e){let t=this.isBound(e);t||this.bind(e).toSelf();let n=this.get(e);return t||this.unbind(e),n}tryGet(e){let t=this._getNotAllArgs(e,!1,!0);return this._getButThrowIfAsync(t)}async tryGetAsync(e){let t=this._getNotAllArgs(e,!1,!0);return this._get(t)}tryGetTagged(e,t,n){let i=this._getNotAllArgs(e,!1,!0,t,n);return this._getButThrowIfAsync(i)}async tryGetTaggedAsync(e,t,n){let i=this._getNotAllArgs(e,!1,!0,t,n);return this._get(i)}tryGetNamed(e,t){return this.tryGetTagged(e,pr,t)}async tryGetNamedAsync(e,t){return this.tryGetTaggedAsync(e,pr,t)}tryGetAll(e,t){let n=this._getAllArgs(e,t,!0);return this._getButThrowIfAsync(n)}async tryGetAllAsync(e,t){let n=this._getAllArgs(e,t,!0);return this._getAll(n)}tryGetAllTagged(e,t,n){let i=this._getNotAllArgs(e,!0,!0,t,n);return this._getButThrowIfAsync(i)}async tryGetAllTaggedAsync(e,t,n){let i=this._getNotAllArgs(e,!0,!0,t,n);return this._getAll(i)}tryGetAllNamed(e,t){return this.tryGetAllTagged(e,pr,t)}async tryGetAllNamedAsync(e,t){return this.tryGetAllTaggedAsync(e,pr,t)}_preDestroy(e,t){if(e!==void 0&&Reflect.hasMetadata(Oc,e)){let n=Reflect.getMetadata(Oc,e);return t[n.value]?.()}}_removeModuleHandlers(e){let t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)}_removeModuleBindings(e){return this._bindingDictionary.removeByCondition(t=>t.moduleId===e)}_deactivate(e,t){let n=t==null?void 0:Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){let s=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if(Qt(s))return this._handleDeactivationError(s.then(async()=>this._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,n)),e.serviceIdentifier)}let i=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,n);if(Qt(i))return this._handleDeactivationError(i,e.serviceIdentifier)}catch(i){if(i instanceof Error)throw new Error(Zm(Ni(e.serviceIdentifier),i.message))}}async _handleDeactivationError(e,t){try{await e}catch(n){if(n instanceof Error)throw new Error(Zm(Ni(t),n.message))}}_deactivateContainer(e,t){let n=t.next();for(;typeof n.value=="function";){let i=n.value(e);if(Qt(i))return i.then(async()=>this._deactivateContainerAsync(e,t));n=t.next()}}async _deactivateContainerAsync(e,t){let n=t.next();for(;typeof n.value=="function";)await n.value(e),n=t.next()}_getContainerModuleHelpersFactory(){let e=u=>d=>{let f=this._buildBinding(d);return f.moduleId=u,this._bind(f)},t=()=>u=>{this.unbind(u)},n=()=>async u=>this.unbindAsync(u),i=()=>u=>this.isBound(u),s=u=>{let d=e(u);return f=>(this.unbind(f),d(f))},o=u=>(d,f)=>{this._moduleActivationStore.addActivation(u,d,f),this.onActivation(d,f)},l=u=>(d,f)=>{this._moduleActivationStore.addDeactivation(u,d,f),this.onDeactivation(d,f)};return u=>({bindFunction:e(u),isboundFunction:i(),onActivationFunction:o(u),onDeactivationFunction:l(u),rebindFunction:s(u),unbindAsyncFunction:n(),unbindFunction:t()})}_bind(e){return this._bindingDictionary.add(e.serviceIdentifier,e),new ng(e)}_buildBinding(e){let t=this.options.defaultScope||at.Transient;return new Xm(e,t)}async _getAll(e){return Promise.all(this._get(e))}_get(e){let t={...e,contextInterceptor:n=>n,targetType:uC.Variable};if(this._middleware){let n=this._middleware(t);if(n==null)throw new Error("Invalid return type in middleware. Middleware must return!");return n}return this._planAndResolve()(t)}_getButThrowIfAsync(e){let t=this._get(e);if(vC(t))throw new Error(`You are attempting to construct ${function(n){return typeof n=="function"?`[function/class ${n.name||"<anonymous>"}]`:typeof n=="symbol"?n.toString():`'${n}'`}(e.serviceIdentifier)} in a synchronous way but it has asynchronous dependencies.`);return t}_getAllArgs(e,t,n){return{avoidConstraints:!t?.enforceBindingConstraints,isMultiInject:!0,isOptional:n,serviceIdentifier:e}}_getNotAllArgs(e,t,n,i,s){return{avoidConstraints:!1,isMultiInject:t,isOptional:n,key:i,serviceIdentifier:e,value:s}}_getPlanMetadataFromNextArgs(e){let t={isMultiInject:e.isMultiInject};return e.key!==void 0&&(t.customTag={key:e.key,value:e.value}),e.isOptional===!0&&(t.isOptional=!0),t}_planAndResolve(){return e=>{let t=wN(this._metadataReader,this,e.targetType,e.serviceIdentifier,this._getPlanMetadataFromNextArgs(e),e.avoidConstraints);return t=e.contextInterceptor(t),function(i){return fg(i.plan.rootRequest.requestScope)(i.plan.rootRequest)}(t)}}_deactivateIfSingleton(e){if(e.activated)return Qt(e.cache)?e.cache.then(t=>this._deactivate(e,t)):this._deactivate(e,e.cache)}_deactivateSingletons(e){for(let t of e)if(Qt(this._deactivateIfSingleton(t)))throw new Error("Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)")}async _deactivateSingletonsAsync(e){await Promise.all(e.map(async t=>this._deactivateIfSingleton(t)))}_propagateContainerDeactivationThenBindingAndPreDestroy(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)}async _propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,n){this.parent?await this._deactivate.bind(this.parent)(e,t):await this._bindingDeactivationAndPreDestroyAsync(e,t,n)}_removeServiceFromDictionary(e){try{this._bindingDictionary.remove(e)}catch{throw new Error(`Could not unbind serviceIdentifier: ${Ni(e)}`)}}_bindingDeactivationAndPreDestroy(e,t,n){if(typeof e.onDeactivation=="function"){let i=e.onDeactivation(t);if(Qt(i))return i.then(()=>this._preDestroy(n,t))}return this._preDestroy(n,t)}async _bindingDeactivationAndPreDestroyAsync(e,t,n){typeof e.onDeactivation=="function"&&await e.onDeactivation(t),await this._preDestroy(n,t)}};function DN(r,e,t,n){(function(i){if(i!==void 0)throw new Error(dC)})(e),SC(cg,r,t.toString(),n)}function PN(r){let e=[];if(Array.isArray(r)){e=r;let t=function(n){let i=new Set;for(let s of n){if(i.has(s))return s;i.add(s)}}(e.map(n=>n.key));if(t!==void 0)throw new Error(`${fC} ${t.toString()}`)}else e=[r];return e}function SC(r,e,t,n){let i=PN(n),s={};Reflect.hasOwnMetadata(r,e)&&(s=Reflect.getMetadata(r,e));let o=s[t];if(o===void 0)o=[];else for(let l of o)if(i.some(u=>u.key===l.key))throw new Error(`${fC} ${l.key.toString()}`);o.push(...i),s[t]=o,Reflect.defineMetadata(r,s,e)}function UN(r){return(e,t,n)=>{typeof n=="number"?DN(e,t,n,r):function(i,s,o){if(i.prototype!==void 0)throw new Error(dC);SC(lg,i.constructor,s,o)}(e,t,r)}}function St(){return function(r){if(Reflect.hasOwnMetadata(Qm,r))throw new Error("Cannot apply @injectable decorator multiple times.");let e=Reflect.getMetadata(ug,r)||[];return Reflect.defineMetadata(Qm,e,r),r}}function xC(r){return e=>(t,n,i)=>{if(e===void 0){let s=typeof t=="function"?t.name:t.constructor.name;throw new Error(`@inject called with undefined this could mean that the class ${s} has a circular dependency problem. You can use a LazyServiceIdentifer to overcome this limitation.`)}UN(new Bi(r,e))(t,n,i)}}var je=xC(Lf);var wj=xC(Ff);function EC(r,e){return()=>(t,n)=>{let i=new Bi(r,n);if(Reflect.hasOwnMetadata(r,t.constructor))throw new Error(e);Reflect.defineMetadata(r,i,t.constructor)}}var Bf=EC(If,"Cannot apply @postConstruct decorator multiple times in the same class"),bj=EC(Oc,"Cannot apply @preDestroy decorator multiple times in the same class");var tn=de(require("vscode"));var dg=require("node:crypto");var CC="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var LN=128,Us,Ko;function FN(r){!Us||Us.length<r?(Us=Buffer.allocUnsafe(r*LN),dg.webcrypto.getRandomValues(Us),Ko=0):Ko+r>Us.length&&(dg.webcrypto.getRandomValues(Us),Ko=0),Ko+=r}function kC(r=21){FN(r|=0);let e="";for(let t=Ko-r;t<Ko;t++)e+=CC[Us[t]&63];return e}var TC=de(require("vscode")),Jo=TC.env.appRoot==="";function Ls(){let r=tn.workspace.workspaceFolders??[];if(r.length>0){let e=[];for(let t of r)t.uri.scheme!==qe.SCHEME&&e.push(t);e.length!==r.length&&tn.workspace.updateWorkspaceFolders(0,r.length,...e)}}async function RC(r,e){if(!(!tn.workspace.fs.isWritableFileSystem(e.scheme)||Jo))try{let n=kC(24),i=e.with({path:e.path+`/workspaces/${n}`}),s={folders:r.map(u=>({name:u.name,uri:u.uri.toString(!0)}))};await tn.workspace.fs.createDirectory(i);let o=i.with({path:i.path+"/Open Collaboration.code-workspace"}),l=new TextEncoder;return await tn.workspace.fs.writeFile(o,l.encode(JSON.stringify(s,void 0,2))),o}catch{return}}async function Pc(){let e=tn.window.tabGroups.all.flatMap(t=>t.tabs).filter(t=>typeof t.input=="object"&&t.input&&"uri"in t.input&&t.input.uri instanceof tn.Uri?t.input.uri.scheme===qe.SCHEME:!1);await tn.window.tabGroups.close(e)}var IC="0.3.1";var OC={resourceLabelFormatters:[{scheme:"oct",formatting:{label:"${path}",separator:"/",workspaceSuffix:"Open Collaboration Tools"}}],configuration:{title:"Open Collaboration Tools",properties:{"oct.serverUrl":{type:"string",default:"https://api.open-collab.tools/",description:"%oct.serverUrl%"},"oct.alwaysAskToOverrideServerUrl":{type:"boolean",default:!0,description:"%oct.alwaysAskToOverrideServerUrl%"}}},views:{explorer:[{id:"oct.roomView",name:"%oct.roomView%",when:"oct.connection"}]},menus:{commandPalette:[{command:"oct.followPeer",when:"oct.connection"},{command:"oct.stopFollowPeer",when:"oct.connection && oct.following"}],"view/item/context":[{command:"oct.followPeer",when:"viewItem == peer",group:"inline"},{command:"oct.stopFollowPeer",when:"viewItem == followedPeer",group:"inline"}]},commands:[{command:"oct.dev.fuzzing",title:"Run Fuzzing Test",category:"Open Collaboration Tools Developer",enablement:"oct.dev"},{command:"oct.followPeer",title:"%oct.followPeer%",category:"Open Collaboration Tools",icon:"$(eye)"},{command:"oct.stopFollowPeer",title:"%oct.stopFollowPeer%",category:"Open Collaboration Tools",icon:"$(eye-closed)"},{command:"oct.closeConnection",title:"%oct.closeConnection%",category:"Open Collaboration Tools",icon:"$(close)",enablement:"oct.connection"},{command:"oct.joinRoom",title:"%oct.joinRoom%",category:"Open Collaboration Tools",icon:"$(vm-connect)",enablement:"!oct.connection"},{command:"oct.createRoom",title:"%oct.createRoom%",category:"Open Collaboration Tools",icon:"$(vm-connect)",enablement:"workbenchState != empty && !oct.connection"},{command:"oct.signOut",title:"%oct.signOut%",category:"Open Collaboration Tools",icon:"$(sign-out)"}],colors:[{id:"oct.user.yellow",description:"%oct.user.color%",defaults:{dark:"#fcb900",light:"#fcb900"}},{id:"oct.user.green",description:"%oct.user.color%",defaults:{dark:"#107c10",light:"#107c10"}},{id:"oct.user.magenta",description:"%oct.user.color%",defaults:{dark:"#b4009e",light:"#b4009e"}},{id:"oct.user.lightGreen",description:"%oct.user.color%",defaults:{dark:"#bad80a",light:"#bad80a"}},{id:"oct.user.lightOrange",description:"%oct.user.color%",defaults:{dark:"#ff8c00",light:"#ff8c00"}},{id:"oct.user.lightMagenta",description:"%oct.user.color%",defaults:{dark:"#e3008c",light:"#e3008c"}}]};var DC=IC,hg=OC.colors.map(r=>r.id).filter(r=>r.startsWith("oct.user."));var Mf=class{peer;disposables=[];yjsAwareness;decoration;get clientId(){let e=this.yjsAwareness.getStates();for(let[t,n]of e.entries())if(n.peer===this.peer.id)return t}get lastUpdated(){let e=this.clientId;if(e!==void 0){let t=this.yjsAwareness.meta.get(e);if(t)return t.lastUpdated}}constructor(e,t){this.peer=t,this.yjsAwareness=e,this.decoration=this.createDecorationType(),this.disposables.push(this.decoration)}createDecorationType(){let e=BN(),t=`var(--vscode-${e.replaceAll(".","-")})`,n={backgroundColor:`color-mix(in srgb, ${t} 25%, transparent)`,borderRadius:"0.1em"},i={color:t,contentText:"\u16D9",margin:"0px 0px 0px -0.25ch",fontWeight:"bold",textDecoration:"none; position: absolute; display: inline-block; top: 0; font-size: 200%; font-weight: bold; z-index: 1;"},s=K.window.createTextEditorDecorationType({rangeBehavior:K.DecorationRangeBehavior.ClosedClosed,...n,before:i}),o=K.window.createTextEditorDecorationType({rangeBehavior:K.DecorationRangeBehavior.ClosedClosed,...n,after:i}),l=this.createNameTag(t,"top: -1rem;"),u=this.createNameTag(t,"bottom: -1rem;");return new mg(s,o,{default:l,inverted:u},e)}createNameTag(e,t){let n={contentText:this.peer.name,backgroundColor:e,textDecoration:`none; position: absolute; border-radius: 0.15rem; padding:0px 0.5ch; display: inline-block;
                                pointer-events: none; color: #000; font-size: 0.7rem; z-index: 10; font-weight: bold;${t??""}`};return K.window.createTextEditorDecorationType({backgroundColor:e,rangeBehavior:K.DecorationRangeBehavior.ClosedClosed,before:n})}dispose(){for(let e of this.disposables)e.dispose()}},PC=0;function BN(){return PC%=hg.length,hg[PC++]}var mg=class{constructor(e,t,n,i){this.before=e;this.after=t;this.nameTags=n;this.color=i;this.toDispose=K.Disposable.from(e,t,n.default,n.inverted)}toDispose;dispose(){this.toDispose.dispose()}getThemeColor(){return new K.ThemeColor(this.color)}},qf=Symbol("CollaborationInstanceFactory"),gg=Symbol("CollaborationInstanceOptions"),Ge=class{yjs=new Is;yjsAwareness=new vf(this.yjs);identity=new Vr;toDispose=new cs;yjsProvider;resyncing=new Set;documentDisposables=new Map;peers=new Map;throttles=new Map;yjsDocuments=new Map;_permissions={readonly:!1};get permissions(){return this._permissions}_following;get following(){return this._following}_ready=new Vr;get ready(){return Promise.all([this._ready.promise,this.identity.promise]).then(()=>{})}onDidUsersChangeEmitter=new K.EventEmitter;onDidUsersChange=this.onDidUsersChangeEmitter.event;onDidDisposeEmitter=new K.EventEmitter;onDidDispose=this.onDidDisposeEmitter.event;get connectedUsers(){return this.ownUserData.then(e=>{let t=Array.from(this.peers.values()).map(n=>({...n.peer,color:n.decoration.color}));return t.push(e),Array.from(t)})}get ownUserData(){return this.identity.promise}get host(){return this.options.host}get roomId(){return this.options.roomId}get connection(){return this.options.connection}get serverUrl(){return this.options.serverUrl}options;fileSystemManager;init(){this.options.host&&this._ready.resolve(),Ge.Current=this;let e=this.options.connection;this.yjsProvider=new Ef(e,this.yjs,this.yjsAwareness,{resyncTimer:1e4}),this.options.hostId&&(this.fileSystemManager=new Sf(e,this.yjs,this.options.hostId),this.toDispose.push(this.fileSystemManager)),this.yjsProvider.connect(),this.toDispose.push(e),this.toDispose.push(e.onDisconnect(()=>{this.dispose()})),this.toDispose.push(e.onConnectionError(t=>{K.window.showErrorMessage(K.l10n.t("Connection error: {0}",t))})),this.toDispose.push(e.onReconnect(()=>{this.yjsProvider.connect()})),this.toDispose.push(this.yjsProvider),this.toDispose.push({dispose:()=>{this.yjs.destroy(),this.yjsAwareness.destroy()}}),this.toDispose.push(this.onDidUsersChangeEmitter),this.toDispose.push(this.onDidDisposeEmitter),e.peer.onJoinRequest(async(t,n)=>{let i=K.l10n.t("User {0} via {1} login wants to join the collaboration session",n.email?`${n.name} (${n.email})`:n.name,n.authProvider??"unknown"),s=K.l10n.t("Allow"),o=K.l10n.t("Deny"),l=await K.window.showInformationMessage(i,s,o),u=K.workspace.workspaceFolders??[];return l===s?{workspace:{name:K.workspace.name??"Collaboration",folders:u.map(d=>d.name)}}:void 0}),e.peer.onInit(async(t,n)=>{await this.initialize(n)}),e.room.onJoin(async(t,n)=>{if(this.host){let i=K.workspace.workspaceFolders??[],s={protocol:jr,host:await this.identity.promise,guests:Array.from(this.peers.values()).map(o=>o.peer),capabilities:{},permissions:this._permissions,workspace:{name:K.workspace.name??"Collaboration",folders:i.map(o=>o.name)}};e.peer.init(n.id,s)}this.peers.set(n.id,new Mf(this.yjsAwareness,n)),this.onDidUsersChangeEmitter.fire()}),e.room.onLeave(async(t,n)=>{let i=this.peers.get(n.id);i&&(i.dispose(),this.peers.delete(n.id),this.onDidUsersChangeEmitter.fire()),this.rerenderPresence()}),e.room.onClose(async()=>{this.options.host||(K.window.showInformationMessage(K.l10n.t("Collaboration session closed")),Ls(),this.dispose())}),e.room.onPermissions((t,n)=>{this._permissions=n,this.fileSystemManager?.registerFileSystemProvider(n.readonly)}),e.peer.onInfo((t,n)=>{this.yjsAwareness.setLocalStateField("peer",n.id),this.identity.resolve(n),this.onDidUsersChangeEmitter.fire()}),this.registerFileEvents(),this.registerEditorEvents()}registerFileEvents(){let e=this.connection;e.fs.onStat(async(t,n)=>{let i=qe.getResourceUri(n);if(i){let s=await K.workspace.fs.stat(i);return{type:s.type===K.FileType.Directory?Xa.Directory:Xa.File,mtime:s.mtime,ctime:s.ctime,size:s.size}}else throw new Error("Could not stat file")}),e.fs.onReaddir(async(t,n)=>{let i=qe.getResourceUri(n);if(i)return(await K.workspace.fs.readDirectory(i)).reduce((o,[l,u])=>(o[l]=u,o),{});throw new Error("Could not read directory")}),e.fs.onReadFile(async(t,n)=>{let i=qe.getResourceUri(n);if(i)return{content:await K.workspace.fs.readFile(i)};throw new Error("Could not read file")}),e.fs.onDelete(async(t,n)=>{let i=qe.getResourceUri(n);if(i)await K.workspace.fs.delete(i,{recursive:!0});else throw new Error("Could not delete file")}),e.fs.onRename(async(t,n,i)=>{let s=qe.getResourceUri(n),o=qe.getResourceUri(i);if(s&&o)await K.workspace.fs.rename(s,o,{overwrite:!0});else throw new Error("Could not rename file")}),e.fs.onMkdir(async(t,n)=>{let i=qe.getResourceUri(n);if(i)await K.workspace.fs.createDirectory(i);else throw new Error("Could not create directory")}),e.fs.onChange(async(t,n)=>{if(this.fileSystemManager){let i=[];for(let s of n.changes){let o=qe.getResourceUri(s.path);o&&i.push({type:this.convertChangeType(s.type),uri:o})}this.fileSystemManager.triggerChangeEvent(i)}}),e.fs.onWriteFile(async(t,n,i)=>{let s=qe.getResourceUri(n);if(s){let o=this.findDocument(s);if(o){let l=new TextDecoder().decode(i.content);l!==o.getText()&&await this.applyEdit([],()=>{let u=this.findDocument(s);u&&this.createFullDocumentEdit(u,l)}),await o.save()}else await K.workspace.fs.writeFile(s,i.content)}})}convertChangeType(e){switch(e){case Gn.Create:return K.FileChangeType.Created;case Gn.Delete:return K.FileChangeType.Deleted;case Gn.Update:return K.FileChangeType.Changed}}setPermissions(e){this._permissions=e,this.connection.room.updatePermissions(this._permissions)}async leave(){try{await this.connection.room.leave(),await new Promise(e=>setTimeout(e,100))}catch{}}dispose(){Ge.Current=void 0,this.peers.forEach(e=>e.dispose()),this.peers.clear(),this.documentDisposables.forEach(e=>e.dispose()),this.documentDisposables.clear(),this.yjsDocuments.forEach(e=>e.dispose()),this.yjsDocuments.clear(),this.throttles.clear(),this.onDidDisposeEmitter.fire(),this.toDispose.dispose()}pushDocumentDisposable(e,t){let n=this.documentDisposables.get(e);n||(n=new cs,this.documentDisposables.set(e,n)),n.push(t)}registerEditorEvents(){this.connection.editor.onOpen(async(t,n)=>{let i=qe.getResourceUri(n);if(i)await K.workspace.openTextDocument(i);else throw new Error("Could not open file")}),K.workspace.textDocuments.forEach(t=>{this.isNotebookCell(t)||this.registerTextDocument(t)}),this.toDispose.push(K.workspace.onDidOpenTextDocument(t=>{this.isNotebookCell(t)||this.registerTextDocument(t)})),this.toDispose.push(K.workspace.onDidChangeTextDocument(t=>{this.isNotebookCell(t.document)||this.updateTextDocument(t)})),this.toDispose.push(K.window.onDidChangeVisibleTextEditors(()=>{this.updateTextSelection(K.window.activeTextEditor),this.rerenderPresence()})),this.toDispose.push(K.workspace.onDidCloseTextDocument(t=>{let n=t.uri.toString();this.documentDisposables.get(n)?.dispose(),this.documentDisposables.delete(n),this.yjsDocuments.get(n)?.dispose(),this.yjsDocuments.delete(n);let i=qe.getProtocolPath(t.uri);i&&this.throttles.delete(i)})),this.toDispose.push(K.window.onDidChangeTextEditorSelection(t=>{this.updateTextSelection(t.textEditor)})),this.toDispose.push(K.window.onDidChangeTextEditorVisibleRanges(t=>{this.updateTextSelection(t.textEditor)})),this.host&&this.createFileWatcher();let e=(0,pg.default)(()=>{this.rerenderPresence()},2e3);this.yjsAwareness.on("change",async(t,n)=>{n!==uE&&(this.updateFollow(),this.rerenderPresence(),e())})}createFileWatcher(){let e=[],t=(0,UC.default)(()=>{let s=e.splice(0,e.length);this.connection.fs.change({changes:s})},100,{leading:!1,trailing:!0}),n=(s,o)=>{let l=qe.getProtocolPath(s);l&&(e.push({path:l,type:o}),t())},i=K.workspace.createFileSystemWatcher("**/*");i.onDidChange(s=>n(s,Gn.Update)),i.onDidCreate(s=>n(s,Gn.Create)),i.onDidDelete(s=>n(s,Gn.Delete)),this.toDispose.push(i)}isNotebookCell(e){return e.uri.scheme==="vscode-notebook-cell"}followUser(e){this._following=e,this.updateFollow()}updateFollow(){if(this._following){let e,t=this.yjsAwareness.getStates();for(let n of t.values())this.peers.get(n.peer)?.peer.id===this._following&&(e=n);e&&Za.is(e.selection)&&this.followSelection(e.selection)}}async followSelection(e){let t=qe.getResourceUri(e.path);if(t&&e.visibleRanges&&e.visibleRanges.length>0){let n=K.window.visibleTextEditors.find(o=>o.document.uri.toString()===t.toString());if(!n){let o=await K.workspace.openTextDocument(t);n=await K.window.showTextDocument(o)}let i=e.visibleRanges[0],s=new K.Range(i.start.line,i.start.character,i.end.line,i.end.character);n.revealRange(s)}}updateTextSelection(e){if(!e){this.setSharedSelection(void 0);return}let t=e.document.uri,n=qe.getProtocolPath(t);if(n){let i=this.yjs.getText(n),s=this.getNormalizedDocument(e.document,n),o=[];for(let u of e.selections){let d=s.normalizedOffsetAt(u.start),f=s.normalizedOffsetAt(u.end),h=u.isReversed?Ri.RightToLeft:Ri.LeftToRight,m={start:Ec(i,d),end:Ec(i,f),direction:h};o.push(m)}let l={path:n,textSelections:o,visibleRanges:e.visibleRanges.map(u=>({start:{line:u.start.line,character:u.start.character},end:{line:u.end.line,character:u.end.character}}))};this.setSharedSelection(l)}else this.setSharedSelection(void 0)}registerTextDocument(e){let t=e.uri,n=qe.getProtocolPath(t);if(n){let i=e.getText(),s=this.getNormalizedDocument(e,n);this.host?s.update({changes:i}):this.options.connection.editor.open(this.options.hostId,n),this.pushDocumentDisposable(n,s)}}updateTextDocument(e){if(e.contentChanges.length===0)return;let t=e.document.uri,n=qe.getProtocolPath(t);if(n){if(this.resyncing.has(n))return;let i=this.getNormalizedDocument(e.document,n),s=[];for(let o of e.contentChanges){let l=o.rangeOffset,u=o.rangeOffset+o.rangeLength;s.push({start:l,end:u,text:o.text})}i.update({changes:s}),this.getOrCreateThrottle(n)()}}getOrCreateThrottle(e){let t=this.throttles.get(e);if(t)return t;let n=qe.getResourceUri(e);return n?(t=(0,pg.default)(async()=>{let i=this.findDocument(n);if(i){let s=this.yjs.getText(e),o=this.adjustEol(s.toString(),i.eol);o!==i.getText()&&(this.resyncing.add(e),await this.applyEdit([],()=>{let l=this.findDocument(n);return l?this.createFullDocumentEdit(l,o):void 0}),this.resyncing.delete(e))}},100,{leading:!1,trailing:!0,maxWait:500}),this.throttles.set(e,t)):(console.warn("Could not determine URI for path",e),t=()=>{}),t}async applyEdit(e,t){let n=!1,i=0,s=20;for(;!n&&i++<s;)try{let o=t(e);if(!o)return!0;n=await K.workspace.applyEdit(o)}catch{return!1}return n}findDocument(e){return K.workspace.textDocuments.find(t=>t.uri.toString()===e.toString())}createFullDocumentEdit(e,t){let n=new K.WorkspaceEdit,i=new K.Position(0,0),s=e.lineAt(e.lineCount-1).range.end;return n.replace(e.uri,new K.Range(i,s),t),n}rerenderPresence(){let e=this.yjsAwareness.getStates();for(let[t,n]of e.entries()){if(t===this.yjs.clientID)continue;let i=n.peer,s=this.peers.get(i);!n.selection||!s||Za.is(n.selection)&&this.renderTextPresence(s,n.selection)}}renderTextPresence(e,t){let n=e.lastUpdated!==void 0&&Date.now()-e.lastUpdated<1900,{path:i,textSelections:s}=t,o=qe.getResourceUri(i),l=new Set(K.window.visibleTextEditors);if(o){let u=K.window.visibleTextEditors.filter(d=>d.document.uri.toString()===o.toString());if(u.length>0){let d=u[0].document,f=this.getNormalizedDocument(d,i),h=[],m=[],g=[],y=[];for(let b of s){let C=b.direction===1,L=Cc(b.start,this.yjs),j=Cc(b.end,this.yjs);if(L&&j){let O=f.positionAtNormalized(L.index),D=new K.Position(O.line,O.character),N=f.positionAtNormalized(j.index),k=new K.Position(N.line,N.character),P=C&&k.line===0||!C&&D.line===0,R=new K.Range(D,k);if(C){if(h.push(R),n){let M=new K.Range(k,k);(P?y:g).push(M)}}else if(m.push(R),n){let M=new K.Range(D,D);(P?y:g).push(M)}}}for(let b of u)l.delete(b),b.setDecorations(e.decoration.before,m),b.setDecorations(e.decoration.after,h),b.setDecorations(e.decoration.nameTags.default,g),b.setDecorations(e.decoration.nameTags.inverted,y)}}for(let u of l)u.setDecorations(e.decoration.before,[]),u.setDecorations(e.decoration.after,[]),u.setDecorations(e.decoration.nameTags.default,[]),u.setDecorations(e.decoration.nameTags.inverted,[])}getNormalizedDocument(e,t){let n=e.uri,i=n.toString(),s=this.yjsDocuments.get(i);return s||(s=new kf(this.yjs.getText(t),async o=>{let l=this.findDocument(n);l&&(await this.applyEdit(o,u=>{let d=new K.WorkspaceEdit;for(let f of u){let h=l.positionAt(f.start),m=l.positionAt(f.end);d.replace(n,new K.Range(h,m),f.text)}return d}),this.getOrCreateThrottle(t)())}),this.yjsDocuments.set(i,s)),s}setSharedSelection(e){this.yjsAwareness.setLocalStateField("selection",e)}createSelectionFromRelative(e,t){let n=Cc(e.start,this.yjs),i=Cc(e.end,this.yjs);if(n&&i){let s=t.positionAt(n.index),o=t.positionAt(i.index);return e.direction===Ri.RightToLeft&&([s,o]=[o,s]),new K.Selection(s,o)}}createRelativeSelection(e,t,n){let i=Ec(n,t.offsetAt(e.start)),s=Ec(n,t.offsetAt(e.end));return{start:i,end:s,direction:e.isReversed?Ri.RightToLeft:Ri.LeftToRight}}async initialize(e){if(!this.fileSystemManager)throw new Error("File system manager not initialized");for(let t of[e.host,...e.guests])this.peers.set(t.id,new Mf(this.yjsAwareness,t));this._permissions=e.permissions,this.fileSystemManager.registerFileSystemProvider(e.permissions.readonly),this.onDidUsersChangeEmitter.fire(),this._ready.resolve()}adjustEol(e,t){let n=t===K.EndOfLine.LF?`
`:`\r
`;return e.replace(/\r?\n/g,n)}};Ry(Ge,"Current"),ke([je(gg)],Ge.prototype,"options",2),ke([Bf()],Ge.prototype,"init",1),Ge=ke([St()],Ge);var we=de(require("vscode"));var Qe=de(require("vscode"));var ii=Symbol("ExtensionContext");function LC(r){let e=new Uf({autoBindInjectable:!0,defaultScope:"Singleton"});return e.bind(ii).toConstantValue(r),e.bind(qf).toFactory(t=>n=>{if(Ge.Current)throw new Error("Only one collaboration instance can be active at a time");let i=t.container.createChild();return i.bind(Ge).toSelf(),i.bind(gg).toConstantValue(n),i.get(Ge)}),e}var jf="oct.userTokens",$f="oct.roomToken",rn=class{context;async deleteAll(){await Promise.all([this.context.secrets.delete(jf),this.context.secrets.delete($f)])}async storeUserToken(e,t){let n=await this.retrieveUserTokens();n[e]=t,await this.storeUserTokens(n)}async storeUserTokens(e){await this.storeJsonToken(jf,e)}async deleteUserTokens(){await this.context.secrets.delete(jf)}async retrieveUserToken(e){return(await this.retrieveUserTokens())[e]}async retrieveUserTokens(){return await this.retrieveJsonToken(jf)??{}}async consumeRoomData(){let e=await this.retrieveRoomData();return await this.storeRoomData(void 0),e}async storeRoomData(e){e===void 0?await this.context.secrets.delete($f):await this.storeJsonToken($f,e)}async retrieveRoomData(){return this.retrieveJsonToken($f)}async storeJsonToken(e,t){await this.context.secrets.store(e,JSON.stringify(t))}async retrieveJsonToken(e){let t=await this.context.secrets.get(e);if(t)try{return JSON.parse(t)}catch{await this.context.secrets.delete(e);return}}};ke([je(ii)],rn.prototype,"context",2),rn=ke([St()],rn);var rt=require("vscode");function mr(r){switch(r.code){case Fe.Codes.AuthInternalError:return rt.l10n.t("Internal authentication server error");case Fe.Codes.AuthTimeout:return rt.l10n.t("Authentication timed out");case Fe.Codes.AwaitingServerResponse:return rt.l10n.t("Awaiting server response");case Fe.Codes.IncompatibleProtocolVersions:return rt.l10n.t("Incompatible protocol versions: client {0}, server {1}",...r.params);case Fe.Codes.InvalidServerVersion:return rt.l10n.t("Invalid protocol version returned by server: {0}",...r.params);case Fe.Codes.JoinRejected:return rt.l10n.t("Join request has been rejected");case Fe.Codes.JoinRequestNotFound:return rt.l10n.t("Join request not found");case Fe.Codes.JoinTimeout:return rt.l10n.t("Join request timed out");case Fe.Codes.PerformingLogin:return rt.l10n.t("Performing login");case Fe.Codes.RoomNotFound:return rt.l10n.t("Session not found");case Fe.Codes.WaitingForHost:return rt.l10n.t("Waiting for host to accept join request");case Fe.Codes.UnverifiedLoginLabel:return rt.l10n.t("Unverified");case Fe.Codes.UnverifiedLoginDetails:return rt.l10n.t("Login with a user name and an optional email address");case Fe.Codes.GitHubLabel:return rt.l10n.t("GitHub");case Fe.Codes.GoogleLabel:return rt.l10n.t("Google");case Fe.Codes.BuiltinsGroup:return rt.l10n.t("Built-in");case Fe.Codes.ThirdParty:return rt.l10n.t("Third-party");case Fe.Codes.EmailLabel:return rt.l10n.t("Email");case Fe.Codes.EmailPlaceholder:return rt.l10n.t("Your email that will be shown to the host when joining the session");case Fe.Codes.UsernameLabel:return rt.l10n.t("Username");case Fe.Codes.UsernamePlaceholder:return rt.l10n.t("Your user name that will be shown to all session participants")}return r.message}var yg=Symbol("Fetch"),Mi=class{secretStorage;fetch;async createConnection(e){let t=await this.secretStorage.retrieveUserToken(e);return new Nu({url:e,client:`OCT_CODE_${Qe.env.appName.replace(/[\s\-_]+/g,"_")}@${DC}`,authenticationHandler:async(n,i)=>{if(!!!i.providers.length&&i.loginPageUrl)return i.loginPageUrl?await Qe.env.openExternal(Qe.Uri.parse(i.loginPageUrl)):(Qe.window.showErrorMessage(Qe.l10n.t("No authentication method provided by the server.")),!1);let o=this.enhanceQuickPickGroups(i.providers.map(u=>({label:mr(u.label),description:u.details&&mr(u.details),provider:u}))),l=await Qe.window.showQuickPick(o,{title:Qe.l10n.t("Select Authentication Method")});if(l)switch(l.provider.type){case"form":return this.handleFormAuth(n,l.provider,e);case"web":return this.handleWebAuth(n,l.provider,e)}return!1},transports:[bS],userToken:t,fetch:this.fetch})}enhanceQuickPickGroups(e){let t=new Map;for(let i of e){let s=mr(i.provider.group);t.has(s)||t.set(s,[]),t.get(s).push(i)}let n=[];for(let[i,s]of t)n.push({label:i,kind:Qe.QuickPickItemKind.Separator,provider:void 0}),n.push(...s);return n}async handleFormAuth(e,t,n){let i=t.fields,s={token:e};for(let u of i){let d;u.placeHolder?d=mr(u.placeHolder):d=mr(u.label),d+=u.required?"":` (${Qe.l10n.t("optional")})`;let f=await Qe.window.showInputBox({prompt:mr(u.label),placeHolder:d});if(f)s[u.name]=f;else if(u.required)return Qe.window.showErrorMessage(Qe.l10n.t("The {0} field is required. Login aborted.",mr(u.label))),!1}let o=Qe.Uri.parse(n).with({path:t.endpoint}),l=await this.fetch(o.toString(),{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}});return l.ok?Qe.window.showInformationMessage(Qe.l10n.t("Login successful.")):Qe.window.showErrorMessage(Qe.l10n.t("Login failed.")),l.ok}async handleWebAuth(e,t,n){let i=Qe.Uri.parse(n).with({path:t.endpoint,query:`token=${e}`});return await Qe.env.openExternal(i)}};ke([je(rn)],Mi.prototype,"secretStorage",2),ke([je(yg)],Mi.prototype,"fetch",2),Mi=ke([St()],Mi);var qi=de(require("vscode"));var ji;(o=>{o.SERVER_URL="oct.serverUrl",o.ALWAYS_ASK_TO_OVERRIDE_SERVER_URL="oct.alwaysAskToOverrideServerUrl";function t(){let l=qi.workspace.getConfiguration().get(o.SERVER_URL);if(typeof l=="string")return Zn.normalizeServerUri(l)}o.getServerUrl=t;async function n(l){await qi.workspace.getConfiguration().update(o.SERVER_URL,l,qi.ConfigurationTarget.Global)}o.setServerUrl=n;function i(){let l=qi.workspace.getConfiguration().get(o.ALWAYS_ASK_TO_OVERRIDE_SERVER_URL);return typeof l=="boolean"?l:!1}o.getServerUrlOverride=i;async function s(l){await qi.workspace.getConfiguration().update(o.ALWAYS_ASK_TO_OVERRIDE_SERVER_URL,l,qi.ConfigurationTarget.Global)}o.setServerUrlOverride=s})(ji||={});var gr;(u=>(u.FollowPeer="oct.followPeer",u.StopFollowPeer="oct.stopFollowPeer",u.Enter="oct.enter",u.JoinRoom="oct.joinRoom",u.CreateRoom="oct.createRoom",u.CloseConnection="oct.closeConnection",u.SignOut="oct.signOut",u.DevFuzzing="oct.dev.fuzzing"))(gr||={});var Qo;(n=>(n.CloseFolder="workbench.action.closeFolder",n.OpenSettings="workbench.action.openSettings",n.OpenFolder="vscode.openFolder"))(Qo||={});var Xt=class{connectionProvider;instanceFactory;context;secretStore;onDidJoinRoomEmitter=new we.EventEmitter;onDidJoinRoom=this.onDidJoinRoomEmitter.event;tokenSource=new we.CancellationTokenSource;async tryConnect(){let e=await this.secretStore.consumeRoomData();if(e){let n=await(await this.connectionProvider.createConnection(e.serverUrl)).connect(e.roomToken,e.host),i=this.instanceFactory({connection:n,serverUrl:e.serverUrl,host:!1,roomId:e.roomId,hostId:e.host.id});return this.onDidJoinRoomEmitter.fire(i),i}}async createRoom(){this.withConnectionProvider(void 0,async(e,t)=>{this.tokenSource.cancel(),this.tokenSource=new we.CancellationTokenSource,await we.window.withProgress({location:we.ProgressLocation.Notification,title:we.l10n.t("Creating Session"),cancellable:!0},async(n,i)=>{let s=this.tokenSource.token;try{let o=await e.createRoom({abortSignal:this.toAbortSignal(this.tokenSource.token,i),reporter:m=>n.report({message:mr(m)})});if(o.loginToken){let m=o.loginToken;await this.secretStore.storeUserToken(t,m)}let l=await e.connect(o.roomToken),u=this.instanceFactory({serverUrl:t,connection:l,host:!0,roomId:o.roomId});await we.env.clipboard.writeText(o.roomId);let d=we.l10n.t("Copy to Clipboard"),f=we.l10n.t("Copy with Server URL"),h=we.l10n.t("Created session {0}. Invitation code was automatically written to clipboard.",o.roomId);we.window.showInformationMessage(h,d,f).then(m=>{m===d?we.env.clipboard.writeText(o.roomId):m===f&&we.env.clipboard.writeText(Zn.create({roomId:o.roomId,serverUrl:t}))}),this.onDidJoinRoomEmitter.fire(u)}catch(o){this.showError(!0,o,s,i)}})})}async joinRoom(e){if(!e&&(e=await we.window.showInputBox({placeHolder:we.l10n.t("Enter the invitation code")}),!e))return;let t;try{let n=Zn.parse(e);e=n.roomId,n.serverUrl&&(t=n.serverUrl,this.askToOverrideServerUrl(t))}catch{we.window.showErrorMessage(we.l10n.t("Invalid invitation code! Invitation codes must be either a string of alphanumeric characters or a URL with a fragment."));return}await this.withConnectionProvider(t,async(n,i)=>{this.tokenSource.cancel(),this.tokenSource=new we.CancellationTokenSource,await we.window.withProgress({location:we.ProgressLocation.Notification,title:we.l10n.t("Joining Session"),cancellable:!0},async(o,l)=>{if(e){let u=this.tokenSource.token;try{let d=await n.joinRoom({roomId:e,reporter:b=>o.report({message:mr(b)}),abortSignal:this.toAbortSignal(u,l)});if(d.loginToken){let b=d.loginToken;await this.secretStore.storeUserToken(i,b)}let f={serverUrl:i,roomToken:d.roomToken,roomId:d.roomId,host:d.host};await this.secretStore.storeRoomData(f);let h=we.workspace.workspaceFolders??[],m=d.workspace,g=m.folders.map(b=>({name:b,uri:qe.create(m.name,b)})),y=await RC(g,this.context.globalStorageUri);return y?(await we.commands.executeCommand(Qo.OpenFolder,y,{forceNewWindow:!1,forceReuseWindow:!0,noRecentEntry:!0}),!0):we.workspace.updateWorkspaceFolders(0,h.length,...g)}catch(d){this.showError(!1,d,u,l)}}return!1})&&Jo&&setTimeout(()=>{this.tryConnect()},500)})}showError(e,t,n,i){n.isCancellationRequested||(i.isCancellationRequested?we.window.showInformationMessage(we.l10n.t("Action was cancelled by the user")):e?we.window.showErrorMessage(we.l10n.t("Failed to create session: {0}",Ip(t,mr))):we.window.showErrorMessage(we.l10n.t("Failed to join session: {0}",Ip(t,mr))))}toAbortSignal(...e){let t=new AbortController;return e.forEach(n=>n.onCancellationRequested(()=>t.abort())),t.signal}async withConnectionProvider(e,t){if(e?e=Zn.normalizeServerUri(e):e=ji.getServerUrl(),e){let n=await this.connectionProvider.createConnection(e);await t(n,e)}else this.showServerUrlMissingError()}showServerUrlMissingError(){let e=we.l10n.t("No Open Collaboration Server configured. Please set the server URL in the settings."),t=we.l10n.t("Open Settings");we.window.showInformationMessage(e,t).then(n=>{n===t&&we.commands.executeCommand(Qo.OpenSettings,ji.SERVER_URL)})}async askToOverrideServerUrl(e){if(ji.getServerUrl()===e||!ji.getServerUrlOverride())return;let n=we.l10n.t("Do you want to override the server URL setting with {0}?",e),i=we.l10n.t("Yes"),s=we.l10n.t("No"),o=we.l10n.t("Never"),l=await we.window.showInformationMessage(n,i,s,o);l===i?ji.setServerUrl(e):l===o&&ji.setServerUrlOverride(!1)}};ke([je(Mi)],Xt.prototype,"connectionProvider",2),ke([je(qf)],Xt.prototype,"instanceFactory",2),ke([je(ii)],Xt.prototype,"context",2),ke([je(rn)],Xt.prototype,"secretStore",2),Xt=ke([St()],Xt);var _e=de(require("vscode"));var FC=de(require("vscode"));function Xo(r,e){if(Array.isArray(r)){let n=r;r=FC.window.createQuickPick(),r.items=n,e&&(r.placeholder=e.placeholder,r.buttons=e.buttons??[],e.onDidTriggerButton&&r.onDidTriggerButton(e.onDidTriggerButton),e.onDidTriggerItemButton&&r.onDidTriggerItemButton(e.onDidTriggerItemButton),r.matchOnDescription=e.matchOnDescription??!1,r.matchOnDetail=e.matchOnDetail??!1,r.keepScrollPosition=e.keepScrollPosition??!1)}let t=r;return new Promise(n=>{t.show(),t.onDidAccept(()=>{n(t.activeItems[0].key),t.hide()}),t.onDidHide(()=>{n(void 0)})})}var nn=de(require("vscode"));var $i=class{onDidChangeTreeDataEmitter=new nn.EventEmitter;onDidChangeTreeData=this.onDidChangeTreeDataEmitter.event;instance;onConnection(e){this.instance=e,e.onDidUsersChange(()=>{this.onDidChangeTreeDataEmitter.fire()}),e.onDidDispose(()=>{this.instance=void 0,this.onDidChangeTreeDataEmitter.fire()}),this.onDidChangeTreeDataEmitter.fire()}async getTreeItem(e){let t=await this.instance?.ownUserData,n=new nn.TreeItem(e.name),i=[];if(e.id===t?.id&&i.push(nn.l10n.t("You")),e.host&&i.push(nn.l10n.t("Host")),n.description=i.length?"("+i.join(" \u2022 ")+")":void 0,n.contextValue="self",t?.id!==e.id){let s=e.color?new nn.ThemeColor(e.color):void 0;n.iconPath=new nn.ThemeIcon("circle-filled",s),n.contextValue=this.instance?.following===e.id?"followedPeer":"peer"}return n}getChildren(e){return!e&&this.instance?this.instance.connectedUsers:[]}update(){this.onDidChangeTreeDataEmitter.fire()}};$i=ke([St()],$i);var NC=de(require("vscode"));var kn=class{set(e,t){NC.commands.executeCommand("setContext",e,t)}setConnection(e){this.set("oct.connection",!!e),this.set("oct.roomId",e?.roomId)}setFollowing(e){this.set("oct.following",e)}};kn=ke([St()],kn);var Vi=class{viewDataProvider;contextKeyService;async followPeer(e){if(Ge.Current){if(!e){let n=(await Ge.Current.connectedUsers).map(i=>({label:i.name,detail:i.id,key:i.id}));e=await Xo(n)}e&&(Ge.Current.followUser(e),this.viewDataProvider.update(),this.contextKeyService.setFollowing(!0))}}async unfollowPeer(){Ge.Current&&(Ge.Current.followUser(void 0),this.viewDataProvider.update(),this.contextKeyService.setFollowing(!1))}};ke([je($i)],Vi.prototype,"viewDataProvider",2),ke([je(kn)],Vi.prototype,"contextKeyService",2),Vi=ke([St()],Vi);var si=de(require("vscode"));var sn=class{context;roomService;viewDataProvider;contextKeyService;statusBarItem=si.window.createStatusBarItem(si.StatusBarAlignment.Left,5);init(){this.roomService.onDidJoinRoom(e=>{this.setState(e.host?1:2),this.viewDataProvider.onConnection(e),this.contextKeyService.setConnection(e),e.onDidDispose(()=>{this.setState(0),this.contextKeyService.setConnection(void 0),e.host||(Pc(),Ls())})}),this.context.subscriptions.push(si.window.registerTreeDataProvider("oct.roomView",this.viewDataProvider),this.statusBarItem)}initialize(e){if(this.setState(0),this.statusBarItem.command=e,this.statusBarItem.tooltip=si.l10n.t("Start a collaboration session"),this.statusBarItem.show(),Jo){let t=setInterval(()=>this.statusBarItem.show(),200);setTimeout(()=>clearInterval(t),3e4)}}setState(e){switch(e){case 0:this.statusBarItem.text="$(git-compare) Open Collaboration";break;case 1:this.statusBarItem.text="$(broadcast) "+si.l10n.t("Sharing");break;case 2:this.statusBarItem.text="$(broadcast) "+si.l10n.t("Collaborating");break}}};ke([je(ii)],sn.prototype,"context",2),ke([je(Xt)],sn.prototype,"roomService",2),ke([je($i)],sn.prototype,"viewDataProvider",2),ke([je(kn)],sn.prototype,"contextKeyService",2),ke([Bf()],sn.prototype,"init",1),sn=ke([St()],sn);var Pr=class{context;followService;contextKeyService;roomService;statusService;secretStorage;initialize(){this.context.subscriptions.push(_e.commands.registerCommand(gr.FollowPeer,e=>this.followService.followPeer(e?.id)),_e.commands.registerCommand(gr.StopFollowPeer,()=>this.followService.unfollowPeer()),_e.commands.registerCommand(gr.Enter,async()=>{await this.openMainQuickpick()}),_e.commands.registerCommand(gr.JoinRoom,async()=>{await this.roomService.joinRoom()}),_e.commands.registerCommand(gr.CreateRoom,async()=>{await this.roomService.createRoom()}),_e.commands.registerCommand(gr.CloseConnection,async()=>{let e=Ge.Current;e&&(await e.leave(),e.dispose(),this.contextKeyService.setConnection(void 0),e.host||await _e.commands.executeCommand(Qo.CloseFolder))}),_e.commands.registerCommand(gr.SignOut,async()=>{await _e.commands.executeCommand(gr.CloseConnection),await this.secretStorage.deleteUserTokens(),_e.window.showInformationMessage(_e.l10n.t("Signed out successfully!"))})),typeof process=="object"&&process&&process.env?.DEVELOPMENT==="true"&&(this.contextKeyService.set("oct.dev",!0),this.context.subscriptions.push(_e.commands.registerCommand(gr.DevFuzzing,async()=>{let e=_e.window.activeTextEditor,t=String.fromCharCode(Math.floor(Math.random()*26)+97);if(e){let n=setInterval(()=>{if(_e.window.activeTextEditor!==e){clearInterval(n);return}e.edit(i=>{i.insert(e.selection.start,t)})},50)}}))),this.statusService.initialize(gr.Enter)}async openMainQuickpick(){let e=Ge.Current;e?await this.openMainQuickpickInSession(e):await this.openMainQuickpickOutsideSession()}async openMainQuickpickOutsideSession(){let e=[{key:"join",label:"$(vm-connect) "+_e.l10n.t("Join Collaboration Session"),detail:_e.l10n.t("Join an open collaboration session using an invitation code")}];_e.workspace.workspaceFolders?.length&&e.unshift({key:"create",label:"$(add) "+_e.l10n.t("Create New Collaboration Session"),detail:_e.l10n.t("Become the host of a new collaboration session in your current workspace")});let t=await Xo(e,{placeholder:_e.l10n.t("Select Collaboration Option")});t==="create"?await this.roomService.createRoom():t==="join"&&await this.roomService.joinRoom()}async openMainQuickpickInSession(e){let t=[{key:"invite",label:"$(clippy) "+_e.l10n.t("Invite Others (Copy Code)"),detail:_e.l10n.t("Copy the invitation code to the clipboard to share with others")}];e.host?(t.push({key:"update",label:"$(gear) "+_e.l10n.t("Configure Collaboration Session"),detail:_e.l10n.t("Configure the options and permissions of the current session")}),t.push({key:"stop",label:"$(circle-slash) "+_e.l10n.t("Stop Collaboration Session"),detail:_e.l10n.t("Stop the collaboration session, stop sharing all content and remove all participants")})):t.push({key:"stop",label:"$(circle-slash) "+_e.l10n.t("Leave Collaboration Session"),detail:_e.l10n.t("Leave the collaboration session, closing the current workspace")});let n=await Xo(t,{placeholder:_e.l10n.t("Select Collaboration Option")});n==="invite"?await this.inviteCallback(e):n==="update"?await this.updatePermissions(e):n==="stop"&&await _e.commands.executeCommand(gr.CloseConnection)}async inviteCallback(e){_e.env.clipboard.writeText(e.roomId);let t=_e.l10n.t("Copy with Server URL");_e.window.showInformationMessage(_e.l10n.t("Invitation code {0} copied to clipboard!",e.roomId),t).then(n=>{n===t&&_e.env.clipboard.writeText(Zn.create({roomId:e.roomId,serverUrl:e.serverUrl}))})}async updatePermissions(e){let t=[];e.permissions.readonly?t.push({key:"readwrite",label:"$(unlock) "+_e.l10n.t("Enable Editing"),detail:_e.l10n.t("Allow all participants to edit files in the workspace")}):t.push({key:"readonly",label:"$(lock) "+_e.l10n.t("Make Read-Only"),detail:_e.l10n.t("Prevent all participants from editing the workspace")});let n=await Xo(t,{placeholder:_e.l10n.t("Select Permissions")});n==="readonly"?e.setPermissions({readonly:!0}):n==="readwrite"&&e.setPermissions({readonly:!1})}};ke([je(ii)],Pr.prototype,"context",2),ke([je(Vi)],Pr.prototype,"followService",2),ke([je(kn)],Pr.prototype,"contextKeyService",2),ke([je(Xt)],Pr.prototype,"roomService",2),ke([je(sn)],Pr.prototype,"statusService",2),ke([je(rn)],Pr.prototype,"secretStorage",2),Pr=ke([St()],Pr);var mk=de(require("node:http"),1),gk=de(require("node:https"),1),qs=de(require("node:zlib"),1),br=de(require("node:stream"),1),qc=require("node:buffer");function MN(r){if(!/^data:/i.test(r))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');r=r.replace(/\r?\n/g,"");let e=r.indexOf(",");if(e===-1||e<=4)throw new TypeError("malformed data: URI");let t=r.substring(5,e).split(";"),n="",i=!1,s=t[0]||"text/plain",o=s;for(let f=1;f<t.length;f++)t[f]==="base64"?i=!0:t[f]&&(o+=`;${t[f]}`,t[f].indexOf("charset=")===0&&(n=t[f].substring(8)));!t[0]&&!n.length&&(o+=";charset=US-ASCII",n="US-ASCII");let l=i?"base64":"ascii",u=unescape(r.substring(e+1)),d=Buffer.from(u,l);return d.type=s,d.typeFull=o,d.charset=n,d}var BC=MN;var Ur=de(require("node:stream"),1),ci=require("node:util"),yr=require("node:buffer");Uc();Wf();var ai=class extends Error{constructor(e,t){super(e),Error.captureStackTrace(this,this.constructor),this.type=t}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var Zt=class extends ai{constructor(e,t,n){super(e,t),n&&(this.code=this.errno=n.code,this.erroredSysCall=n.syscall)}};var zf=Symbol.toStringTag,Sg=r=>typeof r=="object"&&typeof r.append=="function"&&typeof r.delete=="function"&&typeof r.get=="function"&&typeof r.getAll=="function"&&typeof r.has=="function"&&typeof r.set=="function"&&typeof r.sort=="function"&&r[zf]==="URLSearchParams",Fc=r=>r&&typeof r=="object"&&typeof r.arrayBuffer=="function"&&typeof r.type=="string"&&typeof r.stream=="function"&&typeof r.constructor=="function"&&/^(Blob|File)$/.test(r[zf]),GC=r=>typeof r=="object"&&(r[zf]==="AbortSignal"||r[zf]==="EventTarget"),YC=(r,e)=>{let t=new URL(e).hostname,n=new URL(r).hostname;return t===n||t.endsWith(`.${n}`)},KC=(r,e)=>{let t=new URL(e).protocol,n=new URL(r).protocol;return t===n};var eB=(0,ci.promisify)(Ur.default.pipeline),er=Symbol("Body internals"),Rn=class{constructor(e,{size:t=0}={}){let n=null;e===null?e=null:Sg(e)?e=yr.Buffer.from(e.toString()):Fc(e)||yr.Buffer.isBuffer(e)||(ci.types.isAnyArrayBuffer(e)?e=yr.Buffer.from(e):ArrayBuffer.isView(e)?e=yr.Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof Ur.default||(e instanceof Ns?(e=HC(e),n=e.type.split("=")[1]):e=yr.Buffer.from(String(e))));let i=e;yr.Buffer.isBuffer(e)?i=Ur.default.Readable.from(e):Fc(e)&&(i=Ur.default.Readable.from(e.stream())),this[er]={body:e,stream:i,boundary:n,disturbed:!1,error:null},this.size=t,e instanceof Ur.default&&e.on("error",s=>{let o=s instanceof ai?s:new Zt(`Invalid response body while trying to fetch ${this.url}: ${s.message}`,"system",s);this[er].error=o})}get body(){return this[er].stream}get bodyUsed(){return this[er].disturbed}async arrayBuffer(){let{buffer:e,byteOffset:t,byteLength:n}=await Cg(this);return e.slice(t,t+n)}async formData(){let e=this.headers.get("content-type");if(e.startsWith("application/x-www-form-urlencoded")){let n=new Ns,i=new URLSearchParams(await this.text());for(let[s,o]of i)n.append(s,o);return n}let{toFormData:t}=await Promise.resolve().then(()=>(ek(),ZC));return t(this.body,e)}async blob(){let e=this.headers&&this.headers.get("content-type")||this[er].body&&this[er].body.type||"",t=await this.arrayBuffer();return new oi([t],{type:e})}async json(){let e=await this.text();return JSON.parse(e)}async text(){let e=await Cg(this);return new TextDecoder().decode(e)}buffer(){return Cg(this)}};Rn.prototype.buffer=(0,ci.deprecate)(Rn.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(Rn.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,ci.deprecate)(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function Cg(r){if(r[er].disturbed)throw new TypeError(`body used already for: ${r.url}`);if(r[er].disturbed=!0,r[er].error)throw r[er].error;let{body:e}=r;if(e===null)return yr.Buffer.alloc(0);if(!(e instanceof Ur.default))return yr.Buffer.alloc(0);let t=[],n=0;try{for await(let i of e){if(r.size>0&&n+i.length>r.size){let s=new Zt(`content size at ${r.url} over limit: ${r.size}`,"max-size");throw e.destroy(s),s}n+=i.length,t.push(i)}}catch(i){throw i instanceof ai?i:new Zt(`Invalid response body while trying to fetch ${r.url}: ${i.message}`,"system",i)}if(e.readableEnded===!0||e._readableState.ended===!0)try{return t.every(i=>typeof i=="string")?yr.Buffer.from(t.join("")):yr.Buffer.concat(t,n)}catch(i){throw new Zt(`Could not create Buffer from response body for ${r.url}: ${i.message}`,"system",i)}else throw new Zt(`Premature close of server response while trying to fetch ${r.url}`)}var ea=(r,e)=>{let t,n,{body:i}=r[er];if(r.bodyUsed)throw new Error("cannot clone body after it is used");return i instanceof Ur.default&&typeof i.getBoundary!="function"&&(t=new Ur.PassThrough({highWaterMark:e}),n=new Ur.PassThrough({highWaterMark:e}),i.pipe(t),i.pipe(n),r[er].stream=t,i=n),i},tB=(0,ci.deprecate)(r=>r.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),Kf=(r,e)=>r===null?null:typeof r=="string"?"text/plain;charset=UTF-8":Sg(r)?"application/x-www-form-urlencoded;charset=UTF-8":Fc(r)?r.type||null:yr.Buffer.isBuffer(r)||ci.types.isAnyArrayBuffer(r)||ArrayBuffer.isView(r)?null:r instanceof Ns?`multipart/form-data; boundary=${e[er].boundary}`:r&&typeof r.getBoundary=="function"?`multipart/form-data;boundary=${tB(r)}`:r instanceof Ur.default?null:"text/plain;charset=UTF-8",tk=r=>{let{body:e}=r[er];return e===null?0:Fc(e)?e.size:yr.Buffer.isBuffer(e)?e.length:e&&typeof e.getLengthSync=="function"&&e.hasKnownLength&&e.hasKnownLength()?e.getLengthSync():null},rk=async(r,{body:e})=>{e===null?r.end():await eB(e,r)};var kg=require("node:util"),Bc=de(require("node:http"),1),Jf=typeof Bc.default.validateHeaderName=="function"?Bc.default.validateHeaderName:r=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(r)){let e=new TypeError(`Header name must be a valid HTTP token [${r}]`);throw Object.defineProperty(e,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),e}},Tg=typeof Bc.default.validateHeaderValue=="function"?Bc.default.validateHeaderValue:(r,e)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(e)){let t=new TypeError(`Invalid character in header content ["${r}"]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_CHAR"}),t}},wr=class r extends URLSearchParams{constructor(e){let t=[];if(e instanceof r){let n=e.raw();for(let[i,s]of Object.entries(n))t.push(...s.map(o=>[i,o]))}else if(e!=null)if(typeof e=="object"&&!kg.types.isBoxedPrimitive(e)){let n=e[Symbol.iterator];if(n==null)t.push(...Object.entries(e));else{if(typeof n!="function")throw new TypeError("Header pairs must be iterable");t=[...e].map(i=>{if(typeof i!="object"||kg.types.isBoxedPrimitive(i))throw new TypeError("Each header pair must be an iterable object");return[...i]}).map(i=>{if(i.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...i]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return t=t.length>0?t.map(([n,i])=>(Jf(n),Tg(n,String(i)),[String(n).toLowerCase(),String(i)])):void 0,super(t),new Proxy(this,{get(n,i,s){switch(i){case"append":case"set":return(o,l)=>(Jf(o),Tg(o,String(l)),URLSearchParams.prototype[i].call(n,String(o).toLowerCase(),String(l)));case"delete":case"has":case"getAll":return o=>(Jf(o),URLSearchParams.prototype[i].call(n,String(o).toLowerCase()));case"keys":return()=>(n.sort(),new Set(URLSearchParams.prototype.keys.call(n)).keys());default:return Reflect.get(n,i,s)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(e){let t=this.getAll(e);if(t.length===0)return null;let n=t.join(", ");return/^content-encoding$/i.test(e)&&(n=n.toLowerCase()),n}forEach(e,t=void 0){for(let n of this.keys())Reflect.apply(e,t,[this.get(n),n,this])}*values(){for(let e of this.keys())yield this.get(e)}*entries(){for(let e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((e,t)=>(e[t]=this.getAll(t),e),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((e,t)=>{let n=this.getAll(t);return t==="host"?e[t]=n[0]:e[t]=n.length>1?n:n[0],e},{})}};Object.defineProperties(wr.prototype,["get","entries","forEach","values"].reduce((r,e)=>(r[e]={enumerable:!0},r),{}));function nk(r=[]){return new wr(r.reduce((e,t,n,i)=>(n%2===0&&e.push(i.slice(n,n+2)),e),[]).filter(([e,t])=>{try{return Jf(e),Tg(e,String(t)),!0}catch{return!1}}))}var rB=new Set([301,302,303,307,308]),Qf=r=>rB.has(r);var on=Symbol("Response internals"),Lr=class r extends Rn{constructor(e=null,t={}){super(e,t);let n=t.status!=null?t.status:200,i=new wr(t.headers);if(e!==null&&!i.has("Content-Type")){let s=Kf(e,this);s&&i.append("Content-Type",s)}this[on]={type:"default",url:t.url,status:n,statusText:t.statusText||"",headers:i,counter:t.counter,highWaterMark:t.highWaterMark}}get type(){return this[on].type}get url(){return this[on].url||""}get status(){return this[on].status}get ok(){return this[on].status>=200&&this[on].status<300}get redirected(){return this[on].counter>0}get statusText(){return this[on].statusText}get headers(){return this[on].headers}get highWaterMark(){return this[on].highWaterMark}clone(){return new r(ea(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(e,t=302){if(!Qf(t))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new r(null,{headers:{location:new URL(e).toString()},status:t})}static error(){let e=new r(null,{status:0,statusText:""});return e[on].type="error",e}static json(e=void 0,t={}){let n=JSON.stringify(e);if(n===void 0)throw new TypeError("data is not JSON serializable");let i=new wr(t&&t.headers);return i.has("content-type")||i.set("content-type","application/json"),new r(n,{...t,headers:i})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(Lr.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var dk=require("node:url"),hk=require("node:util");var ik=r=>{if(r.search)return r.search;let e=r.href.length-1,t=r.hash||(r.href[e]==="#"?"#":"");return r.href[e-t.length]==="?"?"?":""};var ok=require("node:net");function sk(r,e=!1){return r==null||(r=new URL(r),/^(about|blob|data):$/.test(r.protocol))?"no-referrer":(r.username="",r.password="",r.hash="",e&&(r.pathname="",r.search=""),r)}var ak=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),ck="strict-origin-when-cross-origin";function lk(r){if(!ak.has(r))throw new TypeError(`Invalid referrerPolicy: ${r}`);return r}function nB(r){if(/^(http|ws)s:$/.test(r.protocol))return!0;let e=r.host.replace(/(^\[)|(]$)/g,""),t=(0,ok.isIP)(e);return t===4&&/^127\./.test(e)||t===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(e)?!0:r.host==="localhost"||r.host.endsWith(".localhost")?!1:r.protocol==="file:"}function ta(r){return/^about:(blank|srcdoc)$/.test(r)||r.protocol==="data:"||/^(blob|filesystem):$/.test(r.protocol)?!0:nB(r)}function uk(r,{referrerURLCallback:e,referrerOriginCallback:t}={}){if(r.referrer==="no-referrer"||r.referrerPolicy==="")return null;let n=r.referrerPolicy;if(r.referrer==="about:client")return"no-referrer";let i=r.referrer,s=sk(i),o=sk(i,!0);s.toString().length>4096&&(s=o),e&&(s=e(s)),t&&(o=t(o));let l=new URL(r.url);switch(n){case"no-referrer":return"no-referrer";case"origin":return o;case"unsafe-url":return s;case"strict-origin":return ta(s)&&!ta(l)?"no-referrer":o.toString();case"strict-origin-when-cross-origin":return s.origin===l.origin?s:ta(s)&&!ta(l)?"no-referrer":o;case"same-origin":return s.origin===l.origin?s:"no-referrer";case"origin-when-cross-origin":return s.origin===l.origin?s:o;case"no-referrer-when-downgrade":return ta(s)&&!ta(l)?"no-referrer":s;default:throw new TypeError(`Invalid referrerPolicy: ${n}`)}}function fk(r){let e=(r.get("referrer-policy")||"").split(/[,\s]+/),t="";for(let n of e)n&&ak.has(n)&&(t=n);return t}var xt=Symbol("Request internals"),Mc=r=>typeof r=="object"&&typeof r[xt]=="object",iB=(0,hk.deprecate)(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),Ms=class r extends Rn{constructor(e,t={}){let n;if(Mc(e)?n=new URL(e.url):(n=new URL(e),e={}),n.username!==""||n.password!=="")throw new TypeError(`${n} is an url with embedded credentials.`);let i=t.method||e.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(i)&&(i=i.toUpperCase()),!Mc(t)&&"data"in t&&iB(),(t.body!=null||Mc(e)&&e.body!==null)&&(i==="GET"||i==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let s=t.body?t.body:Mc(e)&&e.body!==null?ea(e):null;super(s,{size:t.size||e.size||0});let o=new wr(t.headers||e.headers||{});if(s!==null&&!o.has("Content-Type")){let d=Kf(s,this);d&&o.set("Content-Type",d)}let l=Mc(e)?e.signal:null;if("signal"in t&&(l=t.signal),l!=null&&!GC(l))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let u=t.referrer==null?e.referrer:t.referrer;if(u==="")u="no-referrer";else if(u){let d=new URL(u);u=/^about:(\/\/)?client$/.test(d)?"client":d}else u=void 0;this[xt]={method:i,redirect:t.redirect||e.redirect||"follow",headers:o,parsedURL:n,signal:l,referrer:u},this.follow=t.follow===void 0?e.follow===void 0?20:e.follow:t.follow,this.compress=t.compress===void 0?e.compress===void 0?!0:e.compress:t.compress,this.counter=t.counter||e.counter||0,this.agent=t.agent||e.agent,this.highWaterMark=t.highWaterMark||e.highWaterMark||16384,this.insecureHTTPParser=t.insecureHTTPParser||e.insecureHTTPParser||!1,this.referrerPolicy=t.referrerPolicy||e.referrerPolicy||""}get method(){return this[xt].method}get url(){return(0,dk.format)(this[xt].parsedURL)}get headers(){return this[xt].headers}get redirect(){return this[xt].redirect}get signal(){return this[xt].signal}get referrer(){if(this[xt].referrer==="no-referrer")return"";if(this[xt].referrer==="client")return"about:client";if(this[xt].referrer)return this[xt].referrer.toString()}get referrerPolicy(){return this[xt].referrerPolicy}set referrerPolicy(e){this[xt].referrerPolicy=lk(e)}clone(){return new r(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Ms.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var pk=r=>{let{parsedURL:e}=r[xt],t=new wr(r[xt].headers);t.has("Accept")||t.set("Accept","*/*");let n=null;if(r.body===null&&/^(post|put)$/i.test(r.method)&&(n="0"),r.body!==null){let l=tk(r);typeof l=="number"&&!Number.isNaN(l)&&(n=String(l))}n&&t.set("Content-Length",n),r.referrerPolicy===""&&(r.referrerPolicy=ck),r.referrer&&r.referrer!=="no-referrer"?r[xt].referrer=uk(r):r[xt].referrer="no-referrer",r[xt].referrer instanceof URL&&t.set("Referer",r.referrer),t.has("User-Agent")||t.set("User-Agent","node-fetch"),r.compress&&!t.has("Accept-Encoding")&&t.set("Accept-Encoding","gzip, deflate, br");let{agent:i}=r;typeof i=="function"&&(i=i(e));let s=ik(e),o={path:e.pathname+s,method:r.method,headers:t[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:r.insecureHTTPParser,agent:i};return{parsedURL:e,options:o}};var Xf=class extends ai{constructor(e,t="aborted"){super(e,t)}};Wf();xg();var sB=new Set(["data:","http:","https:"]);async function Zf(r,e){return new Promise((t,n)=>{let i=new Ms(r,e),{parsedURL:s,options:o}=pk(i);if(!sB.has(s.protocol))throw new TypeError(`node-fetch cannot load ${r}. URL scheme "${s.protocol.replace(/:$/,"")}" is not supported.`);if(s.protocol==="data:"){let y=BC(i.url),b=new Lr(y,{headers:{"Content-Type":y.typeFull}});t(b);return}let l=(s.protocol==="https:"?gk.default:mk.default).request,{signal:u}=i,d=null,f=()=>{let y=new Xf("The operation was aborted.");n(y),i.body&&i.body instanceof br.default.Readable&&i.body.destroy(y),!(!d||!d.body)&&d.body.emit("error",y)};if(u&&u.aborted){f();return}let h=()=>{f(),g()},m=l(s.toString(),o);u&&u.addEventListener("abort",h);let g=()=>{m.abort(),u&&u.removeEventListener("abort",h)};m.on("error",y=>{n(new Zt(`request to ${i.url} failed, reason: ${y.message}`,"system",y)),g()}),oB(m,y=>{d&&d.body&&d.body.destroy(y)}),process.version<"v14"&&m.on("socket",y=>{let b;y.prependListener("end",()=>{b=y._eventsCount}),y.prependListener("close",C=>{if(d&&b<y._eventsCount&&!C){let L=new Error("Premature close");L.code="ERR_STREAM_PREMATURE_CLOSE",d.body.emit("error",L)}})}),m.on("response",y=>{m.setTimeout(0);let b=nk(y.rawHeaders);if(Qf(y.statusCode)){let D=b.get("Location"),N=null;try{N=D===null?null:new URL(D,i.url)}catch{if(i.redirect!=="manual"){n(new Zt(`uri requested responds with an invalid redirect URL: ${D}`,"invalid-redirect")),g();return}}switch(i.redirect){case"error":n(new Zt(`uri requested responds with a redirect, redirect mode is set to error: ${i.url}`,"no-redirect")),g();return;case"manual":break;case"follow":{if(N===null)break;if(i.counter>=i.follow){n(new Zt(`maximum redirect reached at: ${i.url}`,"max-redirect")),g();return}let k={headers:new wr(i.headers),follow:i.follow,counter:i.counter+1,agent:i.agent,compress:i.compress,method:i.method,body:ea(i),signal:i.signal,size:i.size,referrer:i.referrer,referrerPolicy:i.referrerPolicy};if(!YC(i.url,N)||!KC(i.url,N))for(let R of["authorization","www-authenticate","cookie","cookie2"])k.headers.delete(R);if(y.statusCode!==303&&i.body&&e.body instanceof br.default.Readable){n(new Zt("Cannot follow redirect with body being a readable stream","unsupported-redirect")),g();return}(y.statusCode===303||(y.statusCode===301||y.statusCode===302)&&i.method==="POST")&&(k.method="GET",k.body=void 0,k.headers.delete("content-length"));let P=fk(b);P&&(k.referrerPolicy=P),t(Zf(new Ms(N,k))),g();return}default:return n(new TypeError(`Redirect option '${i.redirect}' is not a valid value of RequestRedirect`))}}u&&y.once("end",()=>{u.removeEventListener("abort",h)});let C=(0,br.pipeline)(y,new br.PassThrough,D=>{D&&n(D)});process.version<"v12.10"&&y.on("aborted",h);let L={url:i.url,status:y.statusCode,statusText:y.statusMessage,headers:b,size:i.size,counter:i.counter,highWaterMark:i.highWaterMark},j=b.get("Content-Encoding");if(!i.compress||i.method==="HEAD"||j===null||y.statusCode===204||y.statusCode===304){d=new Lr(C,L),t(d);return}let O={flush:qs.default.Z_SYNC_FLUSH,finishFlush:qs.default.Z_SYNC_FLUSH};if(j==="gzip"||j==="x-gzip"){C=(0,br.pipeline)(C,qs.default.createGunzip(O),D=>{D&&n(D)}),d=new Lr(C,L),t(d);return}if(j==="deflate"||j==="x-deflate"){let D=(0,br.pipeline)(y,new br.PassThrough,N=>{N&&n(N)});D.once("data",N=>{(N[0]&15)===8?C=(0,br.pipeline)(C,qs.default.createInflate(),k=>{k&&n(k)}):C=(0,br.pipeline)(C,qs.default.createInflateRaw(),k=>{k&&n(k)}),d=new Lr(C,L),t(d)}),D.once("end",()=>{d||(d=new Lr(C,L),t(d))});return}if(j==="br"){C=(0,br.pipeline)(C,qs.default.createBrotliDecompress(),D=>{D&&n(D)}),d=new Lr(C,L),t(d);return}d=new Lr(C,L),t(d)}),rk(m,i).catch(n)})}function oB(r,e){let t=qc.Buffer.from(`0\r
\r
`),n=!1,i=!1,s;r.on("response",o=>{let{headers:l}=o;n=l["transfer-encoding"]==="chunked"&&!l["content-length"]}),r.on("socket",o=>{let l=()=>{if(n&&!i){let d=new Error("Premature close");d.code="ERR_STREAM_PREMATURE_CLOSE",e(d)}},u=d=>{i=qc.Buffer.compare(d.slice(-5),t)===0,!i&&s&&(i=qc.Buffer.compare(s.slice(-3),t.slice(0,3))===0&&qc.Buffer.compare(d.slice(-2),t.slice(3))===0),s=d};o.prependListener("close",l),o.on("data",u),r.on("close",()=>{o.removeListener("close",l),o.removeListener("data",u)})})}vS({cryptoModule:yk.webcrypto});async function aB(r){let e=LC(r);e.bind(yg).toConstantValue(Zf),e.get(Pr).initialize();let i=await e.get(Xt).tryConnect();i?await i.ready:(await Pc(),Ls())}async function cB(){await Ge.Current?.leave(),Ge.Current?.dispose(),await Pc(),Ls()}0&&(module.exports={activate,deactivate});
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)

xmlhttprequest-ssl/lib/XMLHttpRequest.js:
  (**
   * Wrapper for built-in http.js to emulate the browser XMLHttpRequest object.
   *
   * This can be used with JS designed for browsers to improve reuse of code and
   * allow the use of existing libraries.
   *
   * Usage: include("XMLHttpRequest.js") and use XMLHttpRequest per W3C specs.
   *
   * @author Dan DeFelippi <dan@driverdan.com>
   * @contributor David Ellis <d.f.ellis@ieee.org>
   * @license MIT
   *)

web-streams-polyfill/dist/ponyfill.es2018.js:
  (**
   * @license
   * web-streams-polyfill v3.3.3
   * Copyright 2024 Mattias Buelens, Diwank Singh Tomer and other contributors.
   * This code is released under the MIT license.
   * SPDX-License-Identifier: MIT
   *)

fetch-blob/index.js:
  (*! fetch-blob. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)

formdata-polyfill/esm.min.js:
  (*! formdata-polyfill. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)

node-domexception/index.js:
  (*! node-domexception. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)
*/
